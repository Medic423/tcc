var Or=Object.defineProperty;var Fr=(a,r,s)=>r in a?Or(a,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[r]=s;var Na=(a,r,s)=>(Fr(a,typeof r!="symbol"?r+"":r,s),s);import{r as g,b as Ir,c as sa}from"./vendor.dbc86f72.js";import{u as Ya,a as Br,L as qe,R as Yt,b as le,B as Ur,N as jr}from"./router.b574cf9e.js";import{B as ve,T as ie,M as Re,A as Se,R as xe,D as ze,C as fe,a as re,F as Dt,b as nt,c as Ze,S as Mt,X as we,d as Xa,P as Za,e as Ee,f as _e,g as Ot,h as ht,i as ia,j as na,W as $r,k as Qe,I as zr,l as he,m as me,n as _r,U as Qa,o as We,p as qr,q as va,r as la,Z as Hr,s as Wr,t as pe,u as Ne,v as Et,w as Ke,L as Lt,x as ot,H as Xt,y as He,N as wa,z as Ca,E as Je,G as lt,J as ye,K as oa,O as je,Q as $e,Y as Te,V as be,_ as et,$ as ct,a0 as dt,a1 as mt,a2 as Rt,a3 as Ie,a4 as ca,a5 as Be,a6 as ka,a7 as Sa,a8 as Gr,a9 as Ta,aa as Vr,ab as Kr,ac as Ea,ad as pt}from"./ui.2c10658c.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();var Ft={exports:{}},It={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jr=g.exports,Yr=Symbol.for("react.element"),Xr=Symbol.for("react.fragment"),Zr=Object.prototype.hasOwnProperty,Qr=Jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,es={key:!0,ref:!0,__self:!0,__source:!0};function er(a,r,s){var n,i={},o=null,l=null;s!==void 0&&(o=""+s),r.key!==void 0&&(o=""+r.key),r.ref!==void 0&&(l=r.ref);for(n in r)Zr.call(r,n)&&!es.hasOwnProperty(n)&&(i[n]=r[n]);if(a&&a.defaultProps)for(n in r=a.defaultProps,r)i[n]===void 0&&(i[n]=r[n]);return{$$typeof:Yr,type:a,key:o,ref:l,props:i,_owner:Qr.current}}It.Fragment=Xr;It.jsx=er;It.jsxs=er;(function(a){a.exports=It})(Ft);const se=Ft.exports.Fragment,e=Ft.exports.jsx,t=Ft.exports.jsxs;var Zt={},La=Ir.exports;Zt.createRoot=La.createRoot,Zt.hydrateRoot=La.hydrateRoot;function tr(a,r){return function(){return a.apply(r,arguments)}}const{toString:ts}=Object.prototype,{getPrototypeOf:da}=Object,{iterator:Bt,toStringTag:ar}=Symbol,Ut=(a=>r=>{const s=ts.call(r);return a[s]||(a[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Pe=a=>(a=a.toLowerCase(),r=>Ut(r)===a),jt=a=>r=>typeof r===a,{isArray:at}=Array,tt=jt("undefined");function gt(a){return a!==null&&!tt(a)&&a.constructor!==null&&!tt(a.constructor)&&Ce(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const rr=Pe("ArrayBuffer");function as(a){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(a):r=a&&a.buffer&&rr(a.buffer),r}const rs=jt("string"),Ce=jt("function"),sr=jt("number"),xt=a=>a!==null&&typeof a=="object",ss=a=>a===!0||a===!1,wt=a=>{if(Ut(a)!=="object")return!1;const r=da(a);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(ar in a)&&!(Bt in a)},is=a=>{if(!xt(a)||gt(a))return!1;try{return Object.keys(a).length===0&&Object.getPrototypeOf(a)===Object.prototype}catch{return!1}},ns=Pe("Date"),ls=Pe("File"),os=Pe("Blob"),cs=Pe("FileList"),ds=a=>xt(a)&&Ce(a.pipe),ms=a=>{let r;return a&&(typeof FormData=="function"&&a instanceof FormData||Ce(a.append)&&((r=Ut(a))==="formdata"||r==="object"&&Ce(a.toString)&&a.toString()==="[object FormData]"))},us=Pe("URLSearchParams"),[hs,ps,gs,xs]=["ReadableStream","Request","Response","Headers"].map(Pe),fs=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ft(a,r,{allOwnKeys:s=!1}={}){if(a===null||typeof a>"u")return;let n,i;if(typeof a!="object"&&(a=[a]),at(a))for(n=0,i=a.length;n<i;n++)r.call(null,a[n],n,a);else{if(gt(a))return;const o=s?Object.getOwnPropertyNames(a):Object.keys(a),l=o.length;let h;for(n=0;n<l;n++)h=o[n],r.call(null,a[h],h,a)}}function ir(a,r){if(gt(a))return null;r=r.toLowerCase();const s=Object.keys(a);let n=s.length,i;for(;n-- >0;)if(i=s[n],r===i.toLowerCase())return i;return null}const Ge=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),nr=a=>!tt(a)&&a!==Ge;function Qt(){const{caseless:a,skipUndefined:r}=nr(this)&&this||{},s={},n=(i,o)=>{const l=a&&ir(s,o)||o;wt(s[l])&&wt(i)?s[l]=Qt(s[l],i):wt(i)?s[l]=Qt({},i):at(i)?s[l]=i.slice():(!r||!tt(i))&&(s[l]=i)};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&ft(arguments[i],n);return s}const ys=(a,r,s,{allOwnKeys:n}={})=>(ft(r,(i,o)=>{s&&Ce(i)?a[o]=tr(i,s):a[o]=i},{allOwnKeys:n}),a),bs=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),Ns=(a,r,s,n)=>{a.prototype=Object.create(r.prototype,n),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:r.prototype}),s&&Object.assign(a.prototype,s)},vs=(a,r,s,n)=>{let i,o,l;const h={};if(r=r||{},a==null)return r;do{for(i=Object.getOwnPropertyNames(a),o=i.length;o-- >0;)l=i[o],(!n||n(l,a,r))&&!h[l]&&(r[l]=a[l],h[l]=!0);a=s!==!1&&da(a)}while(a&&(!s||s(a,r))&&a!==Object.prototype);return r},ws=(a,r,s)=>{a=String(a),(s===void 0||s>a.length)&&(s=a.length),s-=r.length;const n=a.indexOf(r,s);return n!==-1&&n===s},Cs=a=>{if(!a)return null;if(at(a))return a;let r=a.length;if(!sr(r))return null;const s=new Array(r);for(;r-- >0;)s[r]=a[r];return s},ks=(a=>r=>a&&r instanceof a)(typeof Uint8Array<"u"&&da(Uint8Array)),Ss=(a,r)=>{const n=(a&&a[Bt]).call(a);let i;for(;(i=n.next())&&!i.done;){const o=i.value;r.call(a,o[0],o[1])}},Ts=(a,r)=>{let s;const n=[];for(;(s=a.exec(r))!==null;)n.push(s);return n},Es=Pe("HTMLFormElement"),Ls=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,i){return n.toUpperCase()+i}),Ra=(({hasOwnProperty:a})=>(r,s)=>a.call(r,s))(Object.prototype),Rs=Pe("RegExp"),lr=(a,r)=>{const s=Object.getOwnPropertyDescriptors(a),n={};ft(s,(i,o)=>{let l;(l=r(i,o,a))!==!1&&(n[o]=l||i)}),Object.defineProperties(a,n)},As=a=>{lr(a,(r,s)=>{if(Ce(a)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=a[s];if(!!Ce(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},Ps=(a,r)=>{const s={},n=i=>{i.forEach(o=>{s[o]=!0})};return at(a)?n(a):n(String(a).split(r)),s},Ds=()=>{},Ms=(a,r)=>a!=null&&Number.isFinite(a=+a)?a:r;function Os(a){return!!(a&&Ce(a.append)&&a[ar]==="FormData"&&a[Bt])}const Fs=a=>{const r=new Array(10),s=(n,i)=>{if(xt(n)){if(r.indexOf(n)>=0)return;if(gt(n))return n;if(!("toJSON"in n)){r[i]=n;const o=at(n)?[]:{};return ft(n,(l,h)=>{const N=s(l,i+1);!tt(N)&&(o[h]=N)}),r[i]=void 0,o}}return n};return s(a,0)},Is=Pe("AsyncFunction"),Bs=a=>a&&(xt(a)||Ce(a))&&Ce(a.then)&&Ce(a.catch),or=((a,r)=>a?setImmediate:r?((s,n)=>(Ge.addEventListener("message",({source:i,data:o})=>{i===Ge&&o===s&&n.length&&n.shift()()},!1),i=>{n.push(i),Ge.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",Ce(Ge.postMessage)),Us=typeof queueMicrotask<"u"?queueMicrotask.bind(Ge):typeof process<"u"&&process.nextTick||or,js=a=>a!=null&&Ce(a[Bt]),A={isArray:at,isArrayBuffer:rr,isBuffer:gt,isFormData:ms,isArrayBufferView:as,isString:rs,isNumber:sr,isBoolean:ss,isObject:xt,isPlainObject:wt,isEmptyObject:is,isReadableStream:hs,isRequest:ps,isResponse:gs,isHeaders:xs,isUndefined:tt,isDate:ns,isFile:ls,isBlob:os,isRegExp:Rs,isFunction:Ce,isStream:ds,isURLSearchParams:us,isTypedArray:ks,isFileList:cs,forEach:ft,merge:Qt,extend:ys,trim:fs,stripBOM:bs,inherits:Ns,toFlatObject:vs,kindOf:Ut,kindOfTest:Pe,endsWith:ws,toArray:Cs,forEachEntry:Ss,matchAll:Ts,isHTMLForm:Es,hasOwnProperty:Ra,hasOwnProp:Ra,reduceDescriptors:lr,freezeMethods:As,toObjectSet:Ps,toCamelCase:Ls,noop:Ds,toFiniteNumber:Ms,findKey:ir,global:Ge,isContextDefined:nr,isSpecCompliantForm:Os,toJSONObject:Fs,isAsyncFn:Is,isThenable:Bs,setImmediate:or,asap:Us,isIterable:js};function te(a,r,s,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",r&&(this.code=r),s&&(this.config=s),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}A.inherits(te,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:A.toJSONObject(this.config),code:this.code,status:this.status}}});const cr=te.prototype,dr={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{dr[a]={value:a}});Object.defineProperties(te,dr);Object.defineProperty(cr,"isAxiosError",{value:!0});te.from=(a,r,s,n,i,o)=>{const l=Object.create(cr);A.toFlatObject(a,l,function(m){return m!==Error.prototype},y=>y!=="isAxiosError");const h=a&&a.message?a.message:"Error",N=r==null&&a?a.code:r;return te.call(l,h,N,s,n,i),a&&l.cause==null&&Object.defineProperty(l,"cause",{value:a,configurable:!0}),l.name=a&&a.name||"Error",o&&Object.assign(l,o),l};const $s=null;function ea(a){return A.isPlainObject(a)||A.isArray(a)}function mr(a){return A.endsWith(a,"[]")?a.slice(0,-2):a}function Aa(a,r,s){return a?a.concat(r).map(function(i,o){return i=mr(i),!s&&o?"["+i+"]":i}).join(s?".":""):r}function zs(a){return A.isArray(a)&&!a.some(ea)}const _s=A.toFlatObject(A,{},null,function(r){return/^is[A-Z]/.test(r)});function $t(a,r,s){if(!A.isObject(a))throw new TypeError("target must be an object");r=r||new FormData,s=A.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,u){return!A.isUndefined(u[b])});const n=s.metaTokens,i=s.visitor||m,o=s.dots,l=s.indexes,N=(s.Blob||typeof Blob<"u"&&Blob)&&A.isSpecCompliantForm(r);if(!A.isFunction(i))throw new TypeError("visitor must be a function");function y(c){if(c===null)return"";if(A.isDate(c))return c.toISOString();if(A.isBoolean(c))return c.toString();if(!N&&A.isBlob(c))throw new te("Blob is not supported. Use a Buffer instead.");return A.isArrayBuffer(c)||A.isTypedArray(c)?N&&typeof Blob=="function"?new Blob([c]):Buffer.from(c):c}function m(c,b,u){let S=c;if(c&&!u&&typeof c=="object"){if(A.endsWith(b,"{}"))b=n?b:b.slice(0,-2),c=JSON.stringify(c);else if(A.isArray(c)&&zs(c)||(A.isFileList(c)||A.endsWith(b,"[]"))&&(S=A.toArray(c)))return b=mr(b),S.forEach(function(O,F){!(A.isUndefined(O)||O===null)&&r.append(l===!0?Aa([b],F,o):l===null?b:b+"[]",y(O))}),!1}return ea(c)?!0:(r.append(Aa(u,b,o),y(c)),!1)}const p=[],x=Object.assign(_s,{defaultVisitor:m,convertValue:y,isVisitable:ea});function f(c,b){if(!A.isUndefined(c)){if(p.indexOf(c)!==-1)throw Error("Circular reference detected in "+b.join("."));p.push(c),A.forEach(c,function(S,k){(!(A.isUndefined(S)||S===null)&&i.call(r,S,A.isString(k)?k.trim():k,b,x))===!0&&f(S,b?b.concat(k):[k])}),p.pop()}}if(!A.isObject(a))throw new TypeError("data must be an object");return f(a),r}function Pa(a){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function ma(a,r){this._pairs=[],a&&$t(a,this,r)}const ur=ma.prototype;ur.append=function(r,s){this._pairs.push([r,s])};ur.toString=function(r){const s=r?function(n){return r.call(this,n,Pa)}:Pa;return this._pairs.map(function(i){return s(i[0])+"="+s(i[1])},"").join("&")};function qs(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function hr(a,r,s){if(!r)return a;const n=s&&s.encode||qs;A.isFunction(s)&&(s={serialize:s});const i=s&&s.serialize;let o;if(i?o=i(r,s):o=A.isURLSearchParams(r)?r.toString():new ma(r,s).toString(n),o){const l=a.indexOf("#");l!==-1&&(a=a.slice(0,l)),a+=(a.indexOf("?")===-1?"?":"&")+o}return a}class Hs{constructor(){this.handlers=[]}use(r,s,n){return this.handlers.push({fulfilled:r,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){A.forEach(this.handlers,function(n){n!==null&&r(n)})}}const Da=Hs,pr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ws=typeof URLSearchParams<"u"?URLSearchParams:ma,Gs=typeof FormData<"u"?FormData:null,Vs=typeof Blob<"u"?Blob:null,Ks={isBrowser:!0,classes:{URLSearchParams:Ws,FormData:Gs,Blob:Vs},protocols:["http","https","file","blob","url","data"]},ua=typeof window<"u"&&typeof document<"u",ta=typeof navigator=="object"&&navigator||void 0,Js=ua&&(!ta||["ReactNative","NativeScript","NS"].indexOf(ta.product)<0),Ys=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Xs=ua&&window.location.href||"http://localhost",Zs=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ua,hasStandardBrowserWebWorkerEnv:Ys,hasStandardBrowserEnv:Js,navigator:ta,origin:Xs},Symbol.toStringTag,{value:"Module"})),ue={...Zs,...Ks};function Qs(a,r){return $t(a,new ue.classes.URLSearchParams,{visitor:function(s,n,i,o){return ue.isNode&&A.isBuffer(s)?(this.append(n,s.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...r})}function ei(a){return A.matchAll(/\w+|\[(\w*)]/g,a).map(r=>r[0]==="[]"?"":r[1]||r[0])}function ti(a){const r={},s=Object.keys(a);let n;const i=s.length;let o;for(n=0;n<i;n++)o=s[n],r[o]=a[o];return r}function gr(a){function r(s,n,i,o){let l=s[o++];if(l==="__proto__")return!0;const h=Number.isFinite(+l),N=o>=s.length;return l=!l&&A.isArray(i)?i.length:l,N?(A.hasOwnProp(i,l)?i[l]=[i[l],n]:i[l]=n,!h):((!i[l]||!A.isObject(i[l]))&&(i[l]=[]),r(s,n,i[l],o)&&A.isArray(i[l])&&(i[l]=ti(i[l])),!h)}if(A.isFormData(a)&&A.isFunction(a.entries)){const s={};return A.forEachEntry(a,(n,i)=>{r(ei(n),i,s,0)}),s}return null}function ai(a,r,s){if(A.isString(a))try{return(r||JSON.parse)(a),A.trim(a)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(a)}const ha={transitional:pr,adapter:["xhr","http","fetch"],transformRequest:[function(r,s){const n=s.getContentType()||"",i=n.indexOf("application/json")>-1,o=A.isObject(r);if(o&&A.isHTMLForm(r)&&(r=new FormData(r)),A.isFormData(r))return i?JSON.stringify(gr(r)):r;if(A.isArrayBuffer(r)||A.isBuffer(r)||A.isStream(r)||A.isFile(r)||A.isBlob(r)||A.isReadableStream(r))return r;if(A.isArrayBufferView(r))return r.buffer;if(A.isURLSearchParams(r))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let h;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Qs(r,this.formSerializer).toString();if((h=A.isFileList(r))||n.indexOf("multipart/form-data")>-1){const N=this.env&&this.env.FormData;return $t(h?{"files[]":r}:r,N&&new N,this.formSerializer)}}return o||i?(s.setContentType("application/json",!1),ai(r)):r}],transformResponse:[function(r){const s=this.transitional||ha.transitional,n=s&&s.forcedJSONParsing,i=this.responseType==="json";if(A.isResponse(r)||A.isReadableStream(r))return r;if(r&&A.isString(r)&&(n&&!this.responseType||i)){const l=!(s&&s.silentJSONParsing)&&i;try{return JSON.parse(r,this.parseReviver)}catch(h){if(l)throw h.name==="SyntaxError"?te.from(h,te.ERR_BAD_RESPONSE,this,null,this.response):h}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ue.classes.FormData,Blob:ue.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};A.forEach(["delete","get","head","post","put","patch"],a=>{ha.headers[a]={}});const pa=ha,ri=A.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),si=a=>{const r={};let s,n,i;return a&&a.split(`
`).forEach(function(l){i=l.indexOf(":"),s=l.substring(0,i).trim().toLowerCase(),n=l.substring(i+1).trim(),!(!s||r[s]&&ri[s])&&(s==="set-cookie"?r[s]?r[s].push(n):r[s]=[n]:r[s]=r[s]?r[s]+", "+n:n)}),r},Ma=Symbol("internals");function st(a){return a&&String(a).trim().toLowerCase()}function Ct(a){return a===!1||a==null?a:A.isArray(a)?a.map(Ct):String(a)}function ii(a){const r=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(a);)r[n[1]]=n[2];return r}const ni=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function Vt(a,r,s,n,i){if(A.isFunction(n))return n.call(this,r,s);if(i&&(r=s),!!A.isString(r)){if(A.isString(n))return r.indexOf(n)!==-1;if(A.isRegExp(n))return n.test(r)}}function li(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,s,n)=>s.toUpperCase()+n)}function oi(a,r){const s=A.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(a,n+s,{value:function(i,o,l){return this[n].call(this,r,i,o,l)},configurable:!0})})}class zt{constructor(r){r&&this.set(r)}set(r,s,n){const i=this;function o(h,N,y){const m=st(N);if(!m)throw new Error("header name must be a non-empty string");const p=A.findKey(i,m);(!p||i[p]===void 0||y===!0||y===void 0&&i[p]!==!1)&&(i[p||N]=Ct(h))}const l=(h,N)=>A.forEach(h,(y,m)=>o(y,m,N));if(A.isPlainObject(r)||r instanceof this.constructor)l(r,s);else if(A.isString(r)&&(r=r.trim())&&!ni(r))l(si(r),s);else if(A.isObject(r)&&A.isIterable(r)){let h={},N,y;for(const m of r){if(!A.isArray(m))throw TypeError("Object iterator must return a key-value pair");h[y=m[0]]=(N=h[y])?A.isArray(N)?[...N,m[1]]:[N,m[1]]:m[1]}l(h,s)}else r!=null&&o(s,r,n);return this}get(r,s){if(r=st(r),r){const n=A.findKey(this,r);if(n){const i=this[n];if(!s)return i;if(s===!0)return ii(i);if(A.isFunction(s))return s.call(this,i,n);if(A.isRegExp(s))return s.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,s){if(r=st(r),r){const n=A.findKey(this,r);return!!(n&&this[n]!==void 0&&(!s||Vt(this,this[n],n,s)))}return!1}delete(r,s){const n=this;let i=!1;function o(l){if(l=st(l),l){const h=A.findKey(n,l);h&&(!s||Vt(n,n[h],h,s))&&(delete n[h],i=!0)}}return A.isArray(r)?r.forEach(o):o(r),i}clear(r){const s=Object.keys(this);let n=s.length,i=!1;for(;n--;){const o=s[n];(!r||Vt(this,this[o],o,r,!0))&&(delete this[o],i=!0)}return i}normalize(r){const s=this,n={};return A.forEach(this,(i,o)=>{const l=A.findKey(n,o);if(l){s[l]=Ct(i),delete s[o];return}const h=r?li(o):String(o).trim();h!==o&&delete s[o],s[h]=Ct(i),n[h]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const s=Object.create(null);return A.forEach(this,(n,i)=>{n!=null&&n!==!1&&(s[i]=r&&A.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,s])=>r+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...s){const n=new this(r);return s.forEach(i=>n.set(i)),n}static accessor(r){const n=(this[Ma]=this[Ma]={accessors:{}}).accessors,i=this.prototype;function o(l){const h=st(l);n[h]||(oi(i,l),n[h]=!0)}return A.isArray(r)?r.forEach(o):o(r),this}}zt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);A.reduceDescriptors(zt.prototype,({value:a},r)=>{let s=r[0].toUpperCase()+r.slice(1);return{get:()=>a,set(n){this[s]=n}}});A.freezeMethods(zt);const Ae=zt;function Kt(a,r){const s=this||pa,n=r||s,i=Ae.from(n.headers);let o=n.data;return A.forEach(a,function(h){o=h.call(s,o,i.normalize(),r?r.status:void 0)}),i.normalize(),o}function xr(a){return!!(a&&a.__CANCEL__)}function rt(a,r,s){te.call(this,a==null?"canceled":a,te.ERR_CANCELED,r,s),this.name="CanceledError"}A.inherits(rt,te,{__CANCEL__:!0});function fr(a,r,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?a(s):r(new te("Request failed with status code "+s.status,[te.ERR_BAD_REQUEST,te.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function ci(a){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return r&&r[1]||""}function di(a,r){a=a||10;const s=new Array(a),n=new Array(a);let i=0,o=0,l;return r=r!==void 0?r:1e3,function(N){const y=Date.now(),m=n[o];l||(l=y),s[i]=N,n[i]=y;let p=o,x=0;for(;p!==i;)x+=s[p++],p=p%a;if(i=(i+1)%a,i===o&&(o=(o+1)%a),y-l<r)return;const f=m&&y-m;return f?Math.round(x*1e3/f):void 0}}function mi(a,r){let s=0,n=1e3/r,i,o;const l=(y,m=Date.now())=>{s=m,i=null,o&&(clearTimeout(o),o=null),a(...y)};return[(...y)=>{const m=Date.now(),p=m-s;p>=n?l(y,m):(i=y,o||(o=setTimeout(()=>{o=null,l(i)},n-p)))},()=>i&&l(i)]}const At=(a,r,s=3)=>{let n=0;const i=di(50,250);return mi(o=>{const l=o.loaded,h=o.lengthComputable?o.total:void 0,N=l-n,y=i(N),m=l<=h;n=l;const p={loaded:l,total:h,progress:h?l/h:void 0,bytes:N,rate:y||void 0,estimated:y&&h&&m?(h-l)/y:void 0,event:o,lengthComputable:h!=null,[r?"download":"upload"]:!0};a(p)},s)},Oa=(a,r)=>{const s=a!=null;return[n=>r[0]({lengthComputable:s,total:a,loaded:n}),r[1]]},Fa=a=>(...r)=>A.asap(()=>a(...r)),ui=ue.hasStandardBrowserEnv?((a,r)=>s=>(s=new URL(s,ue.origin),a.protocol===s.protocol&&a.host===s.host&&(r||a.port===s.port)))(new URL(ue.origin),ue.navigator&&/(msie|trident)/i.test(ue.navigator.userAgent)):()=>!0,hi=ue.hasStandardBrowserEnv?{write(a,r,s,n,i,o){const l=[a+"="+encodeURIComponent(r)];A.isNumber(s)&&l.push("expires="+new Date(s).toGMTString()),A.isString(n)&&l.push("path="+n),A.isString(i)&&l.push("domain="+i),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(a){const r=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(a){this.write(a,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function pi(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function gi(a,r){return r?a.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):a}function yr(a,r,s){let n=!pi(r);return a&&(n||s==!1)?gi(a,r):r}const Ia=a=>a instanceof Ae?{...a}:a;function Ye(a,r){r=r||{};const s={};function n(y,m,p,x){return A.isPlainObject(y)&&A.isPlainObject(m)?A.merge.call({caseless:x},y,m):A.isPlainObject(m)?A.merge({},m):A.isArray(m)?m.slice():m}function i(y,m,p,x){if(A.isUndefined(m)){if(!A.isUndefined(y))return n(void 0,y,p,x)}else return n(y,m,p,x)}function o(y,m){if(!A.isUndefined(m))return n(void 0,m)}function l(y,m){if(A.isUndefined(m)){if(!A.isUndefined(y))return n(void 0,y)}else return n(void 0,m)}function h(y,m,p){if(p in r)return n(y,m);if(p in a)return n(void 0,y)}const N={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:h,headers:(y,m,p)=>i(Ia(y),Ia(m),p,!0)};return A.forEach(Object.keys({...a,...r}),function(m){const p=N[m]||i,x=p(a[m],r[m],m);A.isUndefined(x)&&p!==h||(s[m]=x)}),s}const br=a=>{const r=Ye({},a);let{data:s,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:o,headers:l,auth:h}=r;if(r.headers=l=Ae.from(l),r.url=hr(yr(r.baseURL,r.url,r.allowAbsoluteUrls),a.params,a.paramsSerializer),h&&l.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):""))),A.isFormData(s)){if(ue.hasStandardBrowserEnv||ue.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(A.isFunction(s.getHeaders)){const N=s.getHeaders(),y=["content-type","content-length"];Object.entries(N).forEach(([m,p])=>{y.includes(m.toLowerCase())&&l.set(m,p)})}}if(ue.hasStandardBrowserEnv&&(n&&A.isFunction(n)&&(n=n(r)),n||n!==!1&&ui(r.url))){const N=i&&o&&hi.read(o);N&&l.set(i,N)}return r},xi=typeof XMLHttpRequest<"u",fi=xi&&function(a){return new Promise(function(s,n){const i=br(a);let o=i.data;const l=Ae.from(i.headers).normalize();let{responseType:h,onUploadProgress:N,onDownloadProgress:y}=i,m,p,x,f,c;function b(){f&&f(),c&&c(),i.cancelToken&&i.cancelToken.unsubscribe(m),i.signal&&i.signal.removeEventListener("abort",m)}let u=new XMLHttpRequest;u.open(i.method.toUpperCase(),i.url,!0),u.timeout=i.timeout;function S(){if(!u)return;const O=Ae.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),U={data:!h||h==="text"||h==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:O,config:a,request:u};fr(function(G){s(G),b()},function(G){n(G),b()},U),u=null}"onloadend"in u?u.onloadend=S:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(S)},u.onabort=function(){!u||(n(new te("Request aborted",te.ECONNABORTED,a,u)),u=null)},u.onerror=function(F){const U=F&&F.message?F.message:"Network Error",_=new te(U,te.ERR_NETWORK,a,u);_.event=F||null,n(_),u=null},u.ontimeout=function(){let F=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const U=i.transitional||pr;i.timeoutErrorMessage&&(F=i.timeoutErrorMessage),n(new te(F,U.clarifyTimeoutError?te.ETIMEDOUT:te.ECONNABORTED,a,u)),u=null},o===void 0&&l.setContentType(null),"setRequestHeader"in u&&A.forEach(l.toJSON(),function(F,U){u.setRequestHeader(U,F)}),A.isUndefined(i.withCredentials)||(u.withCredentials=!!i.withCredentials),h&&h!=="json"&&(u.responseType=i.responseType),y&&([x,c]=At(y,!0),u.addEventListener("progress",x)),N&&u.upload&&([p,f]=At(N),u.upload.addEventListener("progress",p),u.upload.addEventListener("loadend",f)),(i.cancelToken||i.signal)&&(m=O=>{!u||(n(!O||O.type?new rt(null,a,u):O),u.abort(),u=null)},i.cancelToken&&i.cancelToken.subscribe(m),i.signal&&(i.signal.aborted?m():i.signal.addEventListener("abort",m)));const k=ci(i.url);if(k&&ue.protocols.indexOf(k)===-1){n(new te("Unsupported protocol "+k+":",te.ERR_BAD_REQUEST,a));return}u.send(o||null)})},yi=(a,r)=>{const{length:s}=a=a?a.filter(Boolean):[];if(r||s){let n=new AbortController,i;const o=function(y){if(!i){i=!0,h();const m=y instanceof Error?y:this.reason;n.abort(m instanceof te?m:new rt(m instanceof Error?m.message:m))}};let l=r&&setTimeout(()=>{l=null,o(new te(`timeout ${r} of ms exceeded`,te.ETIMEDOUT))},r);const h=()=>{a&&(l&&clearTimeout(l),l=null,a.forEach(y=>{y.unsubscribe?y.unsubscribe(o):y.removeEventListener("abort",o)}),a=null)};a.forEach(y=>y.addEventListener("abort",o));const{signal:N}=n;return N.unsubscribe=()=>A.asap(h),N}},bi=yi,Ni=function*(a,r){let s=a.byteLength;if(!r||s<r){yield a;return}let n=0,i;for(;n<s;)i=n+r,yield a.slice(n,i),n=i},vi=async function*(a,r){for await(const s of wi(a))yield*Ni(s,r)},wi=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const r=a.getReader();try{for(;;){const{done:s,value:n}=await r.read();if(s)break;yield n}}finally{await r.cancel()}},Ba=(a,r,s,n)=>{const i=vi(a,r);let o=0,l,h=N=>{l||(l=!0,n&&n(N))};return new ReadableStream({async pull(N){try{const{done:y,value:m}=await i.next();if(y){h(),N.close();return}let p=m.byteLength;if(s){let x=o+=p;s(x)}N.enqueue(new Uint8Array(m))}catch(y){throw h(y),y}},cancel(N){return h(N),i.return()}},{highWaterMark:2})},Ua=64*1024,{isFunction:bt}=A,Ci=(({Request:a,Response:r})=>({Request:a,Response:r}))(A.global),{ReadableStream:ja,TextEncoder:$a}=A.global,za=(a,...r)=>{try{return!!a(...r)}catch{return!1}},ki=a=>{a=A.merge.call({skipUndefined:!0},Ci,a);const{fetch:r,Request:s,Response:n}=a,i=r?bt(r):typeof fetch=="function",o=bt(s),l=bt(n);if(!i)return!1;const h=i&&bt(ja),N=i&&(typeof $a=="function"?(c=>b=>c.encode(b))(new $a):async c=>new Uint8Array(await new s(c).arrayBuffer())),y=o&&h&&za(()=>{let c=!1;const b=new s(ue.origin,{body:new ja,method:"POST",get duplex(){return c=!0,"half"}}).headers.has("Content-Type");return c&&!b}),m=l&&h&&za(()=>A.isReadableStream(new n("").body)),p={stream:m&&(c=>c.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(c=>{!p[c]&&(p[c]=(b,u)=>{let S=b&&b[c];if(S)return S.call(b);throw new te(`Response type '${c}' is not supported`,te.ERR_NOT_SUPPORT,u)})});const x=async c=>{if(c==null)return 0;if(A.isBlob(c))return c.size;if(A.isSpecCompliantForm(c))return(await new s(ue.origin,{method:"POST",body:c}).arrayBuffer()).byteLength;if(A.isArrayBufferView(c)||A.isArrayBuffer(c))return c.byteLength;if(A.isURLSearchParams(c)&&(c=c+""),A.isString(c))return(await N(c)).byteLength},f=async(c,b)=>{const u=A.toFiniteNumber(c.getContentLength());return u==null?x(b):u};return async c=>{let{url:b,method:u,data:S,signal:k,cancelToken:O,timeout:F,onDownloadProgress:U,onUploadProgress:_,responseType:G,headers:W,withCredentials:P="same-origin",fetchOptions:D}=br(c),w=r||fetch;G=G?(G+"").toLowerCase():"text";let M=bi([k,O&&O.toAbortSignal()],F),C=null;const Z=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let ee;try{if(_&&y&&u!=="get"&&u!=="head"&&(ee=await f(W,S))!==0){let H=new s(b,{method:"POST",body:S,duplex:"half"}),X;if(A.isFormData(S)&&(X=H.headers.get("content-type"))&&W.setContentType(X),H.body){const[I,d]=Oa(ee,At(Fa(_)));S=Ba(H.body,Ua,I,d)}}A.isString(P)||(P=P?"include":"omit");const R=o&&"credentials"in s.prototype,q={...D,signal:M,method:u.toUpperCase(),headers:W.normalize().toJSON(),body:S,duplex:"half",credentials:R?P:void 0};C=o&&new s(b,q);let $=await(o?w(C,D):w(b,q));const L=m&&(G==="stream"||G==="response");if(m&&(U||L&&Z)){const H={};["status","statusText","headers"].forEach(E=>{H[E]=$[E]});const X=A.toFiniteNumber($.headers.get("content-length")),[I,d]=U&&Oa(X,At(Fa(U),!0))||[];$=new n(Ba($.body,Ua,I,()=>{d&&d(),Z&&Z()}),H)}G=G||"text";let B=await p[A.findKey(p,G)||"text"]($,c);return!L&&Z&&Z(),await new Promise((H,X)=>{fr(H,X,{data:B,headers:Ae.from($.headers),status:$.status,statusText:$.statusText,config:c,request:C})})}catch(R){throw Z&&Z(),R&&R.name==="TypeError"&&/Load failed|fetch/i.test(R.message)?Object.assign(new te("Network Error",te.ERR_NETWORK,c,C),{cause:R.cause||R}):te.from(R,R&&R.code,c,C)}}},Si=new Map,Nr=a=>{let r=a?a.env:{};const{fetch:s,Request:n,Response:i}=r,o=[n,i,s];let l=o.length,h=l,N,y,m=Si;for(;h--;)N=o[h],y=m.get(N),y===void 0&&m.set(N,y=h?new Map:ki(r)),m=y;return y};Nr();const aa={http:$s,xhr:fi,fetch:{get:Nr}};A.forEach(aa,(a,r)=>{if(a){try{Object.defineProperty(a,"name",{value:r})}catch{}Object.defineProperty(a,"adapterName",{value:r})}});const _a=a=>`- ${a}`,Ti=a=>A.isFunction(a)||a===null||a===!1,vr={getAdapter:(a,r)=>{a=A.isArray(a)?a:[a];const{length:s}=a;let n,i;const o={};for(let l=0;l<s;l++){n=a[l];let h;if(i=n,!Ti(n)&&(i=aa[(h=String(n)).toLowerCase()],i===void 0))throw new te(`Unknown adapter '${h}'`);if(i&&(A.isFunction(i)||(i=i.get(r))))break;o[h||"#"+l]=i}if(!i){const l=Object.entries(o).map(([N,y])=>`adapter ${N} `+(y===!1?"is not supported by the environment":"is not available in the build"));let h=s?l.length>1?`since :
`+l.map(_a).join(`
`):" "+_a(l[0]):"as no adapter specified";throw new te("There is no suitable adapter to dispatch the request "+h,"ERR_NOT_SUPPORT")}return i},adapters:aa};function Jt(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new rt(null,a)}function qa(a){return Jt(a),a.headers=Ae.from(a.headers),a.data=Kt.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),vr.getAdapter(a.adapter||pa.adapter,a)(a).then(function(n){return Jt(a),n.data=Kt.call(a,a.transformResponse,n),n.headers=Ae.from(n.headers),n},function(n){return xr(n)||(Jt(a),n&&n.response&&(n.response.data=Kt.call(a,a.transformResponse,n.response),n.response.headers=Ae.from(n.response.headers))),Promise.reject(n)})}const wr="1.12.2",_t={};["object","boolean","number","function","string","symbol"].forEach((a,r)=>{_t[a]=function(n){return typeof n===a||"a"+(r<1?"n ":" ")+a}});const Ha={};_t.transitional=function(r,s,n){function i(o,l){return"[Axios v"+wr+"] Transitional option '"+o+"'"+l+(n?". "+n:"")}return(o,l,h)=>{if(r===!1)throw new te(i(l," has been removed"+(s?" in "+s:"")),te.ERR_DEPRECATED);return s&&!Ha[l]&&(Ha[l]=!0,console.warn(i(l," has been deprecated since v"+s+" and will be removed in the near future"))),r?r(o,l,h):!0}};_t.spelling=function(r){return(s,n)=>(console.warn(`${n} is likely a misspelling of ${r}`),!0)};function Ei(a,r,s){if(typeof a!="object")throw new te("options must be an object",te.ERR_BAD_OPTION_VALUE);const n=Object.keys(a);let i=n.length;for(;i-- >0;){const o=n[i],l=r[o];if(l){const h=a[o],N=h===void 0||l(h,o,a);if(N!==!0)throw new te("option "+o+" must be "+N,te.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new te("Unknown option "+o,te.ERR_BAD_OPTION)}}const kt={assertOptions:Ei,validators:_t},Oe=kt.validators;class Pt{constructor(r){this.defaults=r||{},this.interceptors={request:new Da,response:new Da}}async request(r,s){try{return await this._request(r,s)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(r,s){typeof r=="string"?(s=s||{},s.url=r):s=r||{},s=Ye(this.defaults,s);const{transitional:n,paramsSerializer:i,headers:o}=s;n!==void 0&&kt.assertOptions(n,{silentJSONParsing:Oe.transitional(Oe.boolean),forcedJSONParsing:Oe.transitional(Oe.boolean),clarifyTimeoutError:Oe.transitional(Oe.boolean)},!1),i!=null&&(A.isFunction(i)?s.paramsSerializer={serialize:i}:kt.assertOptions(i,{encode:Oe.function,serialize:Oe.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),kt.assertOptions(s,{baseUrl:Oe.spelling("baseURL"),withXsrfToken:Oe.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let l=o&&A.merge(o.common,o[s.method]);o&&A.forEach(["delete","get","head","post","put","patch","common"],c=>{delete o[c]}),s.headers=Ae.concat(l,o);const h=[];let N=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(s)===!1||(N=N&&b.synchronous,h.unshift(b.fulfilled,b.rejected))});const y=[];this.interceptors.response.forEach(function(b){y.push(b.fulfilled,b.rejected)});let m,p=0,x;if(!N){const c=[qa.bind(this),void 0];for(c.unshift(...h),c.push(...y),x=c.length,m=Promise.resolve(s);p<x;)m=m.then(c[p++],c[p++]);return m}x=h.length;let f=s;for(;p<x;){const c=h[p++],b=h[p++];try{f=c(f)}catch(u){b.call(this,u);break}}try{m=qa.call(this,f)}catch(c){return Promise.reject(c)}for(p=0,x=y.length;p<x;)m=m.then(y[p++],y[p++]);return m}getUri(r){r=Ye(this.defaults,r);const s=yr(r.baseURL,r.url,r.allowAbsoluteUrls);return hr(s,r.params,r.paramsSerializer)}}A.forEach(["delete","get","head","options"],function(r){Pt.prototype[r]=function(s,n){return this.request(Ye(n||{},{method:r,url:s,data:(n||{}).data}))}});A.forEach(["post","put","patch"],function(r){function s(n){return function(o,l,h){return this.request(Ye(h||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}Pt.prototype[r]=s(),Pt.prototype[r+"Form"]=s(!0)});const St=Pt;class ga{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(o){s=o});const n=this;this.promise.then(i=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](i);n._listeners=null}),this.promise.then=i=>{let o;const l=new Promise(h=>{n.subscribe(h),o=h}).then(i);return l.cancel=function(){n.unsubscribe(o)},l},r(function(o,l,h){n.reason||(n.reason=new rt(o,l,h),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const s=this._listeners.indexOf(r);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const r=new AbortController,s=n=>{r.abort(n)};return this.subscribe(s),r.signal.unsubscribe=()=>this.unsubscribe(s),r.signal}static source(){let r;return{token:new ga(function(i){r=i}),cancel:r}}}const Li=ga;function Ri(a){return function(s){return a.apply(null,s)}}function Ai(a){return A.isObject(a)&&a.isAxiosError===!0}const ra={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ra).forEach(([a,r])=>{ra[r]=a});const Pi=ra;function Cr(a){const r=new St(a),s=tr(St.prototype.request,r);return A.extend(s,St.prototype,r,{allOwnKeys:!0}),A.extend(s,r,null,{allOwnKeys:!0}),s.create=function(i){return Cr(Ye(a,i))},s}const oe=Cr(pa);oe.Axios=St;oe.CanceledError=rt;oe.CancelToken=Li;oe.isCancel=xr;oe.VERSION=wr;oe.toFormData=$t;oe.AxiosError=te;oe.Cancel=oe.CanceledError;oe.all=function(r){return Promise.all(r)};oe.spread=Ri;oe.isAxiosError=Ai;oe.mergeConfig=Ye;oe.AxiosHeaders=Ae;oe.formToJSON=a=>gr(A.isHTMLForm(a)?new FormData(a):a);oe.getAdapter=vr.getAdapter;oe.HttpStatusCode=Pi;oe.default=oe;const Di=oe,yt="production",xa="https://api.tcc-production.com",kr=!1,Sr="error",Mi=yt==="development",Oi=yt==="production",Ue=(a,r,s)=>{a==="error"&&console.log(`[TCC-${a.toUpperCase()}] ${r}`,s||"")};Ue("info","API Configuration:",{environment:yt,apiUrl:xa,debug:kr,logLevel:Sr});const V=Di.create({baseURL:xa,withCredentials:!0,timeout:1e4,headers:{"Content-Type":"application/json","X-Environment":yt,"X-Client-Version":"1.0.0"}});V.defaults.timeout=1e4;V.interceptors.request.use(a=>{const r=localStorage.getItem("token");return r&&(a.headers.Authorization=`Bearer ${r}`),a},a=>(Ue("error","Request interceptor error:",a),Promise.reject(a)));V.interceptors.response.use(a=>a,a=>{var n,i,o;const r=(n=a.response)==null?void 0:n.status,s=(i=a.config)==null?void 0:i.url;return Ue("error",`API Error: ${r} ${s}`,{status:r,message:a.message,response:(o=a.response)==null?void 0:o.data}),r===401?(Ue("warn","Authentication failed, redirecting to login"),localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"):r===403?Ue("warn","Access forbidden"):r>=500?Ue("error","Server error occurred"):a.response||Ue("error","Network error - no response from server"),Promise.reject(a)});const ut={login:a=>(Ue("info","Auth login attempt",{email:a.email}),V.post("/api/auth/login",a)),logout:()=>V.post("/api/auth/logout"),verify:()=>V.get("/api/auth/verify"),register:a=>V.post("/api/auth/register",a),healthcareRegister:a=>V.post("/api/auth/healthcare/register",a),emsRegister:a=>V.post("/api/auth/ems/register",a),healthcareLogin:a=>V.post("/api/auth/healthcare/login",a),emsLogin:a=>V.post("/api/auth/ems/login",a),getUsers:()=>V.get("/api/auth/users")},Fi={getAll:a=>V.get("/api/tcc/hospitals",{params:a}),getById:a=>V.get(`/api/tcc/hospitals/${a}`),create:a=>V.post("/api/tcc/hospitals",a),update:(a,r)=>V.put(`/api/tcc/hospitals/${a}`,r),delete:a=>V.delete(`/api/tcc/hospitals/${a}`),search:a=>V.get("/api/tcc/hospitals/search",{params:{q:a}})},Tt={getAll:a=>V.get("/api/tcc/agencies",{params:a}),getById:a=>V.get(`/api/tcc/agencies/${a}`),create:a=>V.post("/api/tcc/agencies",a),update:(a,r)=>V.put(`/api/tcc/agencies/${a}`,r),updateAgency:(a,r)=>V.put(`/api/tcc/agencies/${a}`,r),delete:a=>V.delete(`/api/tcc/agencies/${a}`),search:a=>V.get("/api/tcc/agencies/search",{params:{q:a}})},Tr={getAll:a=>V.get("/api/tcc/facilities",{params:a}),getById:a=>V.get(`/api/tcc/facilities/${a}`),create:a=>V.post("/api/tcc/facilities",a),update:(a,r)=>V.put(`/api/tcc/facilities/${a}`,r),delete:a=>V.delete(`/api/tcc/facilities/${a}`),search:a=>V.get("/api/tcc/facilities/search",{params:{q:a}})},Ve={getOverview:()=>V.get("/api/tcc/analytics/overview"),getTrips:()=>V.get("/api/tcc/analytics/trips"),getAgencies:()=>V.get("/api/tcc/analytics/agencies"),getHospitals:()=>V.get("/api/tcc/analytics/hospitals"),getCostAnalysis:(a,r)=>V.get("/api/tcc/analytics/cost-analysis",{params:{startDate:a,endDate:r}}),getProfitability:a=>V.get("/api/tcc/analytics/profitability",{params:{period:a}}),getTripCostBreakdowns:(a,r)=>V.get("/api/tcc/analytics/cost-breakdowns",{params:{tripId:a,limit:r}}),createTripCostBreakdown:(a,r)=>V.post("/api/tcc/analytics/cost-breakdown",{tripId:a,breakdownData:r})},Fe={create:a=>V.post("/api/trips",a),createEnhanced:a=>V.post("/api/trips/enhanced",a),getAll:a=>V.get("/api/trips",{params:a}),getById:a=>V.get(`/api/trips/${a}`),updateStatus:(a,r)=>V.put(`/api/trips/${a}/status`,r),getAvailableAgencies:()=>V.get("/api/trips/agencies/available"),getAgenciesForHospital:(a,r)=>V.get(`/api/trips/agencies/${a}`,{params:{radius:r}}),getOptions:{diagnosis:()=>V.get("/api/trips/options/diagnosis"),mobility:()=>V.get("/api/trips/options/mobility"),transportLevel:()=>V.get("/api/trips/options/transport-level"),urgency:()=>V.get("/api/trips/options/urgency"),insurance:()=>V.get("/api/trips/options/insurance")}},Xe={getCategories:()=>V.get("/api/dropdown-options"),getByCategory:a=>V.get(`/api/dropdown-options/${a}`),create:a=>V.post("/api/dropdown-options",a),update:(a,r)=>V.put(`/api/dropdown-options/${a}`,r),delete:a=>V.delete(`/api/dropdown-options/${a}`)},it={getOverview:()=>V.get("/api/ems/analytics/overview"),getTrips:()=>V.get("/api/ems/analytics/trips"),getUnits:()=>V.get("/api/ems/analytics/units"),getPerformance:()=>V.get("/api/ems/analytics/performance")},Ii={isDevelopment:()=>Mi,isProduction:()=>Oi,getEnvironment:()=>yt,getApiUrl:()=>xa,isDebugEnabled:()=>kr,getLogLevel:()=>Sr},Bi=async()=>{try{const a=await V.get("/health");return Ue("info","Health check successful",a.data),{status:"healthy",data:a.data}}catch(a){return Ue("error","Health check failed",a),{status:"unhealthy",error:a}}},qt=Object.freeze(Object.defineProperty({__proto__:null,authAPI:ut,hospitalsAPI:Fi,agenciesAPI:Tt,facilitiesAPI:Tr,analyticsAPI:Ve,tripsAPI:Fe,dropdownOptionsAPI:Xe,emsAnalyticsAPI:it,envUtils:Ii,healthCheck:Bi,default:V},Symbol.toStringTag,{value:"Module"})),Ui=({onLogin:a,onBack:r})=>{const[s,n]=g.exports.useState({email:"",password:""}),[i,o]=g.exports.useState(!1),[l,h]=g.exports.useState(""),N=async m=>{var p,x,f,c;m.preventDefault(),o(!0),h("");try{localStorage.removeItem("token"),localStorage.removeItem("user"),console.log("TCC_DEBUG: Attempting login with:",s);const b=await ut.login(s);console.log("TCC_DEBUG: Login response:",b.data),b.data.success?(console.log("TCC_DEBUG: Login successful, calling onLogin"),a(b.data.user,b.data.token)):(console.log("TCC_DEBUG: Login failed:",b.data.error),h(b.data.error||"Login failed"))}catch(b){console.log("TCC_DEBUG: Login error:",b),console.log("TCC_DEBUG: Error response:",b.response),console.log("TCC_DEBUG: Error status:",(p=b.response)==null?void 0:p.status),console.log("TCC_DEBUG: Error data:",(x=b.response)==null?void 0:x.data),h(((c=(f=b.response)==null?void 0:f.data)==null?void 0:c.error)||"Login failed")}finally{o(!1)}},y=m=>{n(p=>({...p,[m.target.name]:m.target.value}))};return e("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:t("div",{className:"max-w-md w-full space-y-8",children:[t("div",{children:[e("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-primary-100",children:e("svg",{className:"h-8 w-8 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"TCC Admin Login"}),e("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Transport Control Center"})]}),t("form",{className:"mt-8 space-y-6",onSubmit:N,children:[t("div",{className:"rounded-md shadow-sm -space-y-px",children:[t("div",{children:[e("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),e("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:s.email,onChange:y})]}),t("div",{children:[e("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password",value:s.password,onChange:y})]})]}),l&&e("div",{className:"rounded-md bg-red-50 p-4",children:e("div",{className:"text-sm text-red-700",children:l})}),e("div",{children:e("button",{type:"submit",disabled:i,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Signing in...":"Sign in"})}),r&&e("div",{className:"text-center",children:e("button",{onClick:r,className:"text-sm text-gray-600 hover:text-gray-800 transition-colors duration-200",children:"Return to the Login Page"})})]})]})})},ji=()=>{const[a,r]=g.exports.useState(null),[s,n]=g.exports.useState(!0),[i,o]=g.exports.useState("");if(g.exports.useEffect(()=>{(async()=>{var N,y;try{const m=await Ve.getOverview();r(m.data.data)}catch(m){o(((y=(N=m.response)==null?void 0:N.data)==null?void 0:y.error)||"Failed to load overview")}finally{n(!1)}})()},[]),s)return e("div",{className:"flex items-center justify-center h-64",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(i)return e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e("div",{className:"text-red-800",children:i})});const l=[{name:"Total Healthcare Facilities",value:(a==null?void 0:a.totalHospitals)||0,active:(a==null?void 0:a.activeHospitals)||0,icon:ve,color:"bg-blue-500"},{name:"EMS Agencies",value:(a==null?void 0:a.totalAgencies)||0,active:(a==null?void 0:a.activeAgencies)||0,icon:ie,color:"bg-green-500"},{name:"Facilities",value:(a==null?void 0:a.totalFacilities)||0,active:(a==null?void 0:a.activeFacilities)||0,icon:Re,color:"bg-purple-500"},{name:"EMS Units",value:(a==null?void 0:a.totalUnits)||0,active:(a==null?void 0:a.activeUnits)||0,icon:Se,color:"bg-orange-500"}];return t("div",{children:[t("div",{className:"mb-8",children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"System Overview"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Monitor the status of hospitals, EMS agencies, and facilities in the system."})]}),e("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:l.map(h=>e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:`p-3 rounded-md ${h.color}`,children:e(h.icon,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:h.name}),t("dd",{className:"flex items-baseline",children:[e("div",{className:"text-2xl font-semibold text-gray-900",children:h.value}),t("div",{className:"ml-2 text-sm text-gray-500",children:["(",h.active," active)"]})]})]})})]})})},h.name))}),t("div",{className:"mt-8",children:[e("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Actions"}),t("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[t("a",{href:"/dashboard/trips",className:"relative group bg-white p-6 focus-within:ring-2 focus-within:ring-inset focus-within:ring-primary-500 rounded-lg shadow hover:shadow-md transition-shadow",children:[e("div",{children:e("span",{className:"rounded-lg inline-flex p-3 bg-blue-50 text-blue-700 ring-4 ring-white",children:e(ie,{className:"h-6 w-6"})})}),t("div",{className:"mt-4",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Manage Trips"}),e("p",{className:"mt-2 text-sm text-gray-500",children:"View, manage, and monitor all transport requests."})]})]}),t("a",{href:"/dashboard/hospitals",className:"relative group bg-white p-6 focus-within:ring-2 focus-within:ring-inset focus-within:ring-primary-500 rounded-lg shadow hover:shadow-md transition-shadow",children:[e("div",{children:e("span",{className:"rounded-lg inline-flex p-3 bg-green-50 text-green-700 ring-4 ring-white",children:e(ve,{className:"h-6 w-6"})})}),t("div",{className:"mt-4",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Manage Healthcare Facilities"}),e("p",{className:"mt-2 text-sm text-gray-500",children:"Add, edit, or remove healthcare facilities from the system."})]})]}),t("a",{href:"/dashboard/agencies",className:"relative group bg-white p-6 focus-within:ring-2 focus-within:ring-inset focus-within:ring-primary-500 rounded-lg shadow hover:shadow-md transition-shadow",children:[e("div",{children:e("span",{className:"rounded-lg inline-flex p-3 bg-purple-50 text-purple-700 ring-4 ring-white",children:e(ie,{className:"h-6 w-6"})})}),t("div",{className:"mt-4",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Manage EMS Agencies"}),e("p",{className:"mt-2 text-sm text-gray-500",children:"Add, edit, or remove EMS agencies and their units."})]})]})]})]})]})},$i=({trip:a})=>{const[r,s]=g.exports.useState(!1),[n,i]=g.exports.useState([]);g.exports.useEffect(()=>{i((()=>{const p=[];return a.createdAt&&p.push({event:"Trip Created",timestamp:a.createdAt,description:""}),a.requestTimestamp&&p.push({event:"Request Sent",timestamp:a.requestTimestamp,description:""}),a.transferRequestTime&&p.push({event:"Transfer Requested",timestamp:a.transferRequestTime,description:""}),a.acceptedTimestamp&&p.push({event:"Accepted by EMS",timestamp:a.acceptedTimestamp,description:""}),a.emsArrivalTime&&p.push({event:"EMS Arrived",timestamp:a.emsArrivalTime,description:""}),a.pickupTimestamp&&p.push({event:"Patient Picked Up",timestamp:a.pickupTimestamp,description:""}),a.actualStartTime&&p.push({event:"Trip Started",timestamp:a.actualStartTime,description:""}),a.actualEndTime&&p.push({event:"Trip Ended",timestamp:a.actualEndTime,description:""}),a.completionTimestamp&&p.push({event:"Trip Completed",timestamp:a.completionTimestamp,description:""}),p.sort((x,f)=>new Date(x.timestamp).getTime()-new Date(f.timestamp).getTime())})())},[a]);const o=m=>new Date(m).toLocaleString(),l=m=>{console.log("Edit trip:",m.id)},h=m=>{window.confirm(`Are you sure you want to delete trip ${m.tripNumber}?`)&&console.log("Delete trip:",m.id)},N=m=>{switch(m){case"EMERGENT":return"bg-red-100 text-red-800";case"URGENT":return"bg-orange-100 text-orange-800";case"ROUTINE":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},y=m=>{switch(m){case"CRITICAL":return"EMERGENT";case"HIGH":return"URGENT";case"MEDIUM":case"LOW":return"ROUTINE";default:return m}};return t("div",{className:"bg-white shadow rounded-lg border",children:[e("div",{className:"bg-gray-50 px-6 py-3 border-b",children:t("div",{className:"grid grid-cols-5 gap-4 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e("div",{children:"PATIENT"}),e("div",{children:"ROUTE"}),e("div",{children:"PICKUP LOCATION"}),e("div",{children:"PRIORITY"}),e("div",{children:"ACTIONS"})]})}),e("div",{className:"px-6 py-4",children:t("div",{className:"grid grid-cols-5 gap-4",children:[t("div",{children:[e("div",{className:"font-bold text-gray-900",children:a.patientId}),e("div",{className:"text-sm text-gray-500",children:o(a.scheduledTime)})]}),t("div",{children:[e("div",{className:"text-sm text-gray-900",children:a.fromLocation}),t("div",{className:"text-sm text-gray-500 flex items-center",children:[e(Xa,{className:"w-3 h-3 mr-1"}),a.toLocation]})]}),e("div",{children:a.pickupLocation?t("div",{children:[e("div",{className:"font-bold text-gray-900",children:a.pickupLocation.name}),a.pickupLocation.floor&&t("div",{className:"text-xs text-gray-500",children:["Floor: ",a.pickupLocation.floor]}),a.pickupLocation.room&&t("div",{className:"text-xs text-gray-500",children:["Room: ",a.pickupLocation.room]}),t("div",{className:"text-xs text-blue-600 mt-1",children:[t("div",{className:"flex items-center",children:[e(Za,{className:"w-3 h-3 mr-1"}),e("span",{children:"Contact:"})]}),e("div",{className:"text-blue-600",children:a.pickupLocation.contactPhone}),e("div",{className:"text-blue-600",children:a.pickupLocation.contactEmail})]})]}):e("span",{className:"text-gray-400 italic",children:"No specific location"})}),e("div",{children:e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${N(y(a.priority))}`,children:y(a.priority)})}),t("div",{className:"flex flex-col space-y-1",children:[t("div",{className:"flex space-x-1",children:[e("button",{className:"bg-green-600 text-white px-2 py-1 rounded text-xs font-medium hover:bg-green-700",children:"Accept"}),e("button",{className:"bg-red-600 text-white px-2 py-1 rounded text-xs font-medium hover:bg-red-700",children:"Decline"})]}),t("div",{className:"flex space-x-1",children:[e("button",{onClick:()=>l(a),className:"bg-blue-600 text-white px-2 py-1 rounded text-xs font-medium hover:bg-blue-700",children:"Edit"}),e("button",{onClick:()=>h(a),className:"bg-gray-600 text-white px-2 py-1 rounded text-xs font-medium hover:bg-gray-700",children:"Delete"})]})]})]})}),e("div",{className:"bg-gray-50 px-6 py-3 border-t",children:t("div",{className:"grid grid-cols-4 gap-4 text-sm text-gray-600",children:[t("div",{children:["Level: ",a.transportLevel]}),t("div",{children:["Distance: ",a.distanceMiles?`${a.distanceMiles} miles`:"N/A"]}),t("div",{children:["Time: ",a.estimatedTripTimeMinutes?`${a.estimatedTripTimeMinutes} minutes`:"N/A"]}),t("div",{children:["Revenue: ",a.tripCost?`$${Number(a.tripCost).toFixed(2)}`:"N/A"]})]})}),n.length>0&&t("div",{className:"border-t",children:[t("button",{onClick:()=>s(!r),className:"w-full px-6 py-3 text-left text-sm font-medium text-gray-700 hover:bg-gray-50 flex items-center justify-between",children:[t("span",{children:["Trip Timeline (",n.length," events)"]}),r?e(nt,{className:"w-4 h-4"}):e(Ze,{className:"w-4 h-4"})]}),r&&e("div",{className:"px-6 pb-4 bg-gray-50",children:e("div",{className:"grid grid-cols-2 gap-4",children:n.map((m,p)=>t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0 w-2 h-2 bg-blue-600 rounded-full mr-3"}),t("div",{className:"flex-1 flex items-center justify-between",children:[e("p",{className:"text-sm font-medium text-gray-900",children:m.event}),e("p",{className:"text-xs text-gray-400",children:o(m.timestamp)})]})]},p))})})]})]})},zi=({user:a})=>{const r=Ya(),[s,n]=g.exports.useState([]),[i,o]=g.exports.useState([]),[l,h]=g.exports.useState(!0),[N,y]=g.exports.useState(new Date),[m,p]=g.exports.useState(""),[x,f]=g.exports.useState("ALL"),[c,b]=g.exports.useState("ALL"),[u,S]=g.exports.useState("ALL"),[k,O]=g.exports.useState("ALL"),[F,U]=g.exports.useState("ALL"),[_,G]=g.exports.useState(!1),[W]=g.exports.useState(null),[P,D]=g.exports.useState(!1),[w]=g.exports.useState("createdAt"),[M]=g.exports.useState("desc"),C=async()=>{var $,L;try{h(!0);const B=await Fe.getAll();B.data.success?(n(B.data.data),o(B.data.data),y(new Date)):console.error("Failed to fetch trips:",B.data.error)}catch(B){console.error("Failed to fetch trips:",((L=($=B.response)==null?void 0:$.data)==null?void 0:L.error)||B.message)}finally{h(!1)}};g.exports.useEffect(()=>{C()},[]),g.exports.useEffect(()=>{const $=setInterval(C,3e4);return()=>clearInterval($)},[]),g.exports.useEffect(()=>{let $=[...s];if(m){const L=m.toLowerCase();$=$.filter(B=>{var H;return B.tripNumber.toLowerCase().includes(L)||B.patientId.toLowerCase().includes(L)||B.fromLocation.toLowerCase().includes(L)||B.toLocation.toLowerCase().includes(L)||(((H=B.assignedAgency)==null?void 0:H.name)||"").toLowerCase().includes(L)})}if(x!=="ALL"&&($=$.filter(L=>L.status===x)),c!=="ALL"&&($=$.filter(L=>L.priority===c)),u!=="ALL"&&($=$.filter(L=>L.transportLevel===u)),k!=="ALL"){const L=new Date,B=new Date;switch(k){case"24H":B.setHours(L.getHours()-24);break;case"7D":B.setDate(L.getDate()-7);break;case"30D":B.setDate(L.getDate()-30);break}k!=="ALL"&&($=$.filter(H=>new Date(H.createdAt)>=B))}a.userType!=="ADMIN"&&a.facilityName&&($=$.filter(L=>L.fromLocation.toLowerCase().includes(a.facilityName.toLowerCase()))),$.sort((L,B)=>{const H=L[w],X=B[w];return H==null&&X==null?0:H==null?M==="asc"?1:-1:X==null||H<X?M==="asc"?-1:1:H>X?M==="asc"?1:-1:0}),o($)},[s,m,x,c,u,k,F,w,M,a]);const Z=$=>{const L={PENDING:{color:"bg-yellow-100 text-yellow-800",icon:fe},ACCEPTED:{color:"bg-blue-100 text-blue-800",icon:re},DECLINED:{color:"bg-orange-100 text-orange-800",icon:we},IN_PROGRESS:{color:"bg-purple-100 text-purple-800",icon:ie},COMPLETED:{color:"bg-green-100 text-green-800",icon:re},CANCELLED:{color:"bg-red-100 text-red-800",icon:we}},B=L[$]||L.PENDING,H=B.icon;return t("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${B.color}`,children:[e(H,{className:"w-3 h-3 mr-1"}),$.replace("_"," ")]})},ee=$=>{const L={LOW:{color:"bg-gray-100 text-gray-800"},MEDIUM:{color:"bg-yellow-100 text-yellow-800"},HIGH:{color:"bg-orange-100 text-orange-800"},CRITICAL:{color:"bg-red-100 text-red-800"}},B=L[$]||L.LOW;return e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${B.color}`,children:$})},R=$=>new Date($).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),q=()=>{const $=["Trip Number","Patient ID","From Location","Pickup Location","Pickup Floor","Pickup Room","Pickup Contact","To Location","Status","Priority","Transport Level","Scheduled Time","Assigned Agency","Created At"],L=i.map(d=>{var E,z,Q,K,ce,ke;return[d.tripNumber,d.patientId,d.fromLocation,((E=d.pickupLocation)==null?void 0:E.name)||"N/A",((z=d.pickupLocation)==null?void 0:z.floor)||"N/A",((Q=d.pickupLocation)==null?void 0:Q.room)||"N/A",((K=d.pickupLocation)==null?void 0:K.contactPhone)||((ce=d.pickupLocation)==null?void 0:ce.contactEmail)||"N/A",d.toLocation,d.status,d.priority,d.transportLevel,R(d.scheduledTime),((ke=d.assignedAgency)==null?void 0:ke.name)||"Unassigned",R(d.createdAt)]}),B=[$,...L].map(d=>d.map(E=>`"${E}"`).join(",")).join(`
`),H=new Blob([B],{type:"text/csv"}),X=window.URL.createObjectURL(H),I=document.createElement("a");I.href=X,I.download=`trips-${new Date().toISOString().split("T")[0]}.csv`,I.click(),window.URL.revokeObjectURL(X)};return l?e("div",{className:"flex items-center justify-center h-64",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"Trip Management"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Manage and monitor all transport requests"})]}),t("div",{className:"flex items-center space-x-3",children:[t("button",{onClick:C,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e(xe,{className:"w-4 h-4 mr-2"}),"Refresh"]}),t("button",{onClick:q,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e(ze,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]}),t("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-3",children:[e("button",{onClick:()=>r("/dashboard/trips/create"),className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow cursor-pointer",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-green-500",children:e(ie,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Create Trip"}),e("dd",{className:"text-lg font-semibold text-gray-900",children:"New Transport Request"})]})})]})})}),e("button",{onClick:()=>window.location.href="/dashboard/units",className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow cursor-pointer",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-blue-500",children:e(ie,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Units"}),e("dd",{className:"text-lg font-semibold text-gray-900",children:"Manage Units"})]})})]})})}),e("button",{onClick:()=>window.location.href="/dashboard/route-optimization",className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow cursor-pointer",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-purple-500",children:e(Re,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Route Optimization"}),e("dd",{className:"text-lg font-semibold text-gray-900",children:"Optimize Routes"})]})})]})})})]}),t("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-blue-500",children:e(ie,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Trips"}),e("dd",{className:"text-2xl font-semibold text-gray-900",children:s.length})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-yellow-500",children:e(fe,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending"}),e("dd",{className:"text-2xl font-semibold text-gray-900",children:s.filter($=>$.status==="PENDING").length})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-purple-500",children:e(ie,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"In Progress"}),e("dd",{className:"text-2xl font-semibold text-gray-900",children:s.filter($=>$.status==="IN_PROGRESS").length})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-green-500",children:e(re,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Completed"}),e("dd",{className:"text-2xl font-semibold text-gray-900",children:s.filter($=>$.status==="COMPLETED").length})]})})]})})})]}),e("div",{className:"bg-white shadow rounded-lg",children:t("div",{className:"px-4 py-5 sm:p-6",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Filters"}),t("button",{onClick:()=>G(!_),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e(Dt,{className:"w-4 h-4 mr-2"}),_?"Hide Filters":"Show Filters",_?e(nt,{className:"w-4 h-4 ml-2"}):e(Ze,{className:"w-4 h-4 ml-2"})]})]}),_&&t("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Search"}),t("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e(Mt,{className:"h-5 w-5 text-gray-400"})}),e("input",{type:"text",value:m,onChange:$=>p($.target.value),className:"focus:ring-primary-500 focus:border-primary-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search trips..."})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),t("select",{value:x,onChange:$=>f($.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",children:[e("option",{value:"ALL",children:"All Statuses"}),e("option",{value:"PENDING",children:"Pending"}),e("option",{value:"ACCEPTED",children:"Accepted"}),e("option",{value:"IN_PROGRESS",children:"In Progress"}),e("option",{value:"COMPLETED",children:"Completed"}),e("option",{value:"CANCELLED",children:"Cancelled"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Priority"}),t("select",{value:c,onChange:$=>b($.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",children:[e("option",{value:"ALL",children:"All Priorities"}),e("option",{value:"LOW",children:"Low"}),e("option",{value:"MEDIUM",children:"Medium"}),e("option",{value:"HIGH",children:"High"}),e("option",{value:"CRITICAL",children:"Critical"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Transport Level"}),t("select",{value:u,onChange:$=>S($.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",children:[e("option",{value:"ALL",children:"All Levels"}),e("option",{value:"BLS",children:"BLS"}),e("option",{value:"ALS",children:"ALS"}),e("option",{value:"CCT",children:"CCT"}),e("option",{value:"Other",children:"Other"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Date Range"}),t("select",{value:k,onChange:$=>O($.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",children:[e("option",{value:"ALL",children:"All Time"}),e("option",{value:"24H",children:"Last 24 Hours"}),e("option",{value:"7D",children:"Last 7 Days"}),e("option",{value:"30D",children:"Last 30 Days"})]})]}),a.userType==="ADMIN"&&t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Hospital"}),e("select",{value:F,onChange:$=>U($.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",children:e("option",{value:"ALL",children:"All Hospitals"})})]})]})]})}),t("div",{className:"flex items-center justify-between",children:[t("p",{className:"text-sm text-gray-700",children:["Showing ",e("span",{className:"font-medium",children:i.length})," of"," ",e("span",{className:"font-medium",children:s.length})," trips"]}),t("p",{className:"text-sm text-gray-500",children:["Last updated: ",N.toLocaleTimeString()]})]}),t("div",{className:"space-y-4",children:[i.map($=>e($i,{trip:$},$.id)),i.length===0&&t("div",{className:"text-center py-12",children:[e(ie,{className:"mx-auto h-12 w-12 text-gray-400"}),e("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No trips found"}),e("p",{className:"mt-1 text-sm text-gray-500",children:m||x!=="ALL"||c!=="ALL"||u!=="ALL"||k!=="ALL"?"Try adjusting your filters to see more results.":"No trips have been created yet."})]})]}),P&&W&&e("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>D(!1)}),t("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[t("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[t("div",{className:"flex items-center justify-between mb-4",children:[t("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:["Trip Details - ",W.tripNumber]}),e("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-600",children:e(we,{className:"w-6 h-6"})})]}),t("div",{className:"space-y-4",children:[t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Patient ID"}),e("p",{className:"mt-1 text-sm text-gray-900",children:W.patientId})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e("div",{className:"mt-1",children:Z(W.status)})]})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Priority"}),e("div",{className:"mt-1",children:ee(W.priority)})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Transport Level"}),e("p",{className:"mt-1 text-sm text-gray-900",children:W.transportLevel})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"From Location"}),e("p",{className:"mt-1 text-sm text-gray-900",children:W.fromLocation})]}),W.pickupLocation&&t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Pickup Location"}),t("div",{className:"mt-1 p-3 bg-blue-50 rounded-md",children:[e("p",{className:"text-sm font-medium text-gray-900",children:W.pickupLocation.name}),W.pickupLocation.description&&e("p",{className:"text-sm text-gray-600 mt-1",children:W.pickupLocation.description}),t("div",{className:"mt-2 space-y-1",children:[W.pickupLocation.floor&&t("p",{className:"text-xs text-gray-500",children:[e("span",{className:"font-medium",children:"Floor:"})," ",W.pickupLocation.floor]}),W.pickupLocation.room&&t("p",{className:"text-xs text-gray-500",children:[e("span",{className:"font-medium",children:"Room:"})," ",W.pickupLocation.room]}),W.pickupLocation.contactPhone&&t("p",{className:"text-xs text-gray-500",children:[e("span",{className:"font-medium",children:"Phone:"})," ",W.pickupLocation.contactPhone]}),W.pickupLocation.contactEmail&&t("p",{className:"text-xs text-gray-500",children:[e("span",{className:"font-medium",children:"Email:"})," ",W.pickupLocation.contactEmail]})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"To Location"}),e("p",{className:"mt-1 text-sm text-gray-900",children:W.toLocation})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Scheduled Time"}),e("p",{className:"mt-1 text-sm text-gray-900",children:R(W.scheduledTime)})]}),W.assignedAgency&&t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Agency"}),e("p",{className:"mt-1 text-sm text-gray-900",children:W.assignedAgency.name})]}),W.diagnosis&&t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Diagnosis"}),e("p",{className:"mt-1 text-sm text-gray-900",children:W.diagnosis})]}),W.mobilityLevel&&t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Mobility Level"}),e("p",{className:"mt-1 text-sm text-gray-900",children:W.mobilityLevel})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Oxygen Required"}),e("p",{className:"mt-1 text-sm text-gray-900",children:W.oxygenRequired?"Yes":"No"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Monitoring Required"}),e("p",{className:"mt-1 text-sm text-gray-900",children:W.monitoringRequired?"Yes":"No"})]})]})]})]}),e("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:e("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>D(!1),children:"Close"})})]})]})})]})},_i=()=>{const[a,r]=g.exports.useState([]),[s,n]=g.exports.useState(!0),[i,o]=g.exports.useState(null);g.exports.useEffect(()=>{l()},[]);const l=async()=>{try{n(!0);const P=await fetch("/api/tcc/hospitals",{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!P.ok)throw new Error("Failed to fetch hospitals");const D=await P.json();r(D.data||[])}catch(P){o(P.message),console.error("Error fetching hospitals:",P)}finally{n(!1)}},h=async P=>{try{const D=await fetch(`/api/tcc/hospitals/${P}/approve`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!D.ok)throw new Error("Failed to approve hospital");const w=await D.json();console.log("Hospital approved:",w),await l()}catch(D){console.error("Error approving hospital:",D),o("Failed to approve hospital")}},N=async P=>{try{const D=await fetch(`/api/tcc/hospitals/${P}/reject`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!D.ok)throw new Error("Failed to reject hospital");const w=await D.json();console.log("Hospital rejected:",w),await l()}catch(D){console.error("Error rejecting hospital:",D),o("Failed to reject hospital")}},[y,m]=g.exports.useState(null),[p,x]=g.exports.useState({name:"",address:"",city:"",state:"",zipCode:"",phone:"",email:"",type:"",capabilities:[],region:"",latitude:"",longitude:""}),[f,c]=g.exports.useState(!1),[b,u]=g.exports.useState(null),[S,k]=g.exports.useState(!1),O=P=>{var w,M;const D=a.find(C=>C.id===P);D&&(m(D),x({name:D.name,address:D.address,city:D.city,state:D.state,zipCode:D.zipCode,phone:D.phone||"",email:D.email||"",type:D.type,capabilities:D.capabilities,region:D.region,latitude:((w=D.latitude)==null?void 0:w.toString())||"",longitude:((M=D.longitude)==null?void 0:M.toString())||""}),u(null))},F=P=>{const{name:D,value:w}=P.target;x(M=>({...M,[D]:w}))},U=async()=>{if(!p.address||!p.city||!p.state||!p.zipCode){u("Please fill in address, city, state, and ZIP code before looking up coordinates");return}k(!0),u(null);try{const P=`${p.address}, ${p.city}, ${p.state} ${p.zipCode}`,D=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(P)}&limit=1`);if(!D.ok)throw new Error("Geocoding service unavailable");const w=await D.json();if(w&&w.length>0){const M=w[0];x(C=>({...C,latitude:M.lat,longitude:M.lon})),u(null)}else u("Address not found. Please enter coordinates manually.")}catch(P){console.error("Geocoding error:",P),u("Failed to lookup coordinates. Please enter them manually.")}finally{k(!1)}},_=async P=>{if(P.preventDefault(),!!y){c(!0),u(null);try{if(!(await fetch(`/api/tcc/hospitals/${y.id}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(p)})).ok)throw new Error("Failed to update hospital");await l(),m(null)}catch(D){console.error("Error updating hospital:",D),u(D.message||"Failed to update hospital")}finally{c(!1)}}},G=()=>{m(null),u(null)},W=async P=>{if(!!window.confirm("Are you sure you want to delete this hospital? This action cannot be undone."))try{const D=await fetch(`/api/tcc/hospitals/${P}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!D.ok)throw new Error("Failed to delete hospital");const w=await D.json();console.log("Hospital deleted:",w),await l()}catch(D){console.error("Error deleting hospital:",D),o("Failed to delete hospital")}};return s?e("div",{className:"flex items-center justify-center h-64",children:t("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e("p",{className:"mt-2 text-sm text-gray-500",children:"Loading hospitals..."})]})}):i?e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(Ee,{className:"h-5 w-5 text-red-400"}),t("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-red-800",children:"Error loading hospitals"}),e("p",{className:"mt-1 text-sm text-red-700",children:i})]})]})}):t("div",{children:[t("div",{className:"mb-8",children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"Healthcare Facilities"}),t("p",{className:"mt-1 text-sm text-gray-500",children:["Manage healthcare facilities in the system. ",a.length," facilities found."]})]}),t("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e("div",{className:"px-6 py-4 border-b border-gray-200",children:t("div",{className:"flex justify-between items-center",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Healthcare Facilities List"}),t("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/?register=healthcare"},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[e(_e,{className:"h-4 w-4 mr-2"}),"Add Healthcare Facility"]})]})}),a.length===0?t("div",{className:"text-center py-12",children:[e(ve,{className:"mx-auto h-12 w-12 text-gray-400"}),e("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No hospitals found"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding a new hospital."})]}):e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Facility"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(P=>t("tr",{className:"hover:bg-gray-50",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{children:[e("div",{className:"text-sm font-medium text-gray-900",children:P.name}),e("div",{className:"text-sm text-gray-500",children:P.email})]})}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[t("div",{className:"text-sm text-gray-900",children:[P.city,", ",P.state," ",P.zipCode]}),e("div",{className:"text-sm text-gray-500",children:P.address})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:P.type})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{className:"flex items-center",children:[P.isActive?e(re,{className:"h-4 w-4 text-green-500 mr-1"}):P.requiresReview?e(fe,{className:"h-4 w-4 text-yellow-500 mr-1"}):e(Ee,{className:"h-4 w-4 text-red-500 mr-1"}),e("span",{className:`text-sm font-medium ${P.isActive?"text-green-800":P.requiresReview?"text-yellow-800":"text-red-800"}`,children:P.isActive?"Active":P.requiresReview?"Pending Review":"Inactive"})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t("div",{className:"flex space-x-2",children:[P.requiresReview&&t(se,{children:[e("button",{onClick:()=>h(P.id),className:"text-green-600 hover:text-green-900",children:"Approve"}),e("button",{onClick:()=>N(P.id),className:"text-red-600 hover:text-red-900",children:"Reject"})]}),e("button",{onClick:()=>O(P.id),className:"text-blue-600 hover:text-blue-900",title:"Edit hospital",children:e(Ot,{className:"h-4 w-4"})}),e("button",{onClick:()=>W(P.id),className:"text-red-600 hover:text-red-900",title:"Delete hospital",children:e(ht,{className:"h-4 w-4"})})]})})]},P.id))})]})})]}),y&&e("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:t("div",{className:"mt-3",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Healthcare Facility"}),e("button",{onClick:G,className:"text-gray-400 hover:text-gray-600",children:e(Ee,{className:"h-6 w-6"})})]}),b&&e("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(Ee,{className:"h-5 w-5 text-red-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800",children:b})})]})}),t("form",{onSubmit:_,className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Facility Name *"}),e("input",{type:"text",name:"name",value:p.name,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Address *"}),e("input",{type:"text",name:"address",value:p.address,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"City *"}),e("input",{type:"text",name:"city",value:p.city,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"State *"}),e("input",{type:"text",name:"state",value:p.state,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Zip Code *"}),e("input",{type:"text",name:"zipCode",value:p.zipCode,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),e("input",{type:"tel",name:"phone",value:p.phone,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e("input",{type:"email",name:"email",value:p.email,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Type *"}),t("select",{name:"type",value:p.type,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e("option",{value:"",children:"Select type"}),e("option",{value:"Hospital",children:"Hospital"}),e("option",{value:"Clinic",children:"Clinic"}),e("option",{value:"Urgent Care",children:"Urgent Care"}),e("option",{value:"Rehabilitation Facility",children:"Rehabilitation Facility"}),e("option",{value:"Doctor's Office",children:"Doctor's Office"}),e("option",{value:"Dialysis Center",children:"Dialysis Center"}),e("option",{value:"Nursing Home",children:"Nursing Home"}),e("option",{value:"Assisted Living",children:"Assisted Living"}),e("option",{value:"Other",children:"Other"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Region *"}),e("input",{type:"text",name:"region",value:p.region,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t("div",{className:"flex items-center mb-3",children:[e(ve,{className:"h-5 w-5 text-blue-600 mr-2"}),e("h3",{className:"text-sm font-medium text-blue-800",children:"Location Coordinates"})]}),e("p",{className:"text-sm text-blue-700 mb-4",children:"Location coordinates are required for agency distance calculations. You can either lookup coordinates automatically or enter them manually."}),t("div",{className:"space-y-4",children:[t("div",{children:[e("button",{type:"button",onClick:U,disabled:S||!p.address||!p.city||!p.state||!p.zipCode,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:S?t(se,{children:[e("div",{className:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",children:e("div",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full"})}),"Looking up..."]}):t(se,{children:[e(ve,{className:"h-4 w-4 mr-2"}),"Lookup Coordinates"]})}),e("p",{className:"text-xs text-gray-500 mt-1",children:"Click to automatically find coordinates from the address"})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Latitude"}),e("input",{type:"number",step:"any",name:"latitude",value:p.latitude,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 40.1234"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Longitude"}),e("input",{type:"number",step:"any",name:"longitude",value:p.longitude,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., -78.5678"})]})]}),p.latitude&&p.longitude&&t("div",{className:"text-sm text-green-600 bg-green-50 border border-green-200 rounded p-2",children:["\u2713 Coordinates set: ",p.latitude,", ",p.longitude]})]})]}),t("div",{className:"flex justify-end space-x-3 pt-4",children:[e("button",{type:"button",onClick:G,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e("button",{type:"submit",disabled:f,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:f?"Updating...":"Update Facility"})]})]})]})})})]})},qi=()=>{const[a,r]=g.exports.useState([]),[s,n]=g.exports.useState(!0),[i,o]=g.exports.useState(null),[l,h]=g.exports.useState(""),[N,y]=g.exports.useState("all"),[m,p]=g.exports.useState(null),[x,f]=g.exports.useState({name:"",contactName:"",phone:"",email:"",address:"",city:"",state:"",zipCode:"",serviceType:"BLS/ALS"}),[c,b]=g.exports.useState(!1),[u,S]=g.exports.useState(null);g.exports.useEffect(()=>{k()},[]);const k=async()=>{try{n(!0);const P=await Tt.getAll();if(P.data.success){const D=P.data.data.map(w=>{var M,C,Z,ee,R,q,$,L,B,H,X,I;return{...w,contactName:((M=w.contactInfo)==null?void 0:M.contactName)||"N/A",phone:((C=w.contactInfo)==null?void 0:C.phone)||"N/A",email:((Z=w.contactInfo)==null?void 0:Z.email)||"N/A",address:((ee=w.contactInfo)==null?void 0:ee.address)||"N/A",city:((R=w.contactInfo)==null?void 0:R.city)||"N/A",state:((q=w.contactInfo)==null?void 0:q.state)||"N/A",zipCode:(($=w.contactInfo)==null?void 0:$.zipCode)||"N/A",capabilities:((L=w.contactInfo)==null?void 0:L.capabilities)||[],serviceArea:((B=w.contactInfo)==null?void 0:B.serviceArea)||[],operatingHours:((H=w.contactInfo)==null?void 0:H.operatingHours)||null,pricingStructure:((X=w.contactInfo)==null?void 0:X.pricingStructure)||null,status:((I=w.contactInfo)==null?void 0:I.status)||"ACTIVE"}});r(D)}else o("Failed to load agencies")}catch(P){console.error("Error loading agencies:",P),o("Failed to load agencies")}finally{n(!1)}},O=P=>{p(P),f({name:P.name,contactName:P.contactName,phone:P.phone,email:P.email,address:P.address,city:P.city,state:P.state,zipCode:P.zipCode,serviceType:"BLS/ALS"}),S(null)},F=P=>{const{name:D,value:w}=P.target;f(M=>({...M,[D]:w}))},U=async P=>{var D,w;if(P.preventDefault(),!!m){b(!0),S(null);try{const M=await Tt.updateAgency(m.id,x);M.data.success?(r(a.map(C=>C.id===m.id?{...C,...x,updatedAt:new Date().toISOString()}:C)),p(null)):S(M.data.error||"Failed to update agency")}catch(M){console.error("Error updating agency:",M),S(((w=(D=M.response)==null?void 0:D.data)==null?void 0:w.error)||"Failed to update agency")}finally{b(!1)}}},_=()=>{p(null),f({name:"",contactName:"",phone:"",email:"",address:"",city:"",state:"",zipCode:"",serviceType:"BLS/ALS"}),S(null)},G=async P=>{if(window.confirm("Are you sure you want to delete this agency?"))try{await Tt.delete(P),await k()}catch(D){console.error("Error deleting agency:",D),o("Failed to delete agency")}},W=a.filter(P=>{const D=P.name.toLowerCase().includes(l.toLowerCase())||P.contactName.toLowerCase().includes(l.toLowerCase())||P.city.toLowerCase().includes(l.toLowerCase()),w=N==="all"||N==="active"&&P.isActive||N==="inactive"&&!P.isActive;return D&&w});return s?e("div",{className:"flex justify-center items-center h-64",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):t("div",{children:[t("div",{className:"mb-8",children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"EMS Agencies"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Manage EMS agencies and their capabilities."})]}),i&&e("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:i}),t("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[e("div",{className:"flex-1",children:t("div",{className:"relative",children:[e(Mt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e("input",{type:"text",placeholder:"Search agencies...",value:l,onChange:P=>h(P.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent w-full"})]})}),t("div",{className:"flex gap-2",children:[t("select",{value:N,onChange:P=>y(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e("option",{value:"all",children:"All Status"}),e("option",{value:"active",children:"Active"}),e("option",{value:"inactive",children:"Inactive"})]}),t("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/?register=ems"},className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[e(_e,{className:"h-4 w-4 mr-2"}),"Add Agency"]}),e("button",{onClick:k,className:"inline-flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:e(xe,{className:"h-4 w-4"})})]})]}),e("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:W.length===0?t("div",{className:"text-center py-12",children:[e(ie,{className:"mx-auto h-12 w-12 text-gray-400"}),e("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No agencies found"}),e("p",{className:"mt-1 text-sm text-gray-500",children:l?"Try adjusting your search terms.":"Get started by adding a new agency."})]}):e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agency"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capabilities"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:W.map(P=>t("tr",{className:"hover:bg-gray-50",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{children:[e("div",{className:"text-sm font-medium text-gray-900",children:P.name}),t("div",{className:"text-sm text-gray-500",children:["ID: ",P.id]})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{children:[e("div",{className:"text-sm text-gray-900",children:P.contactName}),t("div",{className:"text-sm text-gray-500 flex items-center",children:[e(Za,{className:"h-3 w-3 mr-1"}),P.phone]}),t("div",{className:"text-sm text-gray-500 flex items-center",children:[e(ia,{className:"h-3 w-3 mr-1"}),P.email]})]})}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[t("div",{className:"text-sm text-gray-900",children:[P.city,", ",P.state]}),t("div",{className:"text-sm text-gray-500 flex items-center",children:[e(Re,{className:"h-3 w-3 mr-1"}),P.address]})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("div",{className:"flex flex-wrap gap-1",children:P.capabilities&&P.capabilities.length>0?P.capabilities.map(D=>e("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:D},D)):e("span",{className:"text-gray-500 text-sm",children:"No capabilities"})})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{className:"flex items-center",children:[P.isActive?e(re,{className:"h-4 w-4 text-green-500 mr-2"}):e(Ee,{className:"h-4 w-4 text-red-500 mr-2"}),e("span",{className:`text-sm font-medium ${P.isActive?"text-green-600":"text-red-600"}`,children:P.isActive?"Active":"Inactive"})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:t("div",{className:"flex justify-end space-x-2",children:[e("button",{onClick:()=>O(P),className:"text-primary-600 hover:text-primary-900",children:e(Ot,{className:"h-4 w-4"})}),e("button",{onClick:()=>G(P.id),className:"text-red-600 hover:text-red-900",children:e(ht,{className:"h-4 w-4"})})]})})]},P.id))})]})})}),m&&e("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:t("div",{className:"mt-3",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Agency"}),e("button",{onClick:_,className:"text-gray-400 hover:text-gray-600",children:e(Ee,{className:"h-6 w-6"})})]}),u&&e("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:t("div",{className:"flex",children:[e(Ee,{className:"h-5 w-5 text-red-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800",children:u})})]})}),t("form",{onSubmit:U,className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Agency Name"}),e("input",{type:"text",name:"name",value:x.name,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Name"}),e("input",{type:"text",name:"contactName",value:x.contactName,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500",required:!0})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),e("input",{type:"tel",name:"phone",value:x.phone,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e("input",{type:"email",name:"email",value:x.email,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500",required:!0})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),e("input",{type:"text",name:"address",value:x.address,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),t("div",{className:"grid grid-cols-3 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),e("input",{type:"text",name:"city",value:x.city,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),e("input",{type:"text",name:"state",value:x.state,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"ZIP Code"}),e("input",{type:"text",name:"zipCode",value:x.zipCode,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Service Type"}),t("select",{name:"serviceType",value:x.serviceType,onChange:F,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500",children:[e("option",{value:"BLS",children:"BLS Only"}),e("option",{value:"ALS",children:"ALS Only"}),e("option",{value:"BLS/ALS",children:"BLS/ALS"}),e("option",{value:"Critical Care",children:"Critical Care"})]})]}),t("div",{className:"flex justify-end space-x-3 pt-4",children:[e("button",{type:"button",onClick:_,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),e("button",{type:"submit",disabled:c,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:c?"Saving...":"Save Changes"})]})]})]})})})]})},Hi=()=>{const[a,r]=g.exports.useState([]),[s,n]=g.exports.useState(!1),[i,o]=g.exports.useState(!1),[l,h]=g.exports.useState(!1),[N,y]=g.exports.useState(null),[m,p]=g.exports.useState({patientId:"",originFacilityId:"",destinationFacilityId:"",transportLevel:"BLS",priority:"MEDIUM",specialRequirements:"",readyStart:"",readyEnd:"",isolation:!1,bariatric:!1});g.exports.useEffect(()=>{x()},[]);const x=async()=>{try{n(!0);const b=await Tr.getAll();r(b.data.data||[])}catch(b){console.error("TCC_DEBUG: Error loading facilities:",b),y("Failed to load facilities")}finally{n(!1)}},f=b=>{const{name:u,value:S,type:k}=b.target;if(k==="checkbox"){const O=b.target.checked;p(F=>({...F,[u]:O}))}else p(O=>({...O,[u]:S}))},c=async b=>{var u,S;if(b.preventDefault(),!m.patientId||!m.originFacilityId||!m.destinationFacilityId){y("Please fill in all required fields");return}if(!m.readyStart||!m.readyEnd){y("Please select ready time window");return}try{o(!0),y(null);const k=await Fe.create(m);k.data.success?(h(!0),p({patientId:"",originFacilityId:"",destinationFacilityId:"",transportLevel:"BLS",priority:"MEDIUM",specialRequirements:"",readyStart:"",readyEnd:"",isolation:!1,bariatric:!1}),setTimeout(()=>h(!1),5e3)):y(k.data.error||"Failed to create transport request")}catch(k){console.error("TCC_DEBUG: Error creating trip:",k),y(((S=(u=k.response)==null?void 0:u.data)==null?void 0:S.error)||"Failed to create transport request")}finally{o(!1)}};return s?e("div",{className:"flex items-center justify-center h-64",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e("div",{className:"max-w-4xl mx-auto",children:t("div",{className:"bg-white shadow rounded-lg",children:[t("div",{className:"px-6 py-4 border-b border-gray-200",children:[t("div",{className:"flex items-center",children:[e(_e,{className:"h-6 w-6 text-primary-600 mr-3"}),e("h2",{className:"text-xl font-semibold text-gray-900",children:"Create Transport Request"})]}),e("p",{className:"mt-1 text-sm text-gray-600",children:"Submit a new transport request for patient transfer"})]}),t("form",{onSubmit:c,className:"p-6 space-y-6",children:[l&&e("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(re,{className:"h-5 w-5 text-green-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-green-800",children:"Transport request created successfully!"})})]})}),N&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(Ee,{className:"h-5 w-5 text-red-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800",children:N})})]})}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t("div",{children:[e("label",{htmlFor:"patientId",className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient ID *"}),e("input",{type:"text",id:"patientId",name:"patientId",value:m.patientId,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter patient ID",required:!0})]})}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{htmlFor:"originFacilityId",className:"block text-sm font-medium text-gray-700 mb-2",children:"Origin Facility *"}),t("select",{id:"originFacilityId",name:"originFacilityId",value:m.originFacilityId,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",required:!0,children:[e("option",{value:"",children:"Select origin facility"}),a.map(b=>t("option",{value:b.id,children:[b.name," - ",b.city,", ",b.state]},b.id))]})]}),t("div",{children:[e("label",{htmlFor:"destinationFacilityId",className:"block text-sm font-medium text-gray-700 mb-2",children:"Destination Facility *"}),t("select",{id:"destinationFacilityId",name:"destinationFacilityId",value:m.destinationFacilityId,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",required:!0,children:[e("option",{value:"",children:"Select destination facility"}),a.map(b=>t("option",{value:b.id,children:[b.name," - ",b.city,", ",b.state]},b.id))]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{htmlFor:"transportLevel",className:"block text-sm font-medium text-gray-700 mb-2",children:"Level of Service *"}),t("select",{id:"transportLevel",name:"transportLevel",value:m.transportLevel,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",required:!0,children:[e("option",{value:"BLS",children:"BLS - Basic Life Support"}),e("option",{value:"ALS",children:"ALS - Advanced Life Support"}),e("option",{value:"CCT",children:"CCT - Critical Care Transport"})]})]}),t("div",{children:[e("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority Level *"}),t("select",{id:"priority",name:"priority",value:m.priority,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",required:!0,children:[e("option",{value:"LOW",children:"LOW - Non-urgent"}),e("option",{value:"MEDIUM",children:"MEDIUM - Standard"}),e("option",{value:"HIGH",children:"HIGH - Urgent"}),e("option",{value:"CRITICAL",children:"CRITICAL - Emergency"})]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{htmlFor:"readyStart",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ready Start Time *"}),e("input",{type:"datetime-local",id:"readyStart",name:"readyStart",value:m.readyStart,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",required:!0})]}),t("div",{children:[e("label",{htmlFor:"readyEnd",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ready End Time *"}),e("input",{type:"datetime-local",id:"readyEnd",name:"readyEnd",value:m.readyEnd,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",required:!0})]})]}),t("div",{children:[e("label",{htmlFor:"specialRequirements",className:"block text-sm font-medium text-gray-700 mb-2",children:"Special Requirements"}),e("textarea",{id:"specialRequirements",name:"specialRequirements",value:m.specialRequirements,onChange:f,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter any special requirements or notes..."})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Special Requirements"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",id:"isolation",name:"isolation",checked:m.isolation,onChange:f,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e("label",{htmlFor:"isolation",className:"ml-2 block text-sm text-gray-900",children:t("div",{className:"flex items-center",children:[e(na,{className:"h-4 w-4 text-yellow-600 mr-1"}),"Isolation Required"]})})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",id:"bariatric",name:"bariatric",checked:m.bariatric,onChange:f,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e("label",{htmlFor:"bariatric",className:"ml-2 block text-sm text-gray-900",children:t("div",{className:"flex items-center",children:[e($r,{className:"h-4 w-4 text-blue-600 mr-1"}),"Bariatric Transport"]})})]})]})]}),e("div",{className:"flex justify-end",children:e("button",{type:"submit",disabled:i,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?t(se,{children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating Request..."]}):t(se,{children:[e(_e,{className:"h-4 w-4 mr-2"}),"Create Transport Request"]})})})]})]})})},Er=()=>{const[a,r]=g.exports.useState([]),[s,n]=g.exports.useState(!1),[i,o]=g.exports.useState(!1);g.exports.useEffect(()=>{l()},[]);const l=async()=>{o(!0);try{const p=await fetch("/api/notifications",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(p.ok){const x=await p.json();if(x.success&&x.data){const f=x.data.map(c=>({id:c.id,type:c.type||"info",title:c.title||"Notification",message:c.message||"",timestamp:new Date(c.createdAt),read:c.read||!1}));r(f)}}}catch(p){console.error("Error loading notifications:",p)}finally{o(!1)}},h=async p=>{try{(await fetch(`/api/notifications/${p}/read`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok&&r(f=>f.map(c=>c.id===p?{...c,read:!0}:c))}catch(x){console.error("Error marking notification as read:",x)}},N=async()=>{try{(await fetch("/api/notifications/read-all",{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok&&r(x=>x.map(f=>({...f,read:!0})))}catch(p){console.error("Error marking all notifications as read:",p)}},y=p=>{switch(p){case"success":return e(re,{className:"h-5 w-5 text-green-500"});case"error":return e(he,{className:"h-5 w-5 text-red-500"});case"warning":return e(he,{className:"h-5 w-5 text-yellow-500"});default:return e(zr,{className:"h-5 w-5 text-blue-500"})}},m=a.filter(p=>!p.read).length;return t("div",{className:"relative",children:[t("button",{onClick:()=>n(!s),className:"p-2 text-gray-400 hover:text-gray-600 relative",children:[e(Qe,{className:"h-5 w-5"}),m>0&&e("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:m})]}),s&&t("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[e("div",{className:"p-4 border-b border-gray-200",children:t("div",{className:"flex justify-between items-center",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Notifications"}),t("div",{className:"flex space-x-2",children:[m>0&&e("button",{onClick:N,className:"text-sm text-blue-600 hover:text-blue-800",children:"Mark all read"}),e("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600",children:e(we,{className:"h-4 w-4"})})]})]})}),e("div",{className:"max-h-96 overflow-y-auto",children:i?e("div",{className:"p-4 text-center text-gray-500",children:"Loading notifications..."}):a.length===0?e("div",{className:"p-4 text-center text-gray-500",children:"No notifications"}):a.map(p=>e("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer ${p.read?"":"bg-blue-50"}`,onClick:()=>h(p.id),children:t("div",{className:"flex items-start space-x-3",children:[y(p.type),t("div",{className:"flex-1 min-w-0",children:[e("p",{className:"text-sm font-medium text-gray-900",children:p.title}),e("p",{className:"text-sm text-gray-600 mt-1",children:p.message}),e("p",{className:"text-xs text-gray-400 mt-1",children:p.timestamp.toLocaleString()})]}),!p.read&&e("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]})},p.id))}),e("div",{className:"p-4 border-t border-gray-200",children:e("button",{onClick:l,className:"w-full text-sm text-blue-600 hover:text-blue-800",children:"Refresh"})})]})]})},Nt={AMBULANCE:"Ambulance",WHEELCHAIR_VAN:"Wheelchair Van",CRITICAL_CARE:"Critical Care",OTHER:"Other"},Wa={AVAILABLE:"Available",COMMITTED:"Committed",OUT_OF_SERVICE:"Out of Service",MAINTENANCE:"Maintenance",OFF_DUTY:"Off Duty"},Wi={AVAILABLE:"text-green-600 bg-green-100",COMMITTED:"text-blue-600 bg-blue-100",OUT_OF_SERVICE:"text-red-600 bg-red-100",MAINTENANCE:"text-yellow-600 bg-yellow-100",OFF_DUTY:"text-gray-600 bg-gray-100"},Ga={BLS:"Basic Life Support",ALS:"Advanced Life Support",CCT:"Critical Care Transport",WHEELCHAIR:"Wheelchair Transport",STRETCHER:"Stretcher Transport",OXYGEN:"Oxygen Delivery",MONITORING:"Patient Monitoring",VENTILATOR:"Ventilator Support",CUSTOM:"Custom Capability"},Gi=()=>{const[a,r]=g.exports.useState([]),[s,n]=g.exports.useState(null),[i,o]=g.exports.useState(!0),[l,h]=g.exports.useState(null),[N,y]=g.exports.useState(!1),[m,p]=g.exports.useState(!1),[x,f]=g.exports.useState(null),[c,b]=g.exports.useState(""),[u,S]=g.exports.useState("ALL"),[k,O]=g.exports.useState("ALL"),[F,U]=g.exports.useState({unitNumber:"",type:"AMBULANCE",capabilities:["BLS"],customCapabilities:[],isActive:!0}),[_,G]=g.exports.useState(!1),[W,P]=g.exports.useState(null),D=async()=>{var L;try{console.log("\u{1F50D} UnitsManagement: fetchUnits called"),o(!0);const B=localStorage.getItem("token"),H="https://api.tcc-production.com";console.log("\u{1F50D} UnitsManagement: API_BASE_URL:",H),console.log("\u{1F50D} UnitsManagement: token present:",!!B);const X=await fetch(`${H}/api/units`,{headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});if(!X.ok)throw new Error("Failed to fetch units");const I=await X.json();if(console.log("\u{1F50D} UnitsManagement: API response:",I),I.success)console.log("\u{1F50D} UnitsManagement: Units count:",((L=I.data)==null?void 0:L.length)||0),r(I.data||[]);else throw new Error(I.error||"Failed to fetch units")}catch(B){console.error("Error fetching units:",B),h(B.message)}finally{o(!1)}},w=async()=>{try{const L=localStorage.getItem("token"),H=await fetch("https://api.tcc-production.com/api/units/analytics",{headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});if(!H.ok)throw new Error("Failed to fetch analytics");const X=await H.json();X.success&&n(X.data)}catch(L){console.error("Error fetching analytics:",L)}};g.exports.useEffect(()=>{console.log("\u{1F50D} UnitsManagement: useEffect called, component mounted"),D(),w()},[]);const M=async L=>{L.preventDefault(),G(!0),P(null);try{const B=localStorage.getItem("token"),H="https://api.tcc-production.com",X=x?`${H}/api/units/${x.id}`:`${H}/api/units`,E=await(await fetch(X,{method:x?"PUT":"POST",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"},body:JSON.stringify(F)})).json();if(E.success)await D(),await w(),y(!1),p(!1),f(null),Z();else throw new Error(E.error||"Failed to save unit")}catch(B){console.error("Error saving unit:",B),P(B.message)}finally{G(!1)}},C=async L=>{if(!!confirm("Are you sure you want to delete this unit?"))try{const B=localStorage.getItem("token"),I=await(await fetch(`https://api.tcc-production.com/api/units/${L}`,{method:"DELETE",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}})).json();if(I.success)await D(),await w();else throw new Error(I.error||"Failed to delete unit")}catch(B){console.error("Error deleting unit:",B),h(B.message)}},Z=()=>{U({unitNumber:"",type:"AMBULANCE",capabilities:["BLS"],customCapabilities:[],isActive:!0}),P(null)},ee=L=>{f(L),U({unitNumber:L.unitNumber,type:L.type,capabilities:L.capabilities,customCapabilities:[],isActive:L.isActive}),p(!0)},R=a.filter(L=>{const B=L.unitNumber.toLowerCase().includes(c.toLowerCase())||Nt[L.type].toLowerCase().includes(c.toLowerCase()),H=u==="ALL"||L.currentStatus===u,X=k==="ALL"||L.type===k;return B&&H&&X}),q=L=>{const B=Wi[L];return e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${B}`,children:Wa[L]})},$=L=>L.map(B=>e("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800 mr-1 mb-1",children:Ga[B]},B));return i?t("div",{className:"flex items-center justify-center h-64",children:[e(xe,{className:"h-8 w-8 animate-spin text-orange-600"}),e("span",{className:"ml-2 text-gray-600",children:"Loading units..."})]}):t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold text-gray-900",children:"Units Management"}),e("p",{className:"text-gray-600",children:"Manage your EMS units and track their status"})]}),t("button",{onClick:()=>y(!0),className:"flex items-center space-x-2 bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors",children:[e(_e,{className:"h-4 w-4"}),e("span",{children:"Add Unit"})]})]}),s&&t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(ie,{className:"h-8 w-8 text-blue-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Total Units"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:s.totalUnits})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(re,{className:"h-8 w-8 text-green-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Available"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:s.availableUnits})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(Se,{className:"h-8 w-8 text-blue-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Active Trips"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:s.committedUnits})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(me,{className:"h-8 w-8 text-purple-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Efficiency"}),t("p",{className:"text-2xl font-semibold text-gray-900",children:[Math.round(s.efficiency*100),"%"]})]})]})})]}),e("div",{className:"bg-white p-4 rounded-lg shadow",children:t("div",{className:"flex flex-wrap gap-4 items-center",children:[t("div",{className:"flex items-center space-x-2",children:[e(Mt,{className:"h-4 w-4 text-gray-400"}),e("input",{type:"text",placeholder:"Search units...",value:c,onChange:L=>b(L.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),t("div",{className:"flex items-center space-x-2",children:[e(Dt,{className:"h-4 w-4 text-gray-400"}),t("select",{value:u,onChange:L=>S(L.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e("option",{value:"ALL",children:"All Statuses"}),Object.entries(Wa).map(([L,B])=>e("option",{value:L,children:B},L))]})]}),e("div",{className:"flex items-center space-x-2",children:t("select",{value:k,onChange:L=>O(L.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e("option",{value:"ALL",children:"All Types"}),Object.entries(Nt).map(([L,B])=>e("option",{value:L,children:B},L))]})}),t("button",{onClick:()=>{D(),w()},className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800",children:[e(xe,{className:"h-4 w-4"}),e("span",{children:"Refresh"})]})]})}),l&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(he,{className:"h-5 w-5 text-red-400"}),t("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e("p",{className:"text-sm text-red-700 mt-1",children:l})]})]})}),e("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:t("div",{className:"px-4 py-5 sm:p-6",children:[t("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:["Units (",R.length,")"]}),R.length===0?t("div",{className:"text-center py-8",children:[e(ie,{className:"mx-auto h-12 w-12 text-gray-400"}),e("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No units found"}),e("p",{className:"mt-1 text-sm text-gray-500",children:a.length===0?"Get started by creating your first unit.":"Try adjusting your search or filter criteria."}),a.length===0&&e("div",{className:"mt-6",children:t("button",{onClick:()=>y(!0),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700",children:[e(_e,{className:"h-4 w-4 mr-2"}),"Add Unit"]})})]}):e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capabilities"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:R.map(L=>t("tr",{className:"hover:bg-gray-50",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{children:[e("div",{className:"text-sm font-medium text-gray-900",children:L.unitNumber}),e("div",{className:"text-sm text-gray-500",children:L.isActive?"Active":"Inactive"})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("div",{className:"text-sm text-gray-900",children:Nt[L.type]})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:q(L.currentStatus)}),e("td",{className:"px-6 py-4",children:e("div",{className:"flex flex-wrap",children:$(L.capabilities)})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t("div",{children:[t("div",{children:[L.totalTripsCompleted," trips"]}),L.averageResponseTime&&t("div",{className:"text-gray-500",children:[L.averageResponseTime.toFixed(1),"min avg"]})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>ee(L),className:"text-orange-600 hover:text-orange-900",children:e(Ot,{className:"h-4 w-4"})}),e("button",{onClick:()=>C(L.id),className:"text-red-600 hover:text-red-900",children:e(ht,{className:"h-4 w-4"})})]})})]},L.id))})]})})]})}),(N||m)&&e("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:t("div",{className:"mt-3",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:x?"Edit Unit":"Create New Unit"}),t("form",{onSubmit:M,className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Number"}),e("input",{type:"text",required:!0,value:F.unitNumber,onChange:L=>U({...F,unitNumber:L.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"e.g., A-101"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Unit Type"}),e("select",{value:F.type,onChange:L=>U({...F,type:L.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",children:Object.entries(Nt).map(([L,B])=>e("option",{value:L,children:B},L))})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Capabilities"}),e("div",{className:"mt-2 space-y-2",children:Object.entries(Ga).map(([L,B])=>t("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:F.capabilities.includes(L),onChange:H=>{const X=L;H.target.checked?U({...F,capabilities:[...F.capabilities,X]}):U({...F,capabilities:F.capabilities.filter(I=>I!==X)})},className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500"}),e("span",{className:"ml-2 text-sm text-gray-700",children:B})]},L))})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:F.isActive,onChange:L=>U({...F,isActive:L.target.checked}),className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500"}),e("label",{className:"ml-2 text-sm text-gray-700",children:"On Duty"}),e("p",{className:"ml-2 text-xs text-gray-500",children:"Check if unit is currently on duty"})]}),W&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e("p",{className:"text-sm text-red-700",children:W})}),t("div",{className:"flex justify-end space-x-3 pt-4",children:[e("button",{type:"button",onClick:()=>{y(!1),p(!1),f(null),Z()},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),e("button",{type:"submit",disabled:_,className:"px-4 py-2 bg-orange-600 text-white rounded-md text-sm font-medium hover:bg-orange-700 disabled:opacity-50",children:_?"Saving...":x?"Update":"Create"})]})]})]})})})]})},Lr=()=>{var K,ce,ke;const[a,r]=g.exports.useState(()=>{const v=localStorage.getItem("revenue_settings");return v?JSON.parse(v):{baseRates:{BLS:150,ALS:250,CCT:400},perMileRates:{BLS:2.5,ALS:3.75,CCT:5},priorityMultipliers:{LOW:1,MEDIUM:1.1,HIGH:1.25,URGENT:1.5},specialRequirementsSurcharge:50,insuranceRates:{medicare:.85,medicaid:.8,private:1},crewRoles:{EMT:25,Paramedic:35,RN:45,CCTSpecialist:40,CriticalCareParamedic:42},overtimeMultiplier:1.5,shiftLengthHours:12,maxOvertimeHours:4,vehicleCostPerMile:.75,fuelCostPerMile:.25,maintenanceCostPerMile:.15,crewComposition:{BLS:["EMT","EMT"],ALS:["EMT","Paramedic"],CCT:["RN","CriticalCareParamedic"]},timeBasedPricing:{peakHourMultipliers:{"6-9AM":1.3,"5-8PM":1.4,Other:1},weekendMultipliers:{Saturday:1.2,Sunday:1.3,Weekday:1},seasonalMultipliers:{Winter:1.1,Spring:1,Summer:1,Fall:1}},geographicPricing:{zoneMultipliers:{Urban:1,Suburban:1.1,Rural:1.3,Remote:1.5},distanceTiers:{"0-10mi":1,"10-25mi":.95,"25-50mi":.9,"50+mi":.85}},serviceSpecificPricing:{specialRequirements:{Oxygen:25,Monitoring:50,Isolation:75,Bariatric:100},isolationPricing:75,bariatricPricing:100,oxygenPricing:25,monitoringPricing:50},insuranceSpecificRates:{Medicare:.85,Medicaid:.8,Private:1,SelfPay:1.2},routeOptimization:{deadheadMileWeight:1,waitTimeWeight:1,backhaulBonusWeight:1,overtimeRiskWeight:1,revenueWeight:1,crewAvailabilityWeight:1,equipmentCompatibilityWeight:1,patientPriorityWeight:1,maxDeadheadMiles:50,maxWaitTimeMinutes:30,maxOvertimeHours:4,maxResponseTimeMinutes:15,maxServiceDistance:100,backhaulTimeWindow:60,backhaulDistanceLimit:25,backhaulRevenueBonus:50,enableBackhaulOptimization:!0,targetLoadedMileRatio:.75,targetRevenuePerHour:200,targetResponseTime:12,targetEfficiency:.85,optimizationAlgorithm:"HYBRID",maxOptimizationTime:30,enableRealTimeOptimization:!0}}}),[s,n]=g.exports.useState({standardRate:0,mileageRate:0,insuranceRate:0,crewCost:0,vehicleCost:0,totalCost:0,netProfit:0,profitMargin:0}),[i,o]=g.exports.useState({totalRevenue:0,totalDeadheadMiles:0,totalWaitTime:0,totalOvertimeRisk:0,backhaulPairs:0,loadedMileRatio:0,averageEfficiency:0,averageResponseTime:0,totalMiles:0,loadedMiles:0,optimizationResults:[],backhaulOpportunities:[]}),[l]=g.exports.useState(!1),[h,N]=g.exports.useState(!1),[y,m]=g.exports.useState(!1),[p,x]=g.exports.useState(null),[f,c]=g.exports.useState(null),[b,u]=g.exports.useState([]),[S,k]=g.exports.useState(!1),[O,F]=g.exports.useState("month"),[U]=g.exports.useState({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[_,G]=g.exports.useState({totalTrips:0,completedTrips:0,averageResponseTime:0,averageTripTime:0,totalRevenue:0,efficiency:0}),[W,P]=g.exports.useState(!1),[D,w]=g.exports.useState(!1),M=sa.useRef(null),[C,Z]=g.exports.useState(""),[ee,R]=g.exports.useState(""),[q,$]=g.exports.useState(null);g.exports.useEffect(()=>{H()},[]),g.exports.useEffect(()=>{I(),d()},[a]),g.exports.useEffect(()=>{z()},[O,U]);const L=async()=>{if(M.current)return;const v=localStorage.getItem("token");if(!v){console.log("No token available for SSE connection");return}const T=`${{}.VITE_BACKEND_URL||"http://localhost:5001"}/api/optimize/stream?token=${encodeURIComponent(v)}`;console.log("Creating EventSource connection to:",T);const Y=new EventSource(T);M.current=Y,Y.addEventListener("connected",J=>{console.log("SSE connected event received:",J),P(!0)}),Y.addEventListener("metrics",J=>{try{console.log("SSE metrics event received:",J.data);const ne=JSON.parse(J.data),j=ne.summary||ne;G({totalTrips:j.totalTrips||0,completedTrips:j.completedTrips||0,averageResponseTime:j.averageResponseTime||0,averageTripTime:j.averageTripTime||0,totalRevenue:j.totalRevenue||0,efficiency:j.efficiency||0,customerSatisfaction:j.customerSatisfaction||4.2,lastUpdated:ne.timestamp||new Date().toISOString()})}catch(ne){console.error("Error parsing SSE metrics:",ne)}}),Y.addEventListener("error",J=>{console.error("SSE error event:",J),P(!1)}),Y.onopen=()=>{console.log("SSE connection opened successfully"),P(!0)},Y.onerror=J=>{console.error("SSE connection error:",J),console.error("EventSource readyState:",Y.readyState),P(!1)}},B=()=>{M.current&&(M.current.close(),M.current=null),P(!1)};g.exports.useEffect(()=>(localStorage.getItem("token")&&!D&&L().catch(console.error),()=>{B()}),[]),g.exports.useEffect(()=>{D?B():L().catch(console.error)},[D]);const H=()=>{try{const v=localStorage.getItem("revenue_settings");if(v){const T=JSON.parse(v);r(Y=>({...Y,...T}))}}catch(v){console.error("Error loading saved settings:",v)}},X=()=>{try{localStorage.setItem("revenue_settings",JSON.stringify(a)),N(!0),setTimeout(()=>N(!1),2e3)}catch(v){console.error("Error saving settings:",v)}},I=()=>{const v="ALS",T="MEDIUM",J="medicare",j=a.baseRates[v],ae=a.priorityMultipliers[T],De=a.perMileRates[v],de=a.insuranceRates[J],ge=j*ae,Le=ge+De*15,Me=Le*de,Wt=a.crewComposition[v];let Gt=0;Wt.forEach(Dr=>{const Mr=a.crewRoles[Dr];Gt+=Mr*2.5});const fa=(a.vehicleCostPerMile+a.fuelCostPerMile+a.maintenanceCostPerMile)*15,ya=Gt+fa,ba=Me-ya,Pr=Me>0?ba/Me*100:0;n({standardRate:Math.round(ge*100)/100,mileageRate:Math.round(Le*100)/100,insuranceRate:Math.round(Me*100)/100,crewCost:Math.round(Gt*100)/100,vehicleCost:Math.round(fa*100)/100,totalCost:Math.round(ya*100)/100,netProfit:Math.round(ba*100)/100,profitMargin:Math.round(Pr*100)/100})},d=async()=>{try{m(!0);const T=[{id:"req1",transportLevel:"ALS",priority:"MEDIUM",originLocation:{lat:40.75,lng:-73.98},destinationLocation:{lat:40.76,lng:-73.99},scheduledTime:new Date(Date.now()+30*60*1e3),tripCost:275},{id:"req2",transportLevel:"BLS",priority:"LOW",originLocation:{lat:40.74,lng:-73.97},destinationLocation:{lat:40.77,lng:-74},scheduledTime:new Date(Date.now()+60*60*1e3),tripCost:150}].reduce((Me,Wt)=>Me+(Wt.tripCost||0),0),Y=25.5,J=45,ne=.5,j=1,ae=a.routeOptimization.targetLoadedMileRatio,De=a.routeOptimization.targetEfficiency,de=a.routeOptimization.targetResponseTime,ge=Y/(1-ae),Le=ge-Y;o({totalRevenue:T,totalDeadheadMiles:Y,totalWaitTime:J,totalOvertimeRisk:ne,backhaulPairs:j,loadedMileRatio:ae,averageEfficiency:De,averageResponseTime:de,totalMiles:ge,loadedMiles:Le,optimizationResults:[],backhaulOpportunities:[]})}catch(v){console.error("Error calculating optimization preview:",v)}finally{m(!1)}},E=(v,T,Y)=>{r(J=>{const ne=J[v];return{...J,[v]:{...ne,[T]:Y}}})},z=async()=>{try{console.log("Loading cost analysis data..."),k(!0);const v=localStorage.getItem("token");console.log("Token available for data loading:",!!v);const T={"Content-Type":"application/json"};v&&(T.Authorization=`Bearer ${v}`);const Y=await fetch(`http://localhost:5001/api/tcc/analytics/cost-analysis?startDate=${U.start}&endDate=${U.end}`,{headers:T});if(console.log("Summary response status:",Y.status),Y.ok){const j=await Y.json();console.log("Summary data received:",j),x(j.data)}else{const j=await Y.json();console.error("Summary response error:",j)}const J=await fetch(`http://localhost:5001/api/tcc/analytics/profitability?period=${O}`,{headers:T});if(J.ok){const j=await J.json();c(j.data)}const ne=await fetch("http://localhost:5001/api/tcc/analytics/cost-breakdowns?limit=50",{headers:T});if(ne.ok){const j=await ne.json();u(j.data)}}catch(v){console.error("Error loading cost analysis data:",v)}finally{k(!1)}},Q=async()=>{try{console.log("Starting sample cost breakdown creation...");const v=localStorage.getItem("token");console.log("Token available:",!!v);const T={baseRevenue:250,mileageRevenue:56.25,priorityRevenue:27.5,specialRequirementsRevenue:0,insuranceAdjustment:-50.625,totalRevenue:283.125,crewLaborCost:87.5,vehicleCost:11.25,fuelCost:3.75,maintenanceCost:2.25,overheadCost:15,totalCost:119.75,grossProfit:163.375,profitMargin:57.7,revenuePerMile:18.88,costPerMile:7.98,loadedMileRatio:.8,deadheadMileRatio:.2,utilizationRate:.85,tripDistance:15,loadedMiles:12,deadheadMiles:3,tripDurationHours:2.5,transportLevel:"ALS",priorityLevel:"MEDIUM"};console.log("Creating sample cost breakdown...");const Y={"Content-Type":"application/json"};v&&(Y.Authorization=`Bearer ${v}`);const J=await fetch("http://localhost:5001/api/tcc/analytics/cost-breakdown",{method:"POST",headers:Y,body:JSON.stringify({tripId:`sample-trip-${Date.now()}`,breakdownData:T})});if(J.ok)console.log("Sample cost breakdown created successfully"),await z();else{const ne=await J.json();console.error("Error creating sample cost breakdown:",ne),alert(`Error creating sample data: ${ne.error||"Unknown error"}`)}}catch(v){console.error("Error creating sample cost breakdown:",v),alert(`Error creating sample data: ${v instanceof Error?v.message:"Unknown error"}`)}};return t("div",{className:"space-y-6",children:[t("div",{className:"flex items-center justify-between",children:[e("h2",{className:"text-2xl font-bold text-gray-900",children:"Revenue Calculation Settings"}),e("div",{className:"flex items-center space-x-2",children:t("button",{onClick:X,disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:[e(_r,{className:"h-4 w-4 mr-2"}),h?"Saved!":"Save Settings"]})})]}),e("p",{className:"text-sm text-gray-600",children:"Configure pricing rates and see real-time revenue projections."}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t("div",{className:"space-y-6",children:[t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Base Rates by Transport Level"}),e("div",{className:"space-y-4",children:Object.entries(a.baseRates).map(([v,T])=>t("div",{className:"flex items-center justify-between",children:[t("label",{className:"text-sm font-medium text-gray-700",children:[v," Base Rate ($):"]}),e("input",{type:"number",value:T,onChange:Y=>E("baseRates",v,parseFloat(Y.target.value)||0),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]},v))})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Per Mile Rates"}),e("div",{className:"space-y-4",children:Object.entries(a.perMileRates).map(([v,T])=>t("div",{className:"flex items-center justify-between",children:[t("label",{className:"text-sm font-medium text-gray-700",children:[v," Per Mile ($):"]}),e("input",{type:"number",step:"0.01",value:T,onChange:Y=>E("perMileRates",v,parseFloat(Y.target.value)||0),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]},v))})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Priority Multipliers"}),e("div",{className:"space-y-4",children:Object.entries(a.priorityMultipliers).map(([v,T])=>t("div",{className:"flex items-center justify-between",children:[t("label",{className:"text-sm font-medium text-gray-700",children:[v," Priority:"]}),e("input",{type:"number",step:"0.1",value:T,onChange:Y=>E("priorityMultipliers",v,parseFloat(Y.target.value)||1),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]},v))})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Fees"}),e("div",{className:"space-y-4",children:t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Special Requirements Surcharge ($):"}),e("input",{type:"number",value:a.specialRequirementsSurcharge,onChange:v=>r(T=>({...T,specialRequirementsSurcharge:parseFloat(v.target.value)||0})),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]})})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Insurance Rate Multipliers"}),e("div",{className:"space-y-4",children:Object.entries(a.insuranceRates).map(([v,T])=>t("div",{className:"flex items-center justify-between",children:[t("label",{className:"text-sm font-medium text-gray-700",children:[v.charAt(0).toUpperCase()+v.slice(1),":"]}),e("input",{type:"number",step:"0.01",min:"0",max:"2",value:T,onChange:Y=>E("insuranceRates",v,parseFloat(Y.target.value)||1),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]},v))})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(Qa,{className:"h-5 w-5 text-blue-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Crew Cost Management"})]}),t("div",{className:"space-y-4",children:[Object.entries(a.crewRoles).map(([v,T])=>t("div",{className:"flex items-center justify-between",children:[t("label",{className:"text-sm font-medium text-gray-700",children:[v," Hourly Rate ($):"]}),e("input",{type:"number",step:"0.01",value:T,onChange:Y=>E("crewRoles",v,parseFloat(Y.target.value)||0),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]},v)),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Overtime Multiplier:"}),e("input",{type:"number",step:"0.1",value:a.overtimeMultiplier,onChange:v=>r(T=>({...T,overtimeMultiplier:parseFloat(v.target.value)||1.5})),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Shift Length (hours):"}),e("input",{type:"number",step:"0.5",value:a.shiftLengthHours,onChange:v=>r(T=>({...T,shiftLengthHours:parseFloat(v.target.value)||12})),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Max Overtime (hours):"}),e("input",{type:"number",step:"0.5",value:a.maxOvertimeHours,onChange:v=>r(T=>({...T,maxOvertimeHours:parseFloat(v.target.value)||4})),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(ie,{className:"h-5 w-5 text-green-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Vehicle & Operational Costs"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Vehicle Cost per Mile ($):"}),e("input",{type:"number",step:"0.01",value:a.vehicleCostPerMile,onChange:v=>r(T=>({...T,vehicleCostPerMile:parseFloat(v.target.value)||0})),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Fuel Cost per Mile ($):"}),e("input",{type:"number",step:"0.01",value:a.fuelCostPerMile,onChange:v=>r(T=>({...T,fuelCostPerMile:parseFloat(v.target.value)||0})),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Maintenance Cost per Mile ($):"}),e("input",{type:"number",step:"0.01",value:a.maintenanceCostPerMile,onChange:v=>r(T=>({...T,maintenanceCostPerMile:parseFloat(v.target.value)||0})),className:"w-24 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(fe,{className:"h-5 w-5 text-purple-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Crew Composition by Transport Level"})]}),e("div",{className:"space-y-4",children:Object.entries(a.crewComposition).map(([v,T])=>t("div",{className:"space-y-2",children:[t("label",{className:"text-sm font-medium text-gray-700",children:[v," Crew:"]}),e("div",{className:"flex flex-wrap gap-2",children:T.map((Y,J)=>e("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:Y},J))}),t("p",{className:"text-xs text-gray-500",children:["Total crew cost: $",T.reduce((Y,J)=>Y+(a.crewRoles[J]||0),0).toFixed(2),"/hour"]})]},v))})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(fe,{className:"h-5 w-5 text-orange-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Time-based Pricing"})]}),t("div",{className:"space-y-6",children:[t("div",{children:[e("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Peak Hour Multipliers"}),e("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(a.timeBasedPricing.peakHourMultipliers).map(([v,T])=>t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:v}),e("input",{type:"number",step:"0.1",value:T,onChange:Y=>r(J=>({...J,timeBasedPricing:{...J.timeBasedPricing,peakHourMultipliers:{...J.timeBasedPricing.peakHourMultipliers,[v]:parseFloat(Y.target.value)||1}}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]},v))})]}),t("div",{children:[e("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Weekend Multipliers"}),e("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(a.timeBasedPricing.weekendMultipliers).map(([v,T])=>t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:v}),e("input",{type:"number",step:"0.1",value:T,onChange:Y=>r(J=>({...J,timeBasedPricing:{...J.timeBasedPricing,weekendMultipliers:{...J.timeBasedPricing.weekendMultipliers,[v]:parseFloat(Y.target.value)||1}}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]},v))})]}),t("div",{children:[e("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Seasonal Multipliers"}),e("div",{className:"grid grid-cols-4 gap-4",children:Object.entries(a.timeBasedPricing.seasonalMultipliers).map(([v,T])=>t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:v}),e("input",{type:"number",step:"0.1",value:T,onChange:Y=>r(J=>({...J,timeBasedPricing:{...J.timeBasedPricing,seasonalMultipliers:{...J.timeBasedPricing.seasonalMultipliers,[v]:parseFloat(Y.target.value)||1}}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]},v))})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(Re,{className:"h-5 w-5 text-green-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Geographic Pricing"})]}),t("div",{className:"space-y-6",children:[t("div",{children:[e("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Zone Multipliers"}),e("div",{className:"grid grid-cols-4 gap-4",children:Object.entries(a.geographicPricing.zoneMultipliers).map(([v,T])=>t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:v}),e("input",{type:"number",step:"0.1",value:T,onChange:Y=>r(J=>({...J,geographicPricing:{...J.geographicPricing,zoneMultipliers:{...J.geographicPricing.zoneMultipliers,[v]:parseFloat(Y.target.value)||1}}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-green-500"})]},v))})]}),t("div",{children:[e("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Distance Tiers"}),e("div",{className:"grid grid-cols-4 gap-4",children:Object.entries(a.geographicPricing.distanceTiers).map(([v,T])=>t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:v}),e("input",{type:"number",step:"0.05",value:T,onChange:Y=>r(J=>({...J,geographicPricing:{...J.geographicPricing,distanceTiers:{...J.geographicPricing.distanceTiers,[v]:parseFloat(Y.target.value)||1}}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-green-500"})]},v))})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(We,{className:"h-5 w-5 text-purple-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Service-specific Pricing"})]}),t("div",{className:"space-y-6",children:[t("div",{children:[e("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Special Requirements Surcharges"}),e("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(a.serviceSpecificPricing.specialRequirements).map(([v,T])=>t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:v}),e("input",{type:"number",step:"5",value:T,onChange:Y=>r(J=>({...J,serviceSpecificPricing:{...J.serviceSpecificPricing,specialRequirements:{...J.serviceSpecificPricing.specialRequirements,[v]:parseFloat(Y.target.value)||0}}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"})]},v))})]}),t("div",{children:[e("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Individual Service Pricing"}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:"Isolation Protocol"}),e("input",{type:"number",step:"5",value:a.serviceSpecificPricing.isolationPricing,onChange:v=>r(T=>({...T,serviceSpecificPricing:{...T.serviceSpecificPricing,isolationPricing:parseFloat(v.target.value)||0}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:"Bariatric Transport"}),e("input",{type:"number",step:"5",value:a.serviceSpecificPricing.bariatricPricing,onChange:v=>r(T=>({...T,serviceSpecificPricing:{...T.serviceSpecificPricing,bariatricPricing:parseFloat(v.target.value)||0}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:"Oxygen Therapy"}),e("input",{type:"number",step:"5",value:a.serviceSpecificPricing.oxygenPricing,onChange:v=>r(T=>({...T,serviceSpecificPricing:{...T.serviceSpecificPricing,oxygenPricing:parseFloat(v.target.value)||0}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-medium text-gray-600",children:"Continuous Monitoring"}),e("input",{type:"number",step:"5",value:a.serviceSpecificPricing.monitoringPricing,onChange:v=>r(T=>({...T,serviceSpecificPricing:{...T.serviceSpecificPricing,monitoringPricing:parseFloat(v.target.value)||0}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(qr,{className:"h-5 w-5 text-indigo-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Insurance-specific Rates"})]}),e("div",{className:"space-y-4",children:e("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(a.insuranceSpecificRates).map(([v,T])=>t("div",{className:"space-y-1",children:[t("label",{className:"text-sm font-medium text-gray-700",children:[v," Rate"]}),e("input",{type:"number",step:"0.05",value:T,onChange:Y=>r(J=>({...J,insuranceSpecificRates:{...J.insuranceSpecificRates,[v]:parseFloat(Y.target.value)||1}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"}),e("p",{className:"text-xs text-gray-500",children:T<1?`${((1-T)*100).toFixed(1)}% discount`:T>1?`${((T-1)*100).toFixed(1)}% surcharge`:"Standard rate"})]},v))})})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(va,{className:"h-5 w-5 text-blue-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Route Optimization Weights"})]}),e("div",{className:"space-y-6",children:t("div",{className:"grid grid-cols-2 gap-6",children:[t("div",{children:[e("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Primary Optimization Weights"}),t("div",{className:"space-y-4",children:[t("div",{className:"space-y-2",children:[t("label",{className:"text-sm font-medium text-gray-700",children:["Deadhead Miles Weight (\u03B1): ",a.routeOptimization.deadheadMileWeight]}),e("input",{type:"range",min:"0",max:"3",step:"0.1",value:a.routeOptimization.deadheadMileWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,deadheadMileWeight:parseFloat(v.target.value)}})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e("p",{className:"text-xs text-gray-500",children:"Penalty for empty return miles"})]}),t("div",{className:"space-y-2",children:[t("label",{className:"text-sm font-medium text-gray-700",children:["Wait Time Weight (\u03B2): ",a.routeOptimization.waitTimeWeight]}),e("input",{type:"range",min:"0",max:"3",step:"0.1",value:a.routeOptimization.waitTimeWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,waitTimeWeight:parseFloat(v.target.value)}})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e("p",{className:"text-xs text-gray-500",children:"Penalty for waiting time"})]}),t("div",{className:"space-y-2",children:[t("label",{className:"text-sm font-medium text-gray-700",children:["Backhaul Bonus Weight (\u03B3): ",a.routeOptimization.backhaulBonusWeight]}),e("input",{type:"range",min:"0",max:"3",step:"0.1",value:a.routeOptimization.backhaulBonusWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,backhaulBonusWeight:parseFloat(v.target.value)}})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e("p",{className:"text-xs text-gray-500",children:"Bonus for backhaul pairs"})]}),t("div",{className:"space-y-2",children:[t("label",{className:"text-sm font-medium text-gray-700",children:["Overtime Risk Weight (\u03B4): ",a.routeOptimization.overtimeRiskWeight]}),e("input",{type:"range",min:"0",max:"3",step:"0.1",value:a.routeOptimization.overtimeRiskWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,overtimeRiskWeight:parseFloat(v.target.value)}})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e("p",{className:"text-xs text-gray-500",children:"Penalty for overtime risk"})]})]})]}),t("div",{children:[e("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Secondary Weights"}),t("div",{className:"space-y-4",children:[t("div",{className:"space-y-2",children:[t("label",{className:"text-sm font-medium text-gray-700",children:["Revenue Weight: ",a.routeOptimization.revenueWeight]}),e("input",{type:"range",min:"0",max:"3",step:"0.1",value:a.routeOptimization.revenueWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,revenueWeight:parseFloat(v.target.value)}})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),t("div",{className:"space-y-2",children:[t("label",{className:"text-sm font-medium text-gray-700",children:["Crew Availability Weight: ",a.routeOptimization.crewAvailabilityWeight]}),e("input",{type:"range",min:"0",max:"3",step:"0.1",value:a.routeOptimization.crewAvailabilityWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,crewAvailabilityWeight:parseFloat(v.target.value)}})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),t("div",{className:"space-y-2",children:[t("label",{className:"text-sm font-medium text-gray-700",children:["Equipment Compatibility Weight: ",a.routeOptimization.equipmentCompatibilityWeight]}),e("input",{type:"range",min:"0",max:"3",step:"0.1",value:a.routeOptimization.equipmentCompatibilityWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,equipmentCompatibilityWeight:parseFloat(v.target.value)}})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),t("div",{className:"space-y-2",children:[t("label",{className:"text-sm font-medium text-gray-700",children:["Patient Priority Weight: ",a.routeOptimization.patientPriorityWeight]}),e("input",{type:"range",min:"0",max:"3",step:"0.1",value:a.routeOptimization.patientPriorityWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,patientPriorityWeight:parseFloat(v.target.value)}})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]})]})]})]})})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(la,{className:"h-5 w-5 text-red-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Constraint Settings"})]}),t("div",{className:"grid grid-cols-2 gap-6",children:[t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Max Deadhead Miles:"}),e("input",{type:"number",step:"5",value:a.routeOptimization.maxDeadheadMiles,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,maxDeadheadMiles:parseFloat(v.target.value)||50}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-red-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Max Wait Time (min):"}),e("input",{type:"number",step:"5",value:a.routeOptimization.maxWaitTimeMinutes,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,maxWaitTimeMinutes:parseInt(v.target.value)||30}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-red-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Max Overtime (hrs):"}),e("input",{type:"number",step:"0.5",value:a.routeOptimization.maxOvertimeHours,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,maxOvertimeHours:parseFloat(v.target.value)||4}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-red-500"})]})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Max Response Time (min):"}),e("input",{type:"number",step:"1",value:a.routeOptimization.maxResponseTimeMinutes,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,maxResponseTimeMinutes:parseInt(v.target.value)||15}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-red-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Max Service Distance (mi):"}),e("input",{type:"number",step:"10",value:a.routeOptimization.maxServiceDistance,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,maxServiceDistance:parseFloat(v.target.value)||100}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-red-500"})]})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(Hr,{className:"h-5 w-5 text-yellow-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Backhaul Optimization"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Enable Backhaul Optimization:"}),e("input",{type:"checkbox",checked:a.routeOptimization.enableBackhaulOptimization,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,enableBackhaulOptimization:v.target.checked}})),className:"h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-gray-300 rounded"})]}),t("div",{className:"grid grid-cols-3 gap-4",children:[t("div",{className:"space-y-2",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Time Window (min):"}),e("input",{type:"number",step:"5",value:a.routeOptimization.backhaulTimeWindow,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,backhaulTimeWindow:parseInt(v.target.value)||60}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-yellow-500"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Distance Limit (mi):"}),e("input",{type:"number",step:"5",value:a.routeOptimization.backhaulDistanceLimit,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,backhaulDistanceLimit:parseFloat(v.target.value)||25}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-yellow-500"})]}),t("div",{className:"space-y-2",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Revenue Bonus ($):"}),e("input",{type:"number",step:"5",value:a.routeOptimization.backhaulRevenueBonus,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,backhaulRevenueBonus:parseFloat(v.target.value)||50}})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-yellow-500"})]})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(me,{className:"h-5 w-5 text-green-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Performance Targets"})]}),t("div",{className:"grid grid-cols-2 gap-6",children:[t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Target Loaded Mile Ratio:"}),e("input",{type:"number",step:"0.05",min:"0",max:"1",value:a.routeOptimization.targetLoadedMileRatio,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,targetLoadedMileRatio:parseFloat(v.target.value)||.75}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-green-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Target Revenue/Hour ($):"}),e("input",{type:"number",step:"10",value:a.routeOptimization.targetRevenuePerHour,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,targetRevenuePerHour:parseFloat(v.target.value)||200}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Target Response Time (min):"}),e("input",{type:"number",step:"1",value:a.routeOptimization.targetResponseTime,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,targetResponseTime:parseInt(v.target.value)||12}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-green-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Target Efficiency:"}),e("input",{type:"number",step:"0.05",min:"0",max:"1",value:a.routeOptimization.targetEfficiency,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,targetEfficiency:parseFloat(v.target.value)||.85}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-green-500"})]})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(We,{className:"h-5 w-5 text-purple-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Algorithm Settings"})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Optimization Algorithm:"}),t("select",{value:a.routeOptimization.optimizationAlgorithm,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,optimizationAlgorithm:v.target.value}})),className:"px-3 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e("option",{value:"HYBRID",children:"Hybrid"}),e("option",{value:"GREEDY",children:"Greedy"}),e("option",{value:"GENETIC",children:"Genetic"}),e("option",{value:"SIMULATED_ANNEALING",children:"Simulated Annealing"})]})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Max Optimization Time (sec):"}),e("input",{type:"number",step:"5",value:a.routeOptimization.maxOptimizationTime,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,maxOptimizationTime:parseInt(v.target.value)||30}})),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),t("div",{className:"flex items-center justify-between",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Enable Real-time Optimization:"}),e("input",{type:"checkbox",checked:a.routeOptimization.enableRealTimeOptimization,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,enableRealTimeOptimization:v.target.checked}})),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"})]})]})]})]}),t("div",{className:"space-y-6",children:[t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e("span",{className:"h-2 w-2 rounded-full mr-2",style:{backgroundColor:W?"#16a34a":"#9ca3af"}}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Real-time Optimization"}),e("span",{className:"ml-2 text-xs text-gray-500",children:W?"Live":"Disconnected"}),e("button",{onClick:()=>w(v=>!v),className:"ml-auto px-3 py-1 text-xs rounded border border-gray-300 hover:bg-gray-50",children:D?"Resume":"Pause"})]}),t("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[t("div",{className:"p-3 bg-gray-50 rounded",children:[e("div",{className:"text-xs text-gray-500",children:"Total Trips (5m)"}),e("div",{className:"text-lg font-semibold",children:_.totalTrips})]}),t("div",{className:"p-3 bg-gray-50 rounded",children:[e("div",{className:"text-xs text-gray-500",children:"Completed Trips"}),e("div",{className:"text-lg font-semibold",children:_.completedTrips})]}),t("div",{className:"p-3 bg-gray-50 rounded",children:[e("div",{className:"text-xs text-gray-500",children:"Avg Response (min)"}),e("div",{className:"text-lg font-semibold",children:_.averageResponseTime.toFixed(1)})]}),t("div",{className:"p-3 bg-gray-50 rounded",children:[e("div",{className:"text-xs text-gray-500",children:"Avg Trip Time (min)"}),e("div",{className:"text-lg font-semibold",children:_.averageTripTime.toFixed(1)})]}),t("div",{className:"p-3 bg-gray-50 rounded",children:[e("div",{className:"text-xs text-gray-500",children:"Revenue (est)"}),t("div",{className:"text-lg font-semibold",children:["$",_.totalRevenue.toFixed(2)]})]}),t("div",{className:"p-3 bg-gray-50 rounded",children:[e("div",{className:"text-xs text-gray-500",children:"Efficiency"}),t("div",{className:"text-lg font-semibold",children:[(_.efficiency*100).toFixed(0),"%"]})]})]}),_.lastUpdated&&t("div",{className:"mt-2 text-xs text-gray-500",children:["Updated ",new Date(_.lastUpdated).toLocaleTimeString()]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(Wr,{className:"h-5 w-5 text-blue-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Revenue Preview"})]}),e("div",{className:"mb-4 p-3 bg-gray-50 rounded-md",children:t("p",{className:"text-sm text-gray-600",children:[e("strong",{children:"Sample trip:"})," ALS transport, MEDIUM priority, 15 miles, medicare insurance"]})}),t("div",{className:"space-y-4",children:[t("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e("h4",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Revenue Breakdown"}),t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Standard Rate:"}),t("span",{className:"text-sm font-semibold text-gray-900",children:["$",s.standardRate]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Mileage Rate:"}),t("span",{className:"text-sm font-semibold text-gray-900",children:["$",s.mileageRate]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Insurance Rate:"}),t("span",{className:"text-lg font-semibold text-blue-600",children:["$",s.insuranceRate]})]})]})]}),t("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e("h4",{className:"text-sm font-semibold text-red-900 mb-3",children:"Cost Breakdown"}),t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Crew Cost:"}),t("span",{className:"text-sm font-semibold text-gray-900",children:["$",s.crewCost]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Vehicle Cost:"}),t("span",{className:"text-sm font-semibold text-gray-900",children:["$",s.vehicleCost]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Total Cost:"}),t("span",{className:"text-lg font-semibold text-red-600",children:["$",s.totalCost]})]})]})]}),t("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e("h4",{className:"text-sm font-semibold text-green-900 mb-3",children:"Profitability Summary"}),t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Net Profit:"}),t("span",{className:`text-lg font-semibold ${s.netProfit>=0?"text-green-600":"text-red-600"}`,children:["$",s.netProfit]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Profit Margin:"}),t("span",{className:`text-lg font-semibold ${s.profitMargin>=0?"text-green-600":"text-red-600"}`,children:[s.profitMargin,"%"]})]})]})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"What-if Scenario"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm text-gray-600 mb-1",children:"Deadhead Mile Weight"}),e("input",{type:"number",step:"0.1",value:a.routeOptimization.deadheadMileWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,deadheadMileWeight:parseFloat(v.target.value)||0}})),className:"w-full px-3 py-2 border rounded"})]}),t("div",{children:[e("label",{className:"block text-sm text-gray-600 mb-1",children:"Wait Time Weight"}),e("input",{type:"number",step:"0.1",value:a.routeOptimization.waitTimeWeight,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,waitTimeWeight:parseFloat(v.target.value)||0}})),className:"w-full px-3 py-2 border rounded"})]}),t("div",{children:[e("label",{className:"block text-sm text-gray-600 mb-1",children:"Backhaul Bonus"}),e("input",{type:"number",step:"5",value:a.routeOptimization.backhaulRevenueBonus,onChange:v=>r(T=>({...T,routeOptimization:{...T.routeOptimization,backhaulRevenueBonus:parseFloat(v.target.value)||0}})),className:"w-full px-3 py-2 border rounded"})]}),t("div",{className:"md:col-span-3 grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm text-gray-600 mb-1",children:"Unit IDs (comma-separated, optional)"}),e("input",{type:"text",value:C,onChange:v=>Z(v.target.value),className:"w-full px-3 py-2 border rounded",placeholder:"leave blank to auto-select"})]}),t("div",{children:[e("label",{className:"block text-sm text-gray-600 mb-1",children:"Request IDs (comma-separated, optional)"}),e("input",{type:"text",value:ee,onChange:v=>R(v.target.value),className:"w-full px-3 py-2 border rounded",placeholder:"leave blank to auto-select"})]})]})]}),t("div",{className:"mt-4 flex items-center gap-3",children:[e("button",{onClick:async()=>{try{m(!0);const v=localStorage.getItem("token"),T={}.VITE_BACKEND_URL||"http://localhost:5001",Y=v?{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}:{"Content-Type":"application/json"};let J=C.split(",").map(ge=>ge.trim()).filter(Boolean);if(J.length===0)try{const Le=await(await fetch(`${T}/api/units`,{headers:Y})).json();J=((Le==null?void 0:Le.data)||[]).slice(0,3).map(Me=>Me.id)}catch{}let ne=ee.split(",").map(ge=>ge.trim()).filter(Boolean);if(ne.length===0)try{const Le=await(await fetch(`${T}/api/trips?status=PENDING`,{headers:Y})).json();ne=((Le==null?void 0:Le.data)||[]).slice(0,5).map(Me=>Me.id)}catch{}const j={...a.routeOptimization},ae={...a.routeOptimization},de=await(await fetch(`${T}/api/optimize/what-if`,{method:"POST",headers:Y,body:JSON.stringify({unitIds:J,requestIds:ne,scenarioSettings:j,baseSettings:ae})})).json();$((de==null?void 0:de.data)||null)}finally{m(!1)}},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",disabled:y,children:y?"Running...":"Run What-if"}),q?t("div",{className:"text-sm text-gray-600",children:["\u0394 Revenue: $",(((K=q==null?void 0:q.differences)==null?void 0:K.revenueDifference)||0).toFixed(2)," \xB7 \u0394 Deadhead: ",(((ce=q==null?void 0:q.differences)==null?void 0:ce.deadheadMilesDifference)||0).toFixed(1)," mi \xB7 \u0394 Efficiency: ",((((ke=q==null?void 0:q.differences)==null?void 0:ke.efficiencyDifference)||0)*100).toFixed(0),"%"]}):e("div",{className:"text-sm text-gray-600",children:"Ready to simulate changes using current weights and constraints."})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(va,{className:"h-5 w-5 text-blue-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Optimization Preview"})]}),e("div",{className:"mb-4 p-3 bg-gray-50 rounded-md",children:t("p",{className:"text-sm text-gray-600",children:[e("strong",{children:"Sample scenario:"})," 2 units, 2 requests with current optimization settings"]})}),y?t("div",{className:"flex items-center justify-center py-8",children:[e(xe,{className:"h-6 w-6 animate-spin text-blue-600"}),e("span",{className:"ml-2 text-sm text-gray-600",children:"Calculating optimization..."})]}):t("div",{className:"space-y-4",children:[t("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e("h4",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Optimization Metrics"}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Total Revenue:"}),t("span",{className:"text-sm font-semibold text-gray-900",children:["$",i.totalRevenue.toFixed(2)]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Loaded Mile Ratio:"}),t("span",{className:"text-sm font-semibold text-gray-900",children:[(i.loadedMileRatio*100).toFixed(1),"%"]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Backhaul Pairs:"}),e("span",{className:"text-sm font-semibold text-gray-900",children:i.backhaulPairs})]})]}),t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Total Miles:"}),t("span",{className:"text-sm font-semibold text-gray-900",children:[i.totalMiles.toFixed(1)," mi"]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Deadhead Miles:"}),t("span",{className:"text-sm font-semibold text-gray-900",children:[i.totalDeadheadMiles.toFixed(1)," mi"]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Avg Response Time:"}),t("span",{className:"text-sm font-semibold text-gray-900",children:[i.averageResponseTime.toFixed(1)," min"]})]})]})]})]}),t("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e("h4",{className:"text-sm font-semibold text-green-900 mb-3",children:"Performance vs Targets"}),t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Loaded Mile Ratio:"}),t("div",{className:"flex items-center space-x-2",children:[t("span",{className:"text-sm font-semibold text-gray-900",children:[(i.loadedMileRatio*100).toFixed(1),"%"]}),t("span",{className:"text-xs text-gray-500",children:["/ ",(a.routeOptimization.targetLoadedMileRatio*100).toFixed(1),"%"]}),e("span",{className:`text-xs ${i.loadedMileRatio>=a.routeOptimization.targetLoadedMileRatio?"text-green-600":"text-red-600"}`,children:i.loadedMileRatio>=a.routeOptimization.targetLoadedMileRatio?"\u2713":"\u2717"})]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Revenue/Hour:"}),t("div",{className:"flex items-center space-x-2",children:[t("span",{className:"text-sm font-semibold text-gray-900",children:["$",(i.totalRevenue/2).toFixed(2)]}),t("span",{className:"text-xs text-gray-500",children:["/ $",a.routeOptimization.targetRevenuePerHour]}),e("span",{className:`text-xs ${i.totalRevenue/2>=a.routeOptimization.targetRevenuePerHour?"text-green-600":"text-red-600"}`,children:i.totalRevenue/2>=a.routeOptimization.targetRevenuePerHour?"\u2713":"\u2717"})]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Response Time:"}),t("div",{className:"flex items-center space-x-2",children:[t("span",{className:"text-sm font-semibold text-gray-900",children:[i.averageResponseTime.toFixed(1)," min"]}),t("span",{className:"text-xs text-gray-500",children:["/ ",a.routeOptimization.targetResponseTime," min"]}),e("span",{className:`text-xs ${i.averageResponseTime<=a.routeOptimization.targetResponseTime?"text-green-600":"text-red-600"}`,children:i.averageResponseTime<=a.routeOptimization.targetResponseTime?"\u2713":"\u2717"})]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Efficiency:"}),t("div",{className:"flex items-center space-x-2",children:[t("span",{className:"text-sm font-semibold text-gray-900",children:[(i.averageEfficiency*100).toFixed(1),"%"]}),t("span",{className:"text-xs text-gray-500",children:["/ ",(a.routeOptimization.targetEfficiency*100).toFixed(1),"%"]}),e("span",{className:`text-xs ${i.averageEfficiency>=a.routeOptimization.targetEfficiency?"text-green-600":"text-red-600"}`,children:i.averageEfficiency>=a.routeOptimization.targetEfficiency?"\u2713":"\u2717"})]})]})]})]}),t("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Current Optimization Weights"}),t("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"Deadhead (\u03B1):"}),e("span",{className:"font-medium",children:a.routeOptimization.deadheadMileWeight})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"Wait Time (\u03B2):"}),e("span",{className:"font-medium",children:a.routeOptimization.waitTimeWeight})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"Backhaul (\u03B3):"}),e("span",{className:"font-medium",children:a.routeOptimization.backhaulBonusWeight})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"Overtime (\u03B4):"}),e("span",{className:"font-medium",children:a.routeOptimization.overtimeRiskWeight})]})]})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),t("div",{className:"space-y-3",children:[e("button",{onClick:()=>{r({baseRates:{BLS:150,ALS:250,CCT:400},perMileRates:{BLS:2.5,ALS:3.75,CCT:5},priorityMultipliers:{LOW:1,MEDIUM:1.1,HIGH:1.25,URGENT:1.5},specialRequirementsSurcharge:50,insuranceRates:{medicare:.85,medicaid:.8,private:1},crewRoles:{EMT:25,Paramedic:35,RN:45,CCTSpecialist:40,CriticalCareParamedic:42},overtimeMultiplier:1.5,shiftLengthHours:12,maxOvertimeHours:4,vehicleCostPerMile:.75,fuelCostPerMile:.25,maintenanceCostPerMile:.15,crewComposition:{BLS:["EMT","EMT"],ALS:["EMT","Paramedic"],CCT:["RN","CriticalCareParamedic"]},timeBasedPricing:{peakHourMultipliers:{"6-9AM":1.3,"5-8PM":1.4,Other:1},weekendMultipliers:{Saturday:1.2,Sunday:1.3,Weekday:1},seasonalMultipliers:{Winter:1.1,Spring:1,Summer:1,Fall:1}},geographicPricing:{zoneMultipliers:{Urban:1,Suburban:1.1,Rural:1.3,Remote:1.5},distanceTiers:{"0-10mi":1,"10-25mi":.95,"25-50mi":.9,"50+mi":.85}},serviceSpecificPricing:{specialRequirements:{Oxygen:25,Monitoring:50,Isolation:75,Bariatric:100},isolationPricing:75,bariatricPricing:100,oxygenPricing:25,monitoringPricing:50},insuranceSpecificRates:{Medicare:.85,Medicaid:.8,Private:1,SelfPay:1.2},routeOptimization:{deadheadMileWeight:1,waitTimeWeight:1,backhaulBonusWeight:1,overtimeRiskWeight:1,revenueWeight:1,crewAvailabilityWeight:1,equipmentCompatibilityWeight:1,patientPriorityWeight:1,maxDeadheadMiles:50,maxWaitTimeMinutes:30,maxOvertimeHours:4,maxResponseTimeMinutes:15,maxServiceDistance:100,backhaulTimeWindow:60,backhaulDistanceLimit:25,backhaulRevenueBonus:50,enableBackhaulOptimization:!0,targetLoadedMileRatio:.75,targetRevenuePerHour:200,targetResponseTime:12,targetEfficiency:.85,optimizationAlgorithm:"HYBRID",maxOptimizationTime:30,enableRealTimeOptimization:!0}})},className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:"Reset to Defaults"}),t("button",{onClick:H,className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[e(xe,{className:"h-4 w-4 inline mr-2"}),"Reload Saved Settings"]})]})]})]})]}),t("div",{className:"mt-8",children:[t("div",{className:"flex items-center justify-between mb-6",children:[e("h2",{className:"text-2xl font-bold text-gray-900",children:"Cost Analysis & Profitability Dashboard"}),t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex items-center space-x-2",children:[e("label",{className:"text-sm font-medium text-gray-700",children:"Period:"}),t("select",{value:O,onChange:v=>F(v.target.value),className:"px-3 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e("option",{value:"week",children:"Week"}),e("option",{value:"month",children:"Month"}),e("option",{value:"quarter",children:"Quarter"}),e("option",{value:"year",children:"Year"})]})]}),t("button",{onClick:Q,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[e(Se,{className:"h-4 w-4 mr-2"}),"Add Sample Data"]}),t("button",{onClick:z,disabled:S,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[e(xe,{className:`h-4 w-4 mr-2 ${S?"animate-spin":""}`}),"Refresh"]})]})]}),S?t("div",{className:"flex items-center justify-center py-12",children:[e(xe,{className:"h-8 w-8 animate-spin text-blue-600"}),e("span",{className:"ml-3 text-lg text-gray-600",children:"Loading cost analysis data..."})]}):t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"lg:col-span-2 space-y-6",children:[t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(pe,{className:"h-5 w-5 text-green-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Key Financial Metrics"})]}),p?t("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e("div",{className:"text-sm font-medium text-green-800",children:"Total Revenue"}),t("div",{className:"text-2xl font-bold text-green-900",children:["$",p.totalRevenue.toFixed(2)]})]}),t("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e("div",{className:"text-sm font-medium text-red-800",children:"Total Cost"}),t("div",{className:"text-2xl font-bold text-red-900",children:["$",p.totalCost.toFixed(2)]})]}),t("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e("div",{className:"text-sm font-medium text-blue-800",children:"Gross Profit"}),t("div",{className:"text-2xl font-bold text-blue-900",children:["$",p.grossProfit.toFixed(2)]})]}),t("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e("div",{className:"text-sm font-medium text-purple-800",children:"Profit Margin"}),t("div",{className:"text-2xl font-bold text-purple-900",children:[p.averageProfitMargin.toFixed(1),"%"]})]})]}):e("div",{className:"text-center py-8 text-gray-500",children:'No cost analysis data available. Click "Add Sample Data" to get started.'})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(Se,{className:"h-5 w-5 text-blue-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Efficiency Metrics"})]}),p?t("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[t("div",{className:"text-center",children:[e("div",{className:"text-sm font-medium text-gray-600",children:"Loaded Mile Ratio"}),t("div",{className:"text-xl font-bold text-gray-900",children:[(p.averageLoadedMileRatio*100).toFixed(1),"%"]})]}),t("div",{className:"text-center",children:[e("div",{className:"text-sm font-medium text-gray-600",children:"Revenue per Mile"}),t("div",{className:"text-xl font-bold text-gray-900",children:["$",p.averageRevenuePerMile.toFixed(2)]})]}),t("div",{className:"text-center",children:[e("div",{className:"text-sm font-medium text-gray-600",children:"Cost per Mile"}),t("div",{className:"text-xl font-bold text-gray-900",children:["$",p.averageCostPerMile.toFixed(2)]})]})]}):e("div",{className:"text-center py-8 text-gray-500",children:"No efficiency data available."})]}),f&&t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(Ne,{className:"h-5 w-5 text-green-600 mr-2"}),t("h3",{className:"text-lg font-semibold text-gray-900",children:["Profitability Trends (",f.period,")"]})]}),t("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t("div",{className:"text-center",children:[e("div",{className:"text-sm font-medium text-gray-600",children:"Revenue Growth"}),t("div",{className:`text-xl font-bold ${f.revenueGrowth>=0?"text-green-600":"text-red-600"}`,children:[f.revenueGrowth>=0?"+":"",f.revenueGrowth.toFixed(1),"%"]})]}),t("div",{className:"text-center",children:[e("div",{className:"text-sm font-medium text-gray-600",children:"Cost Growth"}),t("div",{className:`text-xl font-bold ${f.costGrowth>=0?"text-red-600":"text-green-600"}`,children:[f.costGrowth>=0?"+":"",f.costGrowth.toFixed(1),"%"]})]}),t("div",{className:"text-center",children:[e("div",{className:"text-sm font-medium text-gray-600",children:"Profit Growth"}),t("div",{className:`text-xl font-bold ${f.profitGrowth>=0?"text-green-600":"text-red-600"}`,children:[f.profitGrowth>=0?"+":"",f.profitGrowth.toFixed(1),"%"]})]}),t("div",{className:"text-center",children:[e("div",{className:"text-sm font-medium text-gray-600",children:"Revenue/Hour"}),t("div",{className:"text-xl font-bold text-gray-900",children:["$",f.efficiencyMetrics.revenuePerHour.toFixed(2)]})]})]})]})]}),e("div",{className:"space-y-6",children:t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center mb-4",children:[e(Et,{className:"h-5 w-5 text-purple-600 mr-2"}),e("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Trip Breakdowns"})]}),b.length>0?e("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:b.slice(0,10).map(v=>t("div",{className:"border border-gray-200 rounded-lg p-3",children:[t("div",{className:"flex justify-between items-start mb-2",children:[t("div",{children:[t("div",{className:"font-medium text-sm text-gray-900",children:[v.transportLevel," - ",v.priorityLevel]}),t("div",{className:"text-xs text-gray-500",children:[v.tripDistance," miles"]})]}),t("div",{className:"text-right",children:[t("div",{className:`text-sm font-semibold ${v.grossProfit>=0?"text-green-600":"text-red-600"}`,children:["$",v.grossProfit.toFixed(2)]}),t("div",{className:"text-xs text-gray-500",children:[v.profitMargin.toFixed(1),"% margin"]})]})]}),t("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"Revenue:"}),t("span",{className:"font-medium",children:["$",v.totalRevenue.toFixed(2)]})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"Cost:"}),t("span",{className:"font-medium",children:["$",v.totalCost.toFixed(2)]})]})]})]},v.id))}):e("div",{className:"text-center py-8 text-gray-500",children:"No trip breakdowns available."})]})})]})]})]})},Vi=({user:a})=>{var S,k,O;const[r,s]=g.exports.useState("overview"),[n,i]=g.exports.useState(!0),[o,l]=g.exports.useState(null),[h,N]=g.exports.useState(null),[y,m]=g.exports.useState(null),[p,x]=g.exports.useState(null),[f,c]=g.exports.useState(null),b=[{id:"overview",name:"Overview",icon:me},{id:"performance",name:"Performance",icon:Ne},{id:"units",name:"Unit Management",icon:Se},{id:"revenue-settings",name:"Revenue Settings",icon:We}],u=async()=>{var F,U,_,G;i(!0),l(null);try{const[W,P,D,w]=await Promise.all([it.getOverview(),it.getTrips(),it.getUnits(),it.getPerformance()]);N(((F=W.data)==null?void 0:F.data)||null),m(((U=P.data)==null?void 0:U.data)||null),x(((_=D.data)==null?void 0:_.data)||null),c(((G=w.data)==null?void 0:G.data)||null)}catch(W){l("Failed to load analytics data"),console.error("Analytics loading error:",W)}finally{i(!1)}};return g.exports.useEffect(()=>{u()},[]),t("div",{children:[t("div",{className:"mb-8",children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"Analytics"}),t("p",{className:"mt-1 text-sm text-gray-500",children:["View performance metrics and analytics for ",a.agencyName||"your agency","."]})]}),e("div",{className:"border-b border-gray-200 mb-6",children:e("nav",{className:"-mb-px flex space-x-8",children:b.map(F=>{const U=F.icon;return t("button",{onClick:()=>s(F.id),className:`${r===F.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2`,children:[e(U,{className:"h-4 w-4"}),e("span",{children:F.name})]},F.id)})})}),r==="overview"&&t("div",{className:"space-y-6",children:[n&&t("div",{className:"text-center py-8",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),e("p",{className:"mt-4 text-sm text-gray-500",children:"Loading analytics data..."})]}),o&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e("div",{className:"flex",children:t("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e("div",{className:"mt-2 text-sm text-red-700",children:e("p",{children:o})})]})})}),!n&&!o&&t(se,{children:[e("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("h2",{className:"text-xl font-semibold text-gray-900",children:(h==null?void 0:h.agencyName)||a.agencyName||"Your Agency"}),e("p",{className:"text-sm text-gray-500",children:"Agency Performance Dashboard"})]}),t("div",{className:"text-right",children:[e("div",{className:"text-sm text-gray-500",children:"Last Updated"}),e("div",{className:"text-sm font-medium text-gray-900",children:new Date().toLocaleTimeString()})]})]})}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(me,{className:"h-6 w-6 text-blue-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Trips"}),e("dd",{className:"text-lg font-medium text-gray-900",children:(h==null?void 0:h.totalTrips)||0})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(Se,{className:"h-6 w-6 text-green-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Completed"}),e("dd",{className:"text-lg font-medium text-gray-900",children:(h==null?void 0:h.completedTrips)||0})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(Ne,{className:"h-6 w-6 text-purple-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Efficiency"}),e("dd",{className:"text-lg font-medium text-gray-900",children:h!=null&&h.efficiency?`${(h.efficiency*100).toFixed(1)}%`:"0%"})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(pe,{className:"h-6 w-6 text-orange-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Response"}),e("dd",{className:"text-lg font-medium text-gray-900",children:h!=null&&h.averageResponseTime?`${h.averageResponseTime.toFixed(1)} min`:"0 min"})]})})]})})})]}),y&&t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Trip Status Breakdown"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500",children:"Completed"}),e("span",{className:"text-sm font-medium text-gray-900",children:y.completedTrips||0})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500",children:"Pending"}),e("span",{className:"text-sm font-medium text-gray-900",children:y.pendingTrips||0})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500",children:"Cancelled"}),e("span",{className:"text-sm font-medium text-gray-900",children:y.cancelledTrips||0})]})]})]}),t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Transport Level Distribution"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500",children:"BLS"}),e("span",{className:"text-sm font-medium text-gray-900",children:((S=y.tripsByLevel)==null?void 0:S.BLS)||0})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500",children:"ALS"}),e("span",{className:"text-sm font-medium text-gray-900",children:((k=y.tripsByLevel)==null?void 0:k.ALS)||0})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500",children:"CCT"}),e("span",{className:"text-sm font-medium text-gray-900",children:((O=y.tripsByLevel)==null?void 0:O.CCT)||0})]})]})]})]}),h&&h.totalTrips===0&&e("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-6",children:t("div",{className:"text-center",children:[e(me,{className:"mx-auto h-12 w-12 text-blue-400"}),e("h3",{className:"mt-2 text-sm font-medium text-blue-900",children:"No Trips Yet"}),e("p",{className:"mt-1 text-sm text-blue-700",children:"Your agency hasn't been assigned any trips yet. Once trips are assigned, you'll see detailed analytics and performance metrics here."})]})})]})]}),r==="performance"&&t("div",{className:"space-y-6",children:[n&&t("div",{className:"text-center py-8",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),e("p",{className:"mt-4 text-sm text-gray-500",children:"Loading performance data..."})]}),o&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e("div",{className:"flex",children:t("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e("div",{className:"mt-2 text-sm text-red-700",children:e("p",{children:o})})]})})}),!n&&!o&&f&&t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Performance Metrics"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(Ne,{className:"h-6 w-6 text-blue-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Response Time"}),e("dd",{className:"text-lg font-medium text-gray-900",children:f.averageResponseTime?`${f.averageResponseTime.toFixed(1)} min`:"0 min"})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(Se,{className:"h-6 w-6 text-green-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Trip Time"}),e("dd",{className:"text-lg font-medium text-gray-900",children:f.averageTripTime?`${f.averageTripTime.toFixed(1)} min`:"0 min"})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(me,{className:"h-6 w-6 text-purple-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Completion Rate"}),e("dd",{className:"text-lg font-medium text-gray-900",children:`${(f.completionRate*100).toFixed(1)}%`})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(pe,{className:"h-6 w-6 text-orange-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Revenue"}),t("dd",{className:"text-lg font-medium text-gray-900",children:["$",f.totalRevenue?f.totalRevenue.toFixed(2):"0.00"]})]})})]})})})]})]}),!n&&!o&&!f&&t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Performance Metrics"}),t("div",{className:"text-center py-8",children:[e(Ne,{className:"mx-auto h-12 w-12 text-gray-400"}),e("h4",{className:"mt-2 text-sm font-medium text-gray-900",children:"No Performance Data"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Performance metrics will be displayed here when data is available."})]})]})]}),r==="units"&&t("div",{className:"space-y-6",children:[n&&t("div",{className:"text-center py-8",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),e("p",{className:"mt-4 text-sm text-gray-500",children:"Loading unit data..."})]}),o&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e("div",{className:"flex",children:t("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e("div",{className:"mt-2 text-sm text-red-700",children:e("p",{children:o})})]})})}),!n&&!o&&p&&t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Unit Management Analytics"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(Se,{className:"h-6 w-6 text-blue-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Units"}),e("dd",{className:"text-lg font-medium text-gray-900",children:p.totalUnits})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(Ne,{className:"h-6 w-6 text-green-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Units"}),e("dd",{className:"text-lg font-medium text-gray-900",children:p.activeUnits})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(me,{className:"h-6 w-6 text-purple-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Available Units"}),e("dd",{className:"text-lg font-medium text-gray-900",children:p.availableUnits})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(pe,{className:"h-6 w-6 text-orange-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Utilization"}),e("dd",{className:"text-lg font-medium text-gray-900",children:`${(p.averageUtilization*100).toFixed(1)}%`})]})})]})})})]}),p.topPerformingUnits&&p.topPerformingUnits.length>0&&t("div",{className:"mt-6",children:[e("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Top Performing Units"}),e("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:t("table",{className:"min-w-full divide-y divide-gray-300",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Number"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trips Completed"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Response Time"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:p.topPerformingUnits.map(F=>t("tr",{children:[e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:F.unitNumber}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F.totalTripsCompleted}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F.averageResponseTime?`${F.averageResponseTime.toFixed(1)} min`:"N/A"})]},F.id))})]})})]})]}),!n&&!o&&!p&&t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Unit Management Analytics"}),t("div",{className:"text-center py-8",children:[e(Se,{className:"mx-auto h-12 w-12 text-gray-400"}),e("h4",{className:"mt-2 text-sm font-medium text-gray-900",children:"No Unit Data"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Unit management data will be displayed here when available."})]})]})]}),o&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e("div",{className:"flex",children:t("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e("div",{className:"mt-2 text-sm text-red-700",children:e("p",{children:o})})]})})}),r==="revenue-settings"&&e(Lr,{})]})},Rr=({user:a,onLogout:r})=>{const[s,n]=g.exports.useState("available"),[i,o]=g.exports.useState({agencyName:a.agencyName||"",email:a.email||"",serviceType:"BLS/ALS",contactName:a.name||"",phone:"",address:"",city:"",state:"",zipCode:""}),[l,h]=g.exports.useState(!1),[N,y]=g.exports.useState(null),[m,p]=g.exports.useState(!1),[x,f]=g.exports.useState([]),[c,b]=g.exports.useState([]),[u,S]=g.exports.useState(!1),[k,O]=g.exports.useState(null),[F,U]=g.exports.useState(null),[_,G]=g.exports.useState({status:"",pickupTime:""}),[W,P]=g.exports.useState(!1);g.exports.useEffect(()=>{D()},[]);const D=async()=>{S(!0);try{const d=await fetch("/api/trips?status=PENDING",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(d.ok){const z=await d.json();if(z.success&&z.data){const Q=z.data.map(K=>({id:K.id,patientId:K.patientId,origin:K.fromLocation,destination:K.toLocation,pickupLocation:K.pickupLocation,transportLevel:K.transportLevel||"BLS",priority:K.urgencyLevel||K.priority,distance:"12.5 miles",estimatedTime:"25 minutes",revenue:"$150",requestTime:new Date(K.createdAt).toLocaleString(),scheduledTime:K.scheduledTime}));f(Q)}}const E=await fetch("/api/trips?status=ACCEPTED,IN_PROGRESS,COMPLETED",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(E.ok){const z=await E.json();if(z.success&&z.data){const Q=z.data.map(K=>({id:K.id,patientId:K.patientId,origin:K.fromLocation,destination:K.toLocation,pickupLocation:K.pickupLocation,transportLevel:K.transportLevel||"BLS",priority:K.urgencyLevel||K.priority,status:K.status,pickupTime:K.actualStartTime?new Date(K.actualStartTime).toLocaleString():"Not started",scheduledTime:K.scheduledTime}));b(Q)}}}catch(d){console.error("Error loading trips:",d),O("Failed to load trips")}finally{S(!1)}},w=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),r()},M=d=>{const{name:E,value:z}=d.target;o(Q=>({...Q,[E]:z}))},C=async d=>{d.preventDefault(),h(!0),y(null);try{console.log("TCC_DEBUG: Frontend sending EMS agency update:",i),console.log("TCC_DEBUG: Frontend token:",localStorage.getItem("token"));const E=await fetch("/api/auth/ems/agency/update",{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(console.log("TCC_DEBUG: Frontend response status:",E.status),console.log("TCC_DEBUG: Frontend response ok:",E.ok),!E.ok){const Q=await E.json();throw console.log("TCC_DEBUG: Frontend error response:",Q),new Error(Q.error||"Failed to update agency information")}const z=await E.json();console.log("TCC_DEBUG: Frontend success response:",z),p(!0),n("available"),setTimeout(()=>p(!1),3e3)}catch(E){console.error("TCC_DEBUG: Frontend error updating agency:",E),y(E.message||"Failed to update agency information")}finally{h(!1)}},Z=()=>{o({agencyName:a.agencyName||"",email:a.email||"",serviceType:"BLS/ALS",contactName:a.name||"",phone:"",address:"",city:"",state:"",zipCode:""}),y(null),p(!1),n("available")},ee=async d=>{try{const E=await fetch("/api/agency-responses",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({tripId:d,agencyId:a.id,response:"ACCEPTED",responseNotes:"Agency accepted this transport request",estimatedArrival:new Date(Date.now()+9e5).toISOString()})});if(!E.ok){const z=await E.json();throw new Error(z.error||"Failed to accept trip")}await D()}catch(E){console.error("Error accepting trip:",E),O(E.message||"Failed to accept trip")}},R=async d=>{try{const E=await fetch("/api/agency-responses",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({tripId:d,agencyId:a.id,response:"DECLINED",responseNotes:"Agency declined this transport request"})});if(!E.ok){const z=await E.json();throw new Error(z.error||"Failed to decline trip")}await D()}catch(E){console.error("Error declining trip:",E),O(E.message||"Failed to decline trip")}},q=async(d,E)=>{try{const z=await fetch(`/api/trips/${d}/status`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({status:E,...E==="IN_PROGRESS"&&{pickupTimestamp:new Date().toISOString()},...E==="COMPLETED"&&{completionTimestamp:new Date().toISOString()}})});if(!z.ok){const Q=await z.json();throw new Error(Q.error||"Failed to update trip status")}await D()}catch(z){console.error("Error updating trip status:",z),O(z.message||"Failed to update trip status")}},$=d=>{U(d.id),G({status:d.status,pickupTime:d.pickupTime==="Not started"?"":d.pickupTime})},L=d=>{const{name:E,value:z}=d.target;G(Q=>({...Q,[E]:z}))},B=async d=>{P(!0);try{const E={status:_.status};_.pickupTime&&(_.status==="IN_PROGRESS"||_.status==="COMPLETED")&&(E.pickupTimestamp=new Date(_.pickupTime).toISOString()),_.status==="COMPLETED"&&(E.completionTimestamp=new Date().toISOString());const z=await fetch(`/api/trips/${d}/status`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(E)});if(!z.ok){const Q=await z.json();throw new Error(Q.error||"Failed to update trip")}await D(),U(null),G({status:"",pickupTime:""})}catch(E){console.error("Error updating trip:",E),O(E.message||"Failed to update trip")}finally{P(!1)}},H=()=>{U(null),G({status:"",pickupTime:""})},X=d=>{switch(d){case"Emergent":return"text-black bg-red-200";case"Urgent":return"text-black bg-orange-200";case"Routine":return"text-black bg-transparent";default:return"text-gray-600 bg-gray-100"}},I=d=>{switch(d){case"ACCEPTED":return"text-green-600 bg-green-100";case"EN_ROUTE":return"text-blue-600 bg-blue-100";case"PICKUP":return"text-purple-600 bg-purple-100";case"COMPLETED":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}};return t("div",{className:"min-h-screen bg-gray-50",children:[e("header",{className:"bg-white shadow-sm border-b",children:e("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t("div",{className:"flex justify-between items-center h-16",children:[t("div",{className:"flex items-center",children:[e("div",{className:"bg-orange-100 p-2 rounded-lg mr-3",children:e(ie,{className:"h-6 w-6 text-orange-600"})}),t("div",{children:[e("h1",{className:"text-xl font-semibold text-gray-900",children:a.agencyName||"EMS Agency"}),e("p",{className:"text-sm text-gray-500",children:"EMS Agency Dashboard"})]})]}),t("div",{className:"flex items-center space-x-4",children:[e(Er,{user:a}),t("div",{className:"flex items-center space-x-2",children:[e(Ke,{className:"h-5 w-5 text-gray-400"}),e("span",{className:"text-sm text-gray-700",children:a.name})]}),t("button",{onClick:w,className:"flex items-center space-x-1 text-gray-600 hover:text-gray-800",children:[e(Lt,{className:"h-4 w-4"}),e("span",{children:"Logout"})]})]})]})})}),e("div",{className:"bg-white border-b",children:e("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e("nav",{className:"flex space-x-8",children:[{id:"available",name:"Available Trips",icon:Re},{id:"accepted",name:"My Trips",icon:re},{id:"units",name:"Units",icon:We},{id:"analytics",name:"Analytics",icon:me},{id:"settings",name:"Settings",icon:Ke}].map(d=>{const E=d.icon;return t("button",{onClick:()=>{console.log("\u{1F50D} EMSDashboard: Tab clicked:",d.id),n(d.id)},className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ${s===d.id?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e(E,{className:"h-4 w-4"}),e("span",{children:d.name})]},d.id)})})})}),t("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s==="available"&&t("div",{className:"space-y-6",children:[k&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(he,{className:"h-5 w-5 text-red-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800",children:k})})]})}),t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(Re,{className:"h-8 w-8 text-blue-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Available Trips"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:x.length})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(re,{className:"h-8 w-8 text-green-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Active Trips"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:c.length})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(fe,{className:"h-8 w-8 text-yellow-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Completed Today"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:"8"})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(he,{className:"h-8 w-8 text-purple-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Today's Revenue"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:"$1,250"})]})]})})]}),t("div",{className:"bg-white rounded-lg shadow",children:[t("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[t("div",{children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Available Transport Requests"}),e("p",{className:"text-sm text-gray-500",children:"Accept or decline available transport requests"})]}),e("button",{onClick:D,disabled:u,className:"px-3 py-1 text-sm bg-orange-100 text-orange-700 rounded-md hover:bg-orange-200 disabled:opacity-50",children:u?"Loading...":"Refresh"})]}),t("div",{className:"overflow-x-auto",children:[t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Route"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pickup Location"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(d=>t(sa.Fragment,{children:[t("tr",{className:"hover:bg-gray-50",children:[t("td",{className:"px-6 py-4 whitespace-nowrap",children:[t("div",{className:"text-sm font-medium text-gray-900",children:["Patient ",d.patientId]}),e("div",{className:"text-sm text-gray-500",children:d.requestTime})]}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm text-gray-900",children:d.origin}),t("div",{className:"text-sm text-gray-500",children:["\u2192 ",d.destination]})]}),e("td",{className:"px-6 py-4",children:d.pickupLocation?t("div",{className:"text-sm",children:[e("div",{className:"font-medium text-gray-900",children:d.pickupLocation.name}),d.pickupLocation.floor&&t("div",{className:"text-gray-500",children:["Floor: ",d.pickupLocation.floor]}),d.pickupLocation.room&&t("div",{className:"text-gray-500",children:["Room: ",d.pickupLocation.room]}),(d.pickupLocation.contactPhone||d.pickupLocation.contactEmail)&&t("div",{className:"text-xs text-blue-600 mt-1",children:[e("div",{className:"font-medium",children:"Contact:"}),d.pickupLocation.contactPhone&&e("div",{children:d.pickupLocation.contactPhone}),d.pickupLocation.contactEmail&&e("div",{children:d.pickupLocation.contactEmail})]})]}):e("span",{className:"text-sm text-gray-400 italic",children:"No specific location"})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${X(d.priority)}`,children:d.priority})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t("div",{className:"flex space-x-2",children:[e("button",{onClick:()=>ee(d.id),className:"bg-green-600 text-white px-3 py-1 rounded-md hover:bg-green-700 text-xs font-medium",children:"Accept"}),e("button",{onClick:()=>R(d.id),className:"bg-red-600 text-white px-3 py-1 rounded-md hover:bg-red-700 text-xs font-medium",children:"Decline"})]})})]}),e("tr",{children:e("td",{colSpan:5,className:"px-6 py-2 bg-gray-50",children:t("div",{className:"grid grid-cols-4 gap-4 text-sm text-gray-600",children:[t("div",{children:[e("span",{className:"font-medium",children:"Level:"})," ",d.transportLevel]}),t("div",{children:[e("span",{className:"font-medium",children:"Distance:"})," ",d.distance]}),t("div",{children:[e("span",{className:"font-medium",children:"Time:"})," ",d.estimatedTime]}),t("div",{children:[e("span",{className:"font-medium",children:"Revenue:"})," ",d.revenue]})]})})})]},d.id))})]}),x.length===0&&e("div",{className:"p-6 text-center text-gray-500",children:"No available transport requests at this time."})]})]})]}),s==="accepted"&&t("div",{className:"bg-white rounded-lg shadow",children:[t("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"My Accepted Trips"}),e("button",{onClick:D,disabled:u,className:"px-3 py-1 text-sm bg-orange-100 text-orange-700 rounded-md hover:bg-orange-200 disabled:opacity-50",children:u?"Loading...":"Refresh"})]}),t("div",{className:"overflow-x-auto",children:[t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Route"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pickup Location"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pickup Time"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(d=>t("tr",{className:"hover:bg-gray-50",children:[t("td",{className:"px-6 py-4 whitespace-nowrap",children:[t("div",{className:"text-sm font-medium text-gray-900",children:["Patient ",d.patientId]}),e("div",{className:"text-sm text-gray-500",children:d.requestTime})]}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm text-gray-900",children:d.origin}),t("div",{className:"text-sm text-gray-500",children:["\u2192 ",d.destination]})]}),e("td",{className:"px-6 py-4",children:d.pickupLocation?t("div",{className:"text-sm",children:[e("div",{className:"font-medium text-gray-900",children:d.pickupLocation.name}),d.pickupLocation.floor&&t("div",{className:"text-gray-500",children:["Floor: ",d.pickupLocation.floor]}),d.pickupLocation.room&&t("div",{className:"text-gray-500",children:["Room: ",d.pickupLocation.room]}),(d.pickupLocation.contactPhone||d.pickupLocation.contactEmail)&&t("div",{className:"text-xs text-blue-600 mt-1",children:[e("div",{className:"font-medium",children:"Contact:"}),d.pickupLocation.contactPhone&&e("div",{children:d.pickupLocation.contactPhone}),d.pickupLocation.contactEmail&&e("div",{children:d.pickupLocation.contactEmail})]})]}):e("span",{className:"text-sm text-gray-400 italic",children:"No specific location"})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:F===d.id?t("select",{name:"status",value:_.status,onChange:L,className:"text-xs border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:W,children:[e("option",{value:"ACCEPTED",children:"ACCEPTED"}),e("option",{value:"IN_PROGRESS",children:"IN_PROGRESS"}),e("option",{value:"COMPLETED",children:"COMPLETED"}),e("option",{value:"CANCELLED",children:"CANCELLED"})]}):e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I(d.status)}`,children:d.status})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:F===d.id?e("input",{type:"datetime-local",name:"pickupTime",value:_.pickupTime,onChange:L,className:"text-xs border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:W}):e("div",{className:"text-sm text-gray-900",children:d.pickupTime})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:F===d.id?t("div",{className:"flex space-x-2",children:[e("button",{onClick:()=>B(d.id),disabled:W,className:"bg-green-600 text-white px-3 py-1 rounded-md hover:bg-green-700 text-xs font-medium disabled:opacity-50",children:W?"Saving...":"Save"}),e("button",{onClick:H,disabled:W,className:"bg-gray-600 text-white px-3 py-1 rounded-md hover:bg-gray-700 text-xs font-medium disabled:opacity-50",children:"Cancel"})]}):t("div",{className:"flex space-x-2",children:[e("button",{onClick:()=>$(d),className:"bg-blue-600 text-white px-3 py-1 rounded-md hover:bg-blue-700 text-xs font-medium",children:"Edit"}),d.status==="ACCEPTED"&&e("button",{onClick:()=>q(d.id,"IN_PROGRESS"),className:"bg-orange-600 text-white px-3 py-1 rounded-md hover:bg-orange-700 text-xs font-medium",children:"Start Trip"}),d.status==="IN_PROGRESS"&&e("button",{onClick:()=>q(d.id,"COMPLETED"),className:"bg-green-600 text-white px-3 py-1 rounded-md hover:bg-green-700 text-xs font-medium",children:"Complete Trip"})]})})]},d.id))})]}),c.length===0&&e("div",{className:"p-6 text-center text-gray-500",children:"No accepted trips at this time."})]})]}),s==="analytics"&&e(Vi,{user:a}),s==="units"&&t(se,{children:[console.log("\u{1F50D} EMSDashboard: Rendering UnitsManagement component, activeTab:",s),e(Gi,{user:a})]}),s==="settings"&&t("div",{className:"bg-white rounded-lg shadow",children:[t("div",{className:"px-6 py-4 border-b border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Agency Settings"}),e("p",{className:"text-sm text-gray-500",children:"Update your agency information"})]}),t("div",{className:"p-6",children:[m&&e("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-md",children:t("div",{className:"flex",children:[e(re,{className:"h-5 w-5 text-green-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-green-800",children:"Agency information updated successfully!"})})]})}),N&&e("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:t("div",{className:"flex",children:[e(he,{className:"h-5 w-5 text-red-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800",children:N})})]})}),t("form",{onSubmit:C,className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Agency Name"}),e("input",{type:"text",value:i.agencyName,onChange:M,name:"agencyName",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Name"}),e("input",{type:"text",value:i.contactName,onChange:M,name:"contactName",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500",required:!0})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e("input",{type:"email",value:i.email,onChange:M,name:"email",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),e("input",{type:"tel",value:i.phone,onChange:M,name:"phone",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Service Type"}),t("select",{value:i.serviceType,onChange:M,name:"serviceType",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500",children:[e("option",{value:"BLS",children:"BLS Only"}),e("option",{value:"ALS",children:"ALS Only"}),e("option",{value:"BLS/ALS",children:"BLS/ALS"}),e("option",{value:"Critical Care",children:"Critical Care"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),e("input",{type:"text",value:i.address,onChange:M,name:"address",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),e("input",{type:"text",value:i.city,onChange:M,name:"city",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),e("input",{type:"text",value:i.state,onChange:M,name:"state",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"ZIP Code"}),e("input",{type:"text",value:i.zipCode,onChange:M,name:"zipCode",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500"})]})]}),t("div",{className:"flex justify-end space-x-3",children:[e("button",{type:"button",onClick:Z,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500",children:"Cancel"}),e("button",{type:"submit",disabled:l,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50",children:l?"Saving...":"Save Changes"})]})]})]})]})]})]})},Ki=()=>{var F,U,_,G,W,P;const[a,r]=g.exports.useState({emailNotifications:!0,smsNotifications:!1,phone:"",notificationTypes:{trip_assignment:{email:!0,sms:!1},trip_status_update:{email:!0,sms:!1},trip_accepted:{email:!0,sms:!1}}}),[s,n]=g.exports.useState(!0),[i,o]=g.exports.useState(!1),[l,h]=g.exports.useState(null),[N,y]=g.exports.useState("idle"),[m,p]=g.exports.useState("idle"),[x,f]=g.exports.useState("idle");g.exports.useEffect(()=>{c()},[]),g.exports.useEffect(()=>{console.log("TCC_DEBUG: NotificationSettings component mounted with settings:",a)},[a]);const c=async()=>{try{const D=await V.get("/api/notifications/preferences");if(D.data.success){const w=D.data.data,M={emailNotifications:w.emailEnabled||!0,smsNotifications:w.smsEnabled||!1,phone:w.phone||"",notificationTypes:w.notificationTypes||{trip_assignment:{email:!0,sms:!1},trip_status_update:{email:!0,sms:!1},trip_accepted:{email:!0,sms:!1}}};console.log("TCC_DEBUG: Fetched settings for user:",M),r(M)}}catch(D){console.error("TCC_DEBUG: Error fetching notification settings:",D)}finally{n(!1)}},b=async()=>{var D,w;console.log("TCC_DEBUG: Save button clicked with settings:",a),o(!0),f("saving"),h(null);try{console.log("TCC_DEBUG: Sending settings to API:",a);const M=await V.put("/api/notifications/preferences",{emailNotifications:a.emailNotifications,smsNotifications:a.smsNotifications,phone:a.phone,notificationTypes:a.notificationTypes});console.log("TCC_DEBUG: API response status:",M.status),console.log("TCC_DEBUG: Settings saved successfully:",M.data),f("success");const C={type:"success",text:"Notification settings saved successfully!"};console.log("TCC_DEBUG: Setting message to:",C),h(C),setTimeout(()=>{console.log("TCC_DEBUG: Clearing message after timeout"),h(null),f("idle")},3e3)}catch(M){console.error("TCC_DEBUG: Error saving notification settings:",M),f("error");const C=((w=(D=M.response)==null?void 0:D.data)==null?void 0:w.error)||"Failed to save settings";h({type:"error",text:C}),setTimeout(()=>{h(null),f("idle")},5e3)}finally{o(!1)}},u=async()=>{var D,w;y("testing"),h(null);try{const M=await V.post("/api/notifications/test-email",{to:"test@example.com",template:"newTripRequest"});M.data.success?(y("success"),h({type:"success",text:"Email service connection successful!"})):(y("error"),h({type:"error",text:M.data.error||"Email service connection failed"}))}catch(M){console.error("TCC_DEBUG: Error testing email connection:",M),y("error");const C=((w=(D=M.response)==null?void 0:D.data)==null?void 0:w.error)||"Email service connection failed";h({type:"error",text:C})}},S=async()=>{var D,w;p("testing"),h(null);try{const M=await V.post("/api/notifications/test-sms",{to:a.phone||"5551234567",message:"Test SMS from TCC notification system"});M.data.success?(p("success"),h({type:"success",text:"SMS service connection successful!"})):(p("error"),h({type:"error",text:M.data.error||"SMS service connection failed"}))}catch(M){console.error("TCC_DEBUG: Error testing SMS connection:",M),p("error");const C=((w=(D=M.response)==null?void 0:D.data)==null?void 0:w.error)||"SMS service connection failed";h({type:"error",text:C})}},k=(D,w)=>{console.log("TCC_DEBUG: Setting change:",{key:D,value:w,currentSettings:a}),r(M=>{const C={...M,[D]:w};return console.log("TCC_DEBUG: New settings after change:",C),C})},O=(D,w,M)=>{console.log("TCC_DEBUG: Notification type change:",{type:D,channel:w,enabled:M}),r(C=>{const Z={...C,notificationTypes:{...C.notificationTypes,[D]:{...C.notificationTypes[D],[w]:M}}};return console.log("TCC_DEBUG: New notification types after change:",Z.notificationTypes),Z})};return s?t("div",{className:"flex items-center justify-center p-8",children:[e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e("span",{className:"ml-2",children:"Loading notification settings..."})]}):t("div",{className:"max-w-4xl mx-auto p-6",children:[e("style",{children:`
          @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
          }
        `}),t("div",{className:"bg-white rounded-lg shadow-lg",children:[t("div",{className:"px-6 py-4 border-b border-gray-200",children:[t("div",{className:"flex items-center",children:[e(Qe,{className:"h-6 w-6 text-blue-600 mr-3"}),e("h2",{className:"text-2xl font-bold text-gray-900",children:"Notification Settings"})]}),e("p",{className:"text-gray-600 mt-2",children:"Configure how you receive notifications about transport requests and updates."})]}),t("div",{className:"p-6",children:[(()=>(console.log("TCC_DEBUG: Rendering message section, message state:",l),console.log("TCC_DEBUG: Message truthy check:",!!l),l?(console.log("TCC_DEBUG: Rendering message with type:",l.type,"text:",l.text),t("div",{className:`mb-6 p-4 rounded-lg flex items-center border-2 ${l.type==="success"?"bg-green-50 text-green-800 border-green-200 shadow-lg":"bg-red-50 text-red-800 border-red-200 shadow-lg"}`,style:{zIndex:1e3,position:"relative",minHeight:"50px",fontSize:"16px",fontWeight:"600"},children:[l.type==="success"?e(re,{className:"h-5 w-5 mr-3 text-green-600"}):e(he,{className:"h-5 w-5 mr-3 text-red-600"}),e("span",{className:"text-lg font-semibold",children:l.text})]})):null))(),t("div",{className:"space-y-6",children:[t("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[t("div",{className:"flex items-center",children:[e(ia,{className:"h-5 w-5 text-gray-600 mr-3"}),t("div",{children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Email Notifications"}),e("p",{className:"text-sm text-gray-600",children:"Receive email notifications for transport request updates"})]})]}),t("label",{className:"relative inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",checked:a.emailNotifications,onChange:D=>k("emailNotifications",D.target.checked),className:"sr-only peer"}),e("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),t("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e("input",{type:"tel",value:a.phone,onChange:D=>k("phone",D.target.value),placeholder:"Enter your phone number (e.g., 5551234567)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e("p",{className:"text-xs text-gray-600 mt-1",children:"This phone number will receive SMS notifications"})]}),t("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[t("div",{className:"flex items-center",children:[e(Qe,{className:"h-5 w-5 text-gray-600 mr-3"}),t("div",{children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"SMS Notifications"}),e("p",{className:"text-sm text-gray-600",children:"Receive SMS text messages for urgent transport requests"})]})]}),t("label",{className:"relative inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",checked:a.smsNotifications,onChange:D=>k("smsNotifications",D.target.checked),className:"sr-only peer"}),e("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),t("div",{className:"space-y-4",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Notification Types"}),t("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e("div",{className:"flex items-center justify-between mb-3",children:t("div",{children:[e("h4",{className:"text-md font-medium text-gray-900",children:"Trip Assignment"}),e("p",{className:"text-sm text-gray-600",children:"Get notified when new transport requests are assigned"})]})}),t("div",{className:"flex space-x-6",children:[t("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:((F=a.notificationTypes.trip_assignment)==null?void 0:F.email)||!1,onChange:D=>O("trip_assignment","email",D.target.checked),disabled:!a.emailNotifications,className:"mr-2"}),e("span",{className:`text-sm ${a.emailNotifications?"text-gray-700":"text-gray-400"}`,children:"Email"})]}),t("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:((U=a.notificationTypes.trip_assignment)==null?void 0:U.sms)||!1,onChange:D=>O("trip_assignment","sms",D.target.checked),disabled:!a.smsNotifications,className:"mr-2"}),e("span",{className:`text-sm ${a.smsNotifications?"text-gray-700":"text-gray-400"}`,children:"SMS"})]})]})]}),t("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e("div",{className:"flex items-center justify-between mb-3",children:t("div",{children:[e("h4",{className:"text-md font-medium text-gray-900",children:"Trip Status Updates"}),e("p",{className:"text-sm text-gray-600",children:"Get notified when transport request status changes"})]})}),t("div",{className:"flex space-x-6",children:[t("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:((_=a.notificationTypes.trip_status_update)==null?void 0:_.email)||!1,onChange:D=>O("trip_status_update","email",D.target.checked),disabled:!a.emailNotifications,className:"mr-2"}),e("span",{className:`text-sm ${a.emailNotifications?"text-gray-700":"text-gray-400"}`,children:"Email"})]}),t("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:((G=a.notificationTypes.trip_status_update)==null?void 0:G.sms)||!1,onChange:D=>O("trip_status_update","sms",D.target.checked),disabled:!a.smsNotifications,className:"mr-2"}),e("span",{className:`text-sm ${a.smsNotifications?"text-gray-700":"text-gray-400"}`,children:"SMS"})]})]})]}),t("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e("div",{className:"flex items-center justify-between mb-3",children:t("div",{children:[e("h4",{className:"text-md font-medium text-gray-900",children:"Trip Accepted"}),e("p",{className:"text-sm text-gray-600",children:"Get notified when transport requests are accepted"})]})}),t("div",{className:"flex space-x-6",children:[t("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:((W=a.notificationTypes.trip_accepted)==null?void 0:W.email)||!1,onChange:D=>O("trip_accepted","email",D.target.checked),disabled:!a.emailNotifications,className:"mr-2"}),e("span",{className:`text-sm ${a.emailNotifications?"text-gray-700":"text-gray-400"}`,children:"Email"})]}),t("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:((P=a.notificationTypes.trip_accepted)==null?void 0:P.sms)||!1,onChange:D=>O("trip_accepted","sms",D.target.checked),disabled:!a.smsNotifications,className:"mr-2"}),e("span",{className:`text-sm ${a.smsNotifications?"text-gray-700":"text-gray-400"}`,children:"SMS"})]})]})]})]})]}),t("div",{className:"mt-8 space-y-4",children:[t("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Email Service Test"}),e("p",{className:"text-sm text-gray-600 mb-4",children:"Test the email service connection to ensure notifications are working properly."}),e("button",{onClick:u,disabled:N==="testing",className:`px-4 py-2 rounded-md text-sm font-medium ${N==="testing"?"bg-gray-300 text-gray-500 cursor-not-allowed":N==="success"?"bg-green-600 text-white hover:bg-green-700":N==="error"?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:N==="testing"?t(se,{children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline-block mr-2"}),"Testing..."]}):N==="success"?t(se,{children:[e(re,{className:"h-4 w-4 inline-block mr-2"}),"Connection Successful"]}):N==="error"?t(se,{children:[e(he,{className:"h-4 w-4 inline-block mr-2"}),"Connection Failed"]}):"Test Email Connection"})]}),t("div",{className:"p-4 bg-green-50 rounded-lg",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"SMS Service Test"}),e("p",{className:"text-sm text-gray-600 mb-4",children:"Test the SMS service connection (placeholder for future Twilio integration)."}),e("button",{onClick:S,disabled:m==="testing",className:`px-4 py-2 rounded-md text-sm font-medium ${m==="testing"?"bg-gray-300 text-gray-500 cursor-not-allowed":m==="success"?"bg-green-600 text-white hover:bg-green-700":m==="error"?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:m==="testing"?t(se,{children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline-block mr-2"}),"Testing..."]}):m==="success"?t(se,{children:[e(re,{className:"h-4 w-4 inline-block mr-2"}),"Connection Successful"]}):m==="error"?t(se,{children:[e(he,{className:"h-4 w-4 inline-block mr-2"}),"Connection Failed"]}):"Test SMS Connection"})]})]}),e("div",{className:"mt-8 flex justify-end",children:e("button",{onClick:b,disabled:i,className:`px-6 py-2 rounded-md flex items-center transition-colors duration-200 ${x==="success"?"bg-green-600 text-white":x==="error"?"bg-red-600 text-white":x==="saving"?"bg-blue-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"} disabled:bg-gray-400 disabled:cursor-not-allowed`,children:x==="saving"?t(se,{children:[e("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):x==="success"?t(se,{children:[e(re,{className:"h-4 w-4 mr-2"}),"Saved!"]}):x==="error"?t(se,{children:[e(he,{className:"h-4 w-4 mr-2"}),"Error"]}):"Save Settings"})})]})]})]})},Va=()=>{const[a,r]=g.exports.useState([]),[s,n]=g.exports.useState(!0),[i,o]=g.exports.useState(null),[l,h]=g.exports.useState(!1),[N,y]=g.exports.useState(null),[m,p]=g.exports.useState({name:"",email:"",password:"",userType:"USER"});g.exports.useEffect(()=>{x()},[]);const x=async()=>{var k,O;try{n(!0);const F=await ut.getUsers();F.data.success?r(F.data.users):o("Failed to load users")}catch(F){o(((O=(k=F.response)==null?void 0:k.data)==null?void 0:O.error)||"Failed to load users")}finally{n(!1)}},f=async k=>{var O,F;k.preventDefault();try{if(o(null),N)console.log("Update user:",N.id,m),y(null);else{const U=await ut.register(m);U.data.success?(await x(),h(!1),c()):o(U.data.error||"Failed to create user")}}catch(U){o(((F=(O=U.response)==null?void 0:O.data)==null?void 0:F.error)||"Failed to save user")}},c=()=>{p({name:"",email:"",password:"",userType:"USER"})},b=k=>{y(k),p({name:k.name,email:k.email,password:"",userType:k.userType}),h(!0)},u=()=>{h(!1),y(null),c()},S=k=>new Date(k).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return s?e("div",{className:"flex items-center justify-center h-64",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):t("div",{children:[e("div",{className:"mb-8",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Manage system users and their access levels."})]}),t("button",{onClick:()=>h(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e(_e,{className:"h-4 w-4 mr-2"}),"Add User"]})]})}),i&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:t("div",{className:"flex",children:[e(Ee,{className:"h-5 w-5 text-red-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800",children:i})})]})}),e("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e("div",{className:"px-4 py-5 sm:p-6",children:e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(k=>t("tr",{className:"hover:bg-gray-50",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0 h-10 w-10",children:e("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:e(Ke,{className:"h-5 w-5 text-gray-600"})})}),t("div",{className:"ml-4",children:[e("div",{className:"text-sm font-medium text-gray-900",children:k.name}),t("div",{className:"text-sm text-gray-500 flex items-center",children:[e(ia,{className:"h-3 w-3 mr-1"}),k.email]})]})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{className:"flex items-center",children:[k.userType==="ADMIN"?e(na,{className:"h-4 w-4 text-red-500 mr-2"}):e(Ke,{className:"h-4 w-4 text-blue-500 mr-2"}),e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${k.userType==="ADMIN"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:k.userType})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${k.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:k.isActive?t(se,{children:[e(re,{className:"h-3 w-3 mr-1"}),"Active"]}):t(se,{children:[e(Ee,{className:"h-3 w-3 mr-1"}),"Inactive"]})})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t("div",{className:"flex items-center",children:[e(ot,{className:"h-3 w-3 mr-1"}),S(k.createdAt)]})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>b(k),className:"text-indigo-600 hover:text-indigo-900",children:e(Ot,{className:"h-4 w-4"})}),e("button",{onClick:()=>{window.confirm("Are you sure you want to delete this user?")&&console.log("Delete user:",k.id)},className:"text-red-600 hover:text-red-900",children:e(ht,{className:"h-4 w-4"})})]})})]},k.id))})]})})})}),l&&e("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:t("div",{className:"mt-3",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:N?"Edit User":"Add New User"}),e("button",{onClick:u,className:"text-gray-400 hover:text-gray-600",children:e(Ee,{className:"h-6 w-6"})})]}),t("form",{onSubmit:f,className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e("input",{type:"text",required:!0,value:m.name,onChange:k=>p({...m,name:k.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e("input",{type:"email",required:!0,value:m.email,onChange:k=>p({...m,email:k.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),e("input",{type:"password",required:!N,value:m.password,onChange:k=>p({...m,password:k.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:N?"Leave blank to keep current password":""})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"User Type"}),t("select",{value:m.userType,onChange:k=>p({...m,userType:k.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e("option",{value:"USER",children:"User (Standard Access)"}),e("option",{value:"ADMIN",children:"Admin (Full Access)"})]})]}),t("div",{className:"flex justify-end space-x-3 pt-4",children:[e("button",{type:"button",onClick:u,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),e("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:N?"Update User":"Create User"})]})]})]})})})]})},Ji=()=>{const[a,r]=g.exports.useState([]),[s,n]=g.exports.useState(!1),[i,o]=g.exports.useState(!1),[l,h]=g.exports.useState(null);g.exports.useEffect(()=>{N()},[]);const N=async()=>{try{n(!0);const b=await(await fetch("/api/backup/history",{credentials:"include"})).json();b.success?r(b.data):h({type:"error",text:b.error||"Failed to load backup history"})}catch(c){console.error("Error loading backup history:",c),h({type:"error",text:"Failed to load backup history"})}finally{n(!1)}},y=async()=>{try{o(!0),h(null);const b=await(await fetch("/api/backup/create",{method:"POST",credentials:"include"})).json();b.success?(h({type:"success",text:"Backup created successfully!"}),N()):h({type:"error",text:b.error||"Failed to create backup"})}catch(c){console.error("Error creating backup:",c),h({type:"error",text:"Failed to create backup"})}finally{o(!1)}},m=async c=>{try{const b=await fetch(`/api/backup/download/${c}`,{credentials:"include"});if(b.ok){const u=await b.blob(),S=window.URL.createObjectURL(u),k=document.createElement("a");k.href=S,k.download=c,document.body.appendChild(k),k.click(),window.URL.revokeObjectURL(S),document.body.removeChild(k)}else h({type:"error",text:"Failed to download backup"})}catch(b){console.error("Error downloading backup:",b),h({type:"error",text:"Failed to download backup"})}},p=async c=>{if(!!window.confirm(`Are you sure you want to delete ${c}?`))try{const u=await(await fetch(`/api/backup/${c}`,{method:"DELETE",credentials:"include"})).json();u.success?(h({type:"success",text:"Backup deleted successfully!"}),N()):h({type:"error",text:u.error||"Failed to delete backup"})}catch(b){console.error("Error deleting backup:",b),h({type:"error",text:"Failed to delete backup"})}},x=c=>{if(c===0)return"0 Bytes";const b=1024,u=["Bytes","KB","MB","GB"],S=Math.floor(Math.log(c)/Math.log(b));return parseFloat((c/Math.pow(b,S)).toFixed(2))+" "+u[S]},f=c=>new Date(c).toLocaleString();return e("div",{className:"min-h-full bg-gray-100 p-4 sm:p-6 lg:p-8",children:t("div",{className:"max-w-7xl mx-auto",children:[t("div",{className:"mb-8",children:[e("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Backup Management"}),e("p",{className:"text-gray-600",children:"Create, download, and manage database backups for data protection and compliance."})]}),l&&t("div",{className:`mb-6 p-4 rounded-lg flex items-center ${l.type==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:[l.type==="success"?e(re,{className:"h-5 w-5 mr-2"}):e(he,{className:"h-5 w-5 mr-2"}),l.text]}),e("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:t("div",{className:"flex flex-col sm:flex-row gap-4",children:[t("button",{onClick:y,disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[i?e(fe,{className:"h-4 w-4 mr-2 animate-spin"}):e(_e,{className:"h-4 w-4 mr-2"}),i?"Creating Backup...":"Create New Backup"]}),t("button",{onClick:N,disabled:s,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(Xt,{className:"h-4 w-4 mr-2"}),"Refresh List"]})]})}),t("div",{className:"bg-white shadow rounded-lg",children:[t("div",{className:"px-6 py-4 border-b border-gray-200",children:[e("h2",{className:"text-lg font-medium text-gray-900",children:"Backup History"}),t("p",{className:"text-sm text-gray-500",children:[a.length," backup",a.length!==1?"s":""," found"]})]}),s?t("div",{className:"p-6 text-center",children:[e(fe,{className:"h-8 w-8 mx-auto text-gray-400 animate-spin mb-2"}),e("p",{className:"text-gray-500",children:"Loading backup history..."})]}):a.length===0?t("div",{className:"p-6 text-center",children:[e(He,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No backups found"}),e("p",{className:"text-gray-500 mb-4",children:"Create your first backup to get started."}),t("button",{onClick:y,disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[e(_e,{className:"h-4 w-4 mr-2"}),"Create First Backup"]})]}):e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Filename"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Size"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Modified"}),e("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(c=>t("tr",{className:"hover:bg-gray-50",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{className:"flex items-center",children:[e(He,{className:"h-5 w-5 text-gray-400 mr-3"}),e("span",{className:"text-sm font-medium text-gray-900",children:c.filename})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x(c.size)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t("div",{className:"flex items-center",children:[e(ot,{className:"h-4 w-4 mr-2"}),f(c.created)]})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f(c.modified)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:t("div",{className:"flex justify-end space-x-2",children:[e("button",{onClick:()=>m(c.filename),className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"Download backup",children:e(ze,{className:"h-4 w-4"})}),e("button",{onClick:()=>p(c.filename),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Delete backup",children:e(ht,{className:"h-4 w-4"})})]})})]},c.filename))})]})})]}),e("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:t("div",{className:"flex items-start",children:[e(Xt,{className:"h-5 w-5 text-blue-400 mr-3 mt-0.5"}),t("div",{children:[e("h3",{className:"text-sm font-medium text-blue-800",children:"External Drive Backup"}),t("p",{className:"text-sm text-blue-700 mt-1",children:["Database backups are stored in ",e("code",{className:"bg-blue-100 px-1 rounded",children:"database-backups/"})," and automatically copied to ",e("code",{className:"bg-blue-100 px-1 rounded",children:"/Volumes/Acasis/tcc-database-backups/"}),"when the external drive is available."]})]})]})})]})})},Yi=()=>{const[a,r]=g.exports.useState([]),[s,n]=g.exports.useState([]),[i,o]=g.exports.useState(!0),[l,h]=g.exports.useState(null),[N,y]=g.exports.useState("all"),[m,p]=g.exports.useState("all"),x="https://api.tcc-production.com";g.exports.useEffect(()=>{f()},[]);const f=async()=>{var k;try{o(!0);const O=localStorage.getItem("token");if(!O){h("No authentication token found");return}const F=await fetch(`${x}/api/tcc/agencies`,{headers:{Authorization:`Bearer ${O}`,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});if(!F.ok)throw new Error(`Failed to fetch agencies: ${F.statusText}`);const U=await F.json();console.log("\u{1F50D} TCCUnitsManagement: Agencies response:",U),U.success&&n(U.data||[]);const _=await fetch(`${x}/api/tcc/units`,{headers:{Authorization:`Bearer ${O}`,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});if(!_.ok)throw new Error(`Failed to fetch units: ${_.statusText}`);const G=await _.json();console.log("\u{1F50D} TCCUnitsManagement: Units response:",G),G.success&&(r(G.data||[]),console.log("\u{1F50D} TCCUnitsManagement: Units count:",((k=G.data)==null?void 0:k.length)||0))}catch(O){console.error("Error fetching data:",O),h(O instanceof Error?O.message:"An error occurred")}finally{o(!1)}},c=k=>{const O=s.find(F=>F.id===k);return O?O.name:`Agency ${k}`},b=k=>{switch(k){case"AVAILABLE":return"bg-green-100 text-green-800";case"COMMITTED":return"bg-blue-100 text-blue-800";case"OUT_OF_SERVICE":return"bg-red-100 text-red-800";case"MAINTENANCE":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},u=k=>{switch(k){case"AMBULANCE":return"bg-red-100 text-red-800";case"WHEELCHAIR_VAN":return"bg-blue-100 text-blue-800";case"CRITICAL_CARE":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},S=a.filter(k=>{const O=N==="all"||k.agencyId===N,F=m==="all"||k.currentStatus===m;return O&&F});return i?e("div",{className:"flex justify-center items-center h-64",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l?e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e("div",{className:"flex",children:t("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e("div",{className:"mt-2 text-sm text-red-700",children:e("p",{children:l})}),e("div",{className:"mt-4",children:e("button",{onClick:f,className:"bg-red-100 px-3 py-2 rounded-md text-sm font-medium text-red-800 hover:bg-red-200",children:"Retry"})})]})})}):t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold text-gray-900",children:"Units Management"}),e("p",{className:"text-gray-600",children:"Manage and monitor all EMS units across agencies"})]}),e("button",{onClick:f,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Refresh"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e("div",{className:"p-2 bg-blue-100 rounded-lg",children:e("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600",children:"Total Units"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:a.length})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e("div",{className:"p-2 bg-green-100 rounded-lg",children:e("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600",children:"Available"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:a.filter(k=>k.currentStatus==="AVAILABLE").length})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e("div",{className:"p-2 bg-blue-100 rounded-lg",children:e("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600",children:"Committed"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:a.filter(k=>k.currentStatus==="COMMITTED").length})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e("div",{className:"p-2 bg-red-100 rounded-lg",children:e("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600",children:"Out of Service"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:a.filter(k=>k.currentStatus==="OUT_OF_SERVICE").length})]})]})})]}),e("div",{className:"bg-white p-4 rounded-lg shadow",children:t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Agency"}),t("select",{value:N,onChange:k=>y(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e("option",{value:"all",children:"All Agencies"}),s.map(k=>e("option",{value:k.id,children:k.name},k.id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Status"}),t("select",{value:m,onChange:k=>p(k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e("option",{value:"all",children:"All Statuses"}),e("option",{value:"AVAILABLE",children:"Available"}),e("option",{value:"COMMITTED",children:"Committed"}),e("option",{value:"OUT_OF_SERVICE",children:"Out of Service"}),e("option",{value:"MAINTENANCE",children:"Maintenance"})]})]})]})}),t("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:[t("div",{className:"px-4 py-5 sm:px-6",children:[t("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:["Units (",S.length,")"]}),e("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"All EMS units across all agencies"})]}),e("div",{className:"border-t border-gray-200",children:S.length===0?t("div",{className:"text-center py-12",children:[e("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No units found"}),e("p",{className:"mt-1 text-sm text-gray-500",children:N==="all"&&m==="all"?"No units have been created yet.":"No units match the current filters."})]}):e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agency"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capabilities"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trips Completed"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Update"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(k=>t("tr",{className:"hover:bg-gray-50",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0 h-10 w-10",children:e("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e("span",{className:"text-sm font-medium text-blue-600",children:k.unitNumber})})}),t("div",{className:"ml-4",children:[e("div",{className:"text-sm font-medium text-gray-900",children:k.unitNumber}),e("div",{className:"text-sm text-gray-500",children:k.isActive?"Active":"Inactive"})]})]})}),t("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm text-gray-900",children:c(k.agencyId)}),e("div",{className:"text-sm text-gray-500",children:k.agencyId})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${u(k.type)}`,children:k.type.replace("_"," ")})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${b(k.currentStatus)}`,children:k.currentStatus.replace("_"," ")})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("div",{className:"flex flex-wrap gap-1",children:k.capabilities.map((O,F)=>e("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded",children:O},F))})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.totalTripsCompleted}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(k.lastStatusUpdate).toLocaleString()})]},k.id))})]})})})]})]})};class Xi{constructor(){Na(this,"baseUrl","/api/optimize")}async optimizeRoutes(r){try{const s=await fetch(`${this.baseUrl}/routes`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(r)}),n=await s.json();if(!s.ok)throw new Error(n.error||"Failed to optimize routes");return n}catch(s){return console.error("Error optimizing routes:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}async analyzeBackhaul(r){try{const s=await fetch(`${this.baseUrl}/backhaul`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({requestIds:r})}),n=await s.json();if(!s.ok)throw new Error(n.error||"Failed to analyze backhaul opportunities");return n}catch(s){return console.error("Error analyzing backhaul:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}async getRevenueAnalytics(r="24h",s){try{const n=new URLSearchParams({timeframe:r});s&&n.append("agencyId",s);const i=await fetch(`${this.baseUrl}/revenue?${n}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),o=await i.json();if(!i.ok)throw new Error(o.error||"Failed to get revenue analytics");return o}catch(n){return console.error("Error getting revenue analytics:",n),{success:!1,error:n instanceof Error?n.message:"Unknown error occurred"}}}async getPerformanceMetrics(r="24h",s){try{const n=new URLSearchParams({timeframe:r});s&&n.append("unitId",s);const i=await fetch(`${this.baseUrl}/performance?${n}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),o=await i.json();if(!i.ok)throw new Error(o.error||"Failed to get performance metrics");return o}catch(n){return console.error("Error getting performance metrics:",n),{success:!1,error:n instanceof Error?n.message:"Unknown error occurred"}}}async getAvailableUnits(){try{const r=await fetch("/api/units/available",{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),s=await r.json();if(!r.ok)throw new Error(s.error||"Failed to get available units");return s.data||[]}catch(r){return console.error("Error getting available units:",r),[]}}async getPendingRequests(){try{const r=await fetch("/api/trips?status=PENDING",{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),s=await r.json();if(!r.ok)throw new Error(s.error||"Failed to get pending requests");return(s.data||[]).map(n=>{var i,o,l,h;return{id:n.id,patientId:n.patientId,originFacilityId:n.fromFacilityId||"unknown",destinationFacilityId:n.toFacilityId||"unknown",transportLevel:n.transportLevel||"BLS",priority:n.priority||"MEDIUM",status:n.status||"PENDING",specialRequirements:n.specialRequirements||"",requestTimestamp:new Date(n.createdAt),readyStart:new Date(n.scheduledTime||n.createdAt),readyEnd:new Date(new Date(n.scheduledTime||n.createdAt).getTime()+60*60*1e3),originLocation:{lat:((i=n.fromLocation)==null?void 0:i.lat)||40.7128,lng:((o=n.fromLocation)==null?void 0:o.lng)||-74.006},destinationLocation:{lat:((l=n.toLocation)==null?void 0:l.lat)||40.7589,lng:((h=n.toLocation)==null?void 0:h.lng)||-73.9851}}})}catch(r){return console.error("Error getting pending requests:",r),[]}}async updateOptimizationWeights(r){try{const s=await fetch(`${this.baseUrl}/weights`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({weights:r})});if(!s.ok){const n=await s.json();throw new Error(n.error||"Failed to update optimization weights")}return!0}catch(s){return console.error("Error updating optimization weights:",s),!1}}async getOptimizationSettings(){try{const r=await fetch(`${this.baseUrl}/settings`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),s=await r.json();if(!r.ok)throw new Error(s.error||"Failed to get optimization settings");return s.data||{}}catch(r){return console.error("Error getting optimization settings:",r),{}}}async saveOptimizationSettings(r){try{const s=await fetch(`${this.baseUrl}/settings`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(r)});if(!s.ok){const n=await s.json();throw new Error(n.error||"Failed to save optimization settings")}return!0}catch(s){return console.error("Error saving optimization settings:",s),!1}}}const vt=new Xi,Zi=()=>{const[a,r]=g.exports.useState(""),[s,n]=g.exports.useState([]),[i,o]=g.exports.useState([]),[l,h]=g.exports.useState([]),[N,y]=g.exports.useState(null),[m,p]=g.exports.useState(null),[x,f]=g.exports.useState(null),[c,b]=g.exports.useState(null),[u,S]=g.exports.useState(!1),[k,O]=g.exports.useState(!1),[F,U]=g.exports.useState(!1),[_,G]=g.exports.useState(!1),[W,P]=g.exports.useState(null),[D,w]=g.exports.useState(!1),[M,C]=g.exports.useState({weights:{deadheadMiles:.5,waitTime:.1,backhaulBonus:25,overtimeRisk:2,baseRevenue:1},constraints:{maxDeadheadMiles:50,maxWaitTime:120,maxOvertimeHours:2,maxBackhaulDistance:15,maxBackhaulTimeWindow:90},autoOptimize:!1,refreshInterval:30});g.exports.useEffect(()=>{ee(),Z()},[]);const Z=()=>{try{const I=localStorage.getItem("tcc_optimization_settings");if(I){const d=JSON.parse(I);C(E=>({...E,...d})),console.log("TCC_DEBUG: Loaded saved optimization settings")}}catch(I){console.error("TCC_DEBUG: Error loading saved settings:",I)}};g.exports.useEffect(()=>{if(M.autoOptimize){const I=setInterval(()=>{a&&l.length>0&&L()},M.refreshInterval*1e3);return()=>clearInterval(I)}},[M.autoOptimize,M.refreshInterval,a,l]);const ee=async()=>{try{await Promise.all([R(),q(),$()])}catch(I){console.error("TCC_DEBUG: Error loading initial data:",I),P("Failed to load initial data")}},R=async()=>{var I;O(!0);try{console.log("TCC_DEBUG: Loading system-wide units for TCC optimization");const d=localStorage.getItem("token"),E="https://api.tcc-production.com";if(!d)throw new Error("No authentication token found");const z=await fetch(`${E}/api/tcc/units`,{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});if(!z.ok)throw new Error(`Failed to fetch units: ${z.statusText}`);const Q=await z.json();if(console.log("TCC_DEBUG: Units API response:",Q),Q.success)console.log("TCC_DEBUG: Units loaded:",((I=Q.data)==null?void 0:I.length)||0),n(Q.data||[]);else throw new Error(Q.error||"Failed to load units")}catch(d){P("Failed to load units"),console.error("TCC_DEBUG: Units loading error:",d)}finally{O(!1)}},q=async()=>{U(!0);try{console.log("TCC_DEBUG: Loading system-wide pending requests for TCC optimization");const I=localStorage.getItem("token"),d="https://api.tcc-production.com";if(!I)throw new Error("No authentication token found");const E=await fetch(`${d}/api/trips?status=PENDING`,{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});if(!E.ok)throw new Error(`Failed to fetch pending requests: ${E.statusText}`);const z=await E.json();if(console.log("TCC_DEBUG: Pending requests API response:",z),z.success){const Q=(z.data||[]).map(K=>({id:K.id,patientId:K.patientId,originFacilityId:K.fromFacilityId||K.fromLocation||"Unknown",destinationFacilityId:K.toFacilityId||K.toLocation||"Unknown",transportLevel:K.transportLevel||"BLS",priority:K.priority||"MEDIUM",status:K.status||"PENDING",specialRequirements:K.specialNeeds||K.specialRequirements||"",requestTimestamp:new Date(K.requestTimestamp||K.createdAt),readyStart:new Date(K.scheduledTime||K.createdAt),readyEnd:new Date(new Date(K.scheduledTime||K.createdAt).getTime()+36e5),originLocation:{lat:K.originLatitude||40.7128,lng:K.originLongitude||-74.006},destinationLocation:{lat:K.destinationLatitude||40.7589,lng:K.destinationLongitude||-73.9851}}));console.log("TCC_DEBUG: Pending requests loaded:",Q.length),o(Q)}else throw new Error(z.error||"Failed to load pending requests")}catch(I){P("Failed to load pending requests"),console.error("TCC_DEBUG: Requests loading error:",I)}finally{U(!1)}},$=async()=>{G(!0);try{console.log("TCC_DEBUG: Loading analytics data...");const[I,d]=await Promise.all([vt.getRevenueAnalytics("24h"),vt.getPerformanceMetrics("24h")]);console.log("TCC_DEBUG: Revenue analytics response:",I),console.log("TCC_DEBUG: Performance metrics response:",d),f(I),b(d)}catch(I){console.error("TCC_DEBUG: Analytics loading error:",I),P("Failed to load analytics data")}finally{G(!1)}},L=async()=>{if(!a||l.length===0){P("Please select a unit and at least one request");return}S(!0),P(null);try{const I=await vt.optimizeRoutes({unitId:a,requestIds:l,constraints:M.constraints});y(I)}catch(I){P("Failed to optimize routes"),console.error("Optimization error:",I)}finally{S(!1)}},B=async()=>{if(l.length<2){P("Please select at least 2 requests for backhaul analysis");return}S(!0),P(null);try{console.log("TCC_DEBUG: Starting backhaul analysis with selected requests:",l);const I=await vt.analyzeBackhaul(l);console.log("TCC_DEBUG: Backhaul analysis response:",I),p(I)}catch(I){P("Failed to analyze backhaul opportunities"),console.error("TCC_DEBUG: Backhaul analysis error:",I)}finally{S(!1)}},H=async()=>{S(!0),P(null);try{console.log("TCC_DEBUG: Starting return trip analysis...");const I=localStorage.getItem("token"),d="https://api.tcc-production.com";if(!I)throw new Error("No authentication token found");const E=await fetch(`${d}/api/optimize/return-trips`,{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});if(!E.ok)throw new Error(`Failed to fetch return trips: ${E.statusText}`);const z=await E.json();if(console.log("TCC_DEBUG: Return trips response:",z),z.success){const Q={success:!0,data:{pairs:z.data.returnTrips||[],statistics:z.data.statistics||{},recommendations:z.data.recommendations||[]}};p(Q)}else throw new Error(z.error||"Failed to load return trips")}catch(I){P("Failed to analyze return trip opportunities"),console.error("TCC_DEBUG: Return trip analysis error:",I)}finally{S(!1)}},X=I=>{h(d=>d.includes(I)?d.filter(E=>E!==I):[...d,I])};return t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"System Route Optimization"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Optimize routes across all agencies and units in the system."})]}),t("div",{className:"flex space-x-3",children:[t("button",{onClick:()=>w(!D),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e(We,{className:"h-4 w-4 mr-2"}),"Settings"]}),t("button",{onClick:ee,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e(xe,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),D&&t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Optimization Settings"}),t("div",{className:"mb-6",children:[e("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Auto-Optimization"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[t("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Auto-optimize every ",M.refreshInterval," seconds"]}),e("input",{type:"checkbox",checked:M.autoOptimize,onChange:I=>C(d=>({...d,autoOptimize:I.target.checked})),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Refresh Interval (seconds)"}),e("input",{type:"number",value:M.refreshInterval,onChange:I=>C(d=>({...d,refreshInterval:parseInt(I.target.value)||30})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",min:"10",max:"300"})]})]})]}),t("div",{className:"mb-6",children:[e("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Optimization Weights"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deadhead Miles Weight"}),e("input",{type:"number",step:"0.1",value:M.weights.deadheadMiles,onChange:I=>C(d=>({...d,weights:{...d.weights,deadheadMiles:parseFloat(I.target.value)||.5}})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",min:"0",max:"2"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wait Time Weight"}),e("input",{type:"number",step:"0.1",value:M.weights.waitTime,onChange:I=>C(d=>({...d,weights:{...d.weights,waitTime:parseFloat(I.target.value)||.1}})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",min:"0",max:"1"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Backhaul Bonus ($)"}),e("input",{type:"number",step:"5",value:M.weights.backhaulBonus,onChange:I=>C(d=>({...d,weights:{...d.weights,backhaulBonus:parseFloat(I.target.value)||25}})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",min:"0",max:"100"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Overtime Risk Weight"}),e("input",{type:"number",step:"0.5",value:M.weights.overtimeRisk,onChange:I=>C(d=>({...d,weights:{...d.weights,overtimeRisk:parseFloat(I.target.value)||2}})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",min:"0",max:"5"})]})]})]}),t("div",{className:"mb-6",children:[e("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Constraints"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Deadhead Miles"}),e("input",{type:"number",value:M.constraints.maxDeadheadMiles,onChange:I=>C(d=>({...d,constraints:{...d.constraints,maxDeadheadMiles:parseInt(I.target.value)||50}})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",min:"10",max:"200"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Wait Time (minutes)"}),e("input",{type:"number",value:M.constraints.maxWaitTime,onChange:I=>C(d=>({...d,constraints:{...d.constraints,maxWaitTime:parseInt(I.target.value)||120}})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",min:"30",max:"300"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Overtime Hours"}),e("input",{type:"number",value:M.constraints.maxOvertimeHours,onChange:I=>C(d=>({...d,constraints:{...d.constraints,maxOvertimeHours:parseInt(I.target.value)||2}})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",min:"0",max:"8"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Backhaul Distance (miles)"}),e("input",{type:"number",value:M.constraints.maxBackhaulDistance,onChange:I=>C(d=>({...d,constraints:{...d.constraints,maxBackhaulDistance:parseInt(I.target.value)||15}})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",min:"5",max:"50"})]})]})]}),e("div",{className:"flex justify-end",children:t("button",{onClick:()=>{localStorage.setItem("tcc_optimization_settings",JSON.stringify(M)),w(!1)},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700",children:[e(We,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Select Unit"}),k?t("div",{className:"flex items-center justify-center py-8",children:[e(xe,{className:"h-6 w-6 animate-spin text-orange-600"}),e("span",{className:"ml-2 text-gray-600",children:"Loading units..."})]}):t("select",{value:a,onChange:I=>r(I.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e("option",{value:"",children:"Select a unit..."}),s&&s.length>0?s.map(I=>t("option",{value:I.id,children:[I.unitNumber||"Unknown"," (",I.type||"Unknown",") - ",I.currentStatus||"Unknown"]},I.id)):e("option",{disabled:!0,children:"No units available"})]})]}),t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Select Requests"}),F?t("div",{className:"flex items-center justify-center py-8",children:[e(xe,{className:"h-6 w-6 animate-spin text-orange-600"}),e("span",{className:"ml-2 text-gray-600",children:"Loading requests..."})]}):e("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:i&&i.length>0?i.map(I=>t("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:l.includes(I.id),onChange:()=>X(I.id),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),t("span",{className:"ml-2 text-sm text-gray-700",children:[I.patientId||"Unknown"," - ",I.originFacilityId||"Unknown"," \u2192 ",I.destinationFacilityId||"Unknown"]})]},I.id)):e("p",{className:"text-sm text-gray-500",children:"No pending requests available"})})]})]}),t("div",{className:"flex space-x-4",children:[t("button",{onClick:L,disabled:u||!a||l.length===0,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[u?e(xe,{className:"h-4 w-4 mr-2 animate-spin"}):e(wa,{className:"h-4 w-4 mr-2"}),"Optimize Routes"]}),t("button",{onClick:B,disabled:u||l.length<2,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(la,{className:"h-4 w-4 mr-2"}),"Analyze Backhaul"]}),t("button",{onClick:H,disabled:u,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(wa,{className:"h-4 w-4 mr-2"}),"Find Return Trips"]})]}),W&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(he,{className:"h-5 w-5 text-red-400"}),t("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e("div",{className:"mt-2 text-sm text-red-700",children:e("p",{children:W})})]})]})}),N&&N.success&&N.data&&t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Optimization Results"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{className:"bg-gray-50 rounded-lg p-4",children:[t("div",{className:"flex items-center",children:[e(pe,{className:"h-5 w-5 text-green-600"}),e("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Total Revenue"})]}),t("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:["$",typeof N.data.totalRevenue=="number"?N.data.totalRevenue.toFixed(2):"0.00"]})]}),t("div",{className:"bg-gray-50 rounded-lg p-4",children:[t("div",{className:"flex items-center",children:[e(Re,{className:"h-5 w-5 text-blue-600"}),e("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Total Distance"})]}),t("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:[typeof N.data.totalDeadheadMiles=="number"?N.data.totalDeadheadMiles.toFixed(1):"0.0"," mi"]})]}),t("div",{className:"bg-gray-50 rounded-lg p-4",children:[t("div",{className:"flex items-center",children:[e(fe,{className:"h-5 w-5 text-orange-600"}),e("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Total Wait Time"})]}),t("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:[typeof N.data.totalWaitTime=="number"?N.data.totalWaitTime.toFixed(0):"0"," min"]})]})]}),N.data.optimizedRequests&&N.data.optimizedRequests.length>0&&t("div",{className:"mt-6",children:[e("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Optimized Requests"}),e("div",{className:"space-y-2",children:N.data.optimizedRequests.map((I,d)=>t("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[t("div",{children:[t("span",{className:"text-sm font-medium text-gray-900",children:["Request ",d+1]}),t("span",{className:"text-sm text-gray-500 ml-2",children:["Score: ",typeof I.score=="number"?I.score.toFixed(2):"0.00"]})]}),t("div",{className:"text-sm text-gray-600",children:["Revenue: $",typeof I.revenue=="number"?I.revenue.toFixed(2):"0.00"," | Deadhead: ",typeof I.deadheadMiles=="number"?I.deadheadMiles.toFixed(1):"0.0"," mi"]})]},d))})]})]}),m&&m.success&&m.data&&t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Backhaul Analysis"}),t("div",{className:"space-y-4",children:[m.data.pairs&&m.data.pairs.map((I,d)=>{var E,z;return e("div",{className:"border rounded-lg p-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[t("p",{className:"text-sm font-medium text-gray-900",children:[((E=I.request1)==null?void 0:E.patientId)||"Unknown"," \u2192 ",((z=I.request2)==null?void 0:z.patientId)||"Unknown"]}),t("p",{className:"text-sm text-gray-500",children:["Potential savings: $",typeof I.revenueBonus=="number"?I.revenueBonus.toFixed(2):"0.00"]}),t("p",{className:"text-xs text-gray-400",children:["Distance: ",typeof I.distance=="number"?I.distance.toFixed(1):"0.0"," mi | Time Window: ",I.timeWindow||"0"," min | Efficiency: ",typeof I.efficiency=="number"?(I.efficiency*100).toFixed(1):"0.0","%"]})]}),e(re,{className:"h-5 w-5 text-green-500"})]})},d)}),(!m.data.pairs||m.data.pairs.length===0)&&e("p",{className:"text-sm text-gray-500 text-center py-4",children:"No backhaul opportunities found"})]})]}),t("div",{className:"bg-white rounded-lg shadow p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"System Performance Analytics"}),_?t("div",{className:"flex items-center justify-center py-8",children:[e(xe,{className:"h-6 w-6 animate-spin text-orange-600"}),e("span",{className:"ml-2 text-gray-600",children:"Loading analytics..."})]}):t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[x&&x.success&&x.data&&t("div",{children:[e("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"System Revenue (24h)"}),t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-600",children:"Total Revenue:"}),t("span",{className:"text-sm font-medium",children:["$",typeof x.data.totalRevenue=="number"?x.data.totalRevenue.toFixed(2):"0.00"]})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-600",children:"Revenue per Hour:"}),t("span",{className:"text-sm font-medium",children:["$",typeof x.data.revenuePerHour=="number"?x.data.revenuePerHour.toFixed(2):"0.00"]})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-600",children:"Loaded Mile Ratio:"}),t("span",{className:"text-sm font-medium",children:[typeof x.data.loadedMileRatio=="number"?(x.data.loadedMileRatio*100).toFixed(1):"0.0","%"]})]})]})]}),c&&c.success&&c.data&&t("div",{children:[e("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"System Performance (24h)"}),t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-600",children:"Total Trips:"}),e("span",{className:"text-sm font-medium",children:c.data.totalTrips||0})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-600",children:"Average Response Time:"}),t("span",{className:"text-sm font-medium",children:[typeof c.data.averageResponseTime=="number"?c.data.averageResponseTime.toFixed(1):"0.0"," min"]})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-600",children:"Efficiency:"}),t("span",{className:"text-sm font-medium",children:[typeof c.data.efficiency=="number"?(c.data.efficiency*100).toFixed(1):"0.0","%"]})]})]})]})]})]})]})},Ka=({showBackhaulPairs:a=!0,showUnitManagement:r=!0,title:s="Revenue Optimization",className:n=""})=>{const[i,o]=g.exports.useState(null),[l,h]=g.exports.useState([]),[,N]=g.exports.useState([]),[y,m]=g.exports.useState(null),[p,x]=g.exports.useState(!0);g.exports.useEffect(()=>{f()},[]);const f=async()=>{try{x(!0);const c=await fetch("/api/optimize/revenue?timeframe=24h");if(c.ok){const S=await c.json();S.success&&o({totalRevenue:S.data.totalRevenue||0,revenuePerHour:S.data.revenuePerHour||0,loadedMileRatio:S.data.loadedMileRatio||0,backhaulPairs:0,averageEfficiency:.75,potentialRevenueIncrease:0,totalTrips:S.data.totalTrips||0,averageRevenuePerTrip:S.data.averageRevenuePerTrip||0,totalMiles:S.data.totalMiles||0,loadedMiles:S.data.loadedMiles||0})}const b=await fetch("/api/optimize/backhaul");if(b.ok){const S=await b.json();S.success&&(h(S.data.pairs||[]),o(k=>{var O,F;return k?{...k,backhaulPairs:((O=S.data.pairs)==null?void 0:O.length)||0,potentialRevenueIncrease:((F=S.data.pairs)==null?void 0:F.reduce((U,_)=>U+(_.revenueBonus||0),0))||0}:null}))}const u=localStorage.getItem("token");if(u){const S={Authorization:`Bearer ${u}`,"Content-Type":"application/json"},k=await fetch("/api/units",{headers:S});if(k.ok){const F=await k.json();F.success&&N(F.data||[])}const O=await fetch("/api/units/analytics",{headers:S});if(O.ok){const F=await O.json();F.success&&m(F.data)}}}catch(c){console.error("Error loading optimization data:",c)}finally{x(!1)}};return p?e("div",{className:`bg-white rounded-lg p-6 shadow-sm ${n}`,children:t("div",{className:"animate-pulse",children:[e("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),t("div",{className:"space-y-3",children:[e("div",{className:"h-3 bg-gray-200 rounded"}),e("div",{className:"h-3 bg-gray-200 rounded w-3/4"}),e("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})}):t("div",{className:`space-y-6 ${n}`,children:[t("div",{className:"flex items-center justify-between",children:[e("h2",{className:"text-2xl font-bold text-gray-900",children:s}),t("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e(Se,{className:"h-4 w-4"}),t("span",{children:["Last updated: ",new Date().toLocaleTimeString()]})]})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-semibold text-gray-900",children:"Revenue Analytics"}),e(pe,{className:"h-6 w-6 text-green-600"})]}),i&&t("div",{className:"space-y-3",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Total Revenue:"}),t("span",{className:"text-lg font-semibold text-gray-900",children:["$",i.totalRevenue.toFixed(2)]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Revenue/Hour:"}),t("span",{className:"text-sm font-medium text-gray-900",children:["$",i.revenuePerHour.toFixed(2)]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Loaded Mile Ratio:"}),t("span",{className:"text-sm font-medium text-gray-900",children:[(i.loadedMileRatio*100).toFixed(1),"%"]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Total Trips:"}),e("span",{className:"text-sm font-medium text-gray-900",children:i.totalTrips})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Avg Revenue/Trip:"}),t("span",{className:"text-sm font-medium text-gray-900",children:["$",i.averageRevenuePerTrip.toFixed(2)]})]})]})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-semibold text-gray-900",children:"Backhaul Opportunities"}),e(Ca,{className:"h-6 w-6 text-blue-600"})]}),i&&t("div",{className:"space-y-3",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Available Pairs:"}),e("span",{className:"text-lg font-semibold text-gray-900",children:i.backhaulPairs})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Avg Efficiency:"}),t("span",{className:"text-sm font-medium text-gray-900",children:[(i.averageEfficiency*100).toFixed(1),"%"]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Potential Increase:"}),t("span",{className:"text-sm font-medium text-green-600",children:["+$",i.potentialRevenueIncrease.toFixed(2)]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Total Miles:"}),t("span",{className:"text-sm font-medium text-gray-900",children:[i.totalMiles.toFixed(1)," mi"]})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Loaded Miles:"}),t("span",{className:"text-sm font-medium text-gray-900",children:[i.loadedMiles.toFixed(1)," mi"]})]})]})]}),r&&t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-semibold text-gray-900",children:"Unit Management"}),e(Se,{className:"h-6 w-6 text-purple-600"})]}),t("div",{className:"space-y-3",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Available Units:"}),e("span",{className:"text-lg font-semibold text-green-600",children:(y==null?void 0:y.availableUnits)||0})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Committed Units:"}),e("span",{className:"text-sm font-medium text-yellow-600",children:(y==null?void 0:y.committedUnits)||0})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Total Units:"}),e("span",{className:"text-sm font-medium text-gray-900",children:(y==null?void 0:y.totalUnits)||0})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Out of Service:"}),e("span",{className:"text-sm font-medium text-red-600",children:(y==null?void 0:y.outOfServiceUnits)||0})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Efficiency:"}),e("span",{className:"text-sm font-medium text-gray-900",children:y!=null&&y.efficiency?`${(y.efficiency*100).toFixed(1)}%`:"0%"})]})]})]})]}),a&&l.length>0&&t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-semibold text-gray-900",children:"Recommended Backhaul Pairs"}),e(la,{className:"h-5 w-5 text-blue-600"})]}),e("div",{className:"space-y-4",children:l.slice(0,5).map((c,b)=>{var u,S,k,O,F,U;return t("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[t("div",{className:"flex items-center justify-between mb-3",children:[t("div",{className:"flex items-center space-x-3",children:[e(Ca,{className:"h-5 w-5 text-blue-600"}),t("span",{className:"text-sm font-medium text-gray-900",children:["Pair #",b+1]}),t("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:["Efficiency: ",(c.efficiency*100).toFixed(1),"%"]})]}),t("span",{className:"text-sm font-semibold text-green-600",children:["+$",c.revenueBonus.toFixed(2)," bonus"]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[t("div",{className:"bg-white rounded p-3",children:[e("div",{className:"font-medium text-gray-900 mb-1",children:"Request 1"}),t("div",{children:["Patient: ",((u=c.request1)==null?void 0:u.patientId)||"N/A"]}),t("div",{children:["Level: ",((S=c.request1)==null?void 0:S.transportLevel)||"N/A"]}),t("div",{children:["Priority: ",((k=c.request1)==null?void 0:k.priority)||"N/A"]})]}),t("div",{className:"bg-white rounded p-3",children:[e("div",{className:"font-medium text-gray-900 mb-1",children:"Request 2"}),t("div",{children:["Patient: ",((O=c.request2)==null?void 0:O.patientId)||"N/A"]}),t("div",{children:["Level: ",((F=c.request2)==null?void 0:F.transportLevel)||"N/A"]}),t("div",{children:["Priority: ",((U=c.request2)==null?void 0:U.priority)||"N/A"]})]})]}),t("div",{className:"mt-3 flex items-center justify-between text-xs text-gray-500",children:[t("span",{children:["Distance: ",c.distance.toFixed(1)," mi"]}),t("span",{children:["Time Window: ",c.timeWindow," min"]})]})]},b)})})]}),t("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[t("div",{className:"flex items-center justify-between mb-4",children:[e("h3",{className:"text-lg font-semibold text-gray-900",children:"Performance Metrics"}),e(me,{className:"h-5 w-5 text-indigo-600"})]}),t("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t("div",{className:"text-center",children:[t("div",{className:"text-2xl font-bold text-gray-900",children:[i?(i.loadedMileRatio*100).toFixed(1):"0.0","%"]}),e("div",{className:"text-sm text-gray-600",children:"Loaded Mile Ratio"})]}),t("div",{className:"text-center",children:[t("div",{className:"text-2xl font-bold text-gray-900",children:["$",i?i.revenuePerHour.toFixed(0):"0","/hr"]}),e("div",{className:"text-sm text-gray-600",children:"Revenue per Hour"})]}),t("div",{className:"text-center",children:[e("div",{className:"text-2xl font-bold text-gray-900",children:i?i.totalTrips:0}),e("div",{className:"text-sm text-gray-600",children:"Total Trips"})]}),t("div",{className:"text-center",children:[e("div",{className:"text-2xl font-bold text-gray-900",children:l.length}),e("div",{className:"text-sm text-gray-600",children:"Backhaul Pairs"})]})]})]})]})},Qi=()=>{const[a,r]=g.exports.useState("overview"),[s,n]=g.exports.useState(null),[i,o]=g.exports.useState(null),[l,h]=g.exports.useState(!0),[N,y]=g.exports.useState(null),m=[{id:"overview",name:"System Overview",icon:me},{id:"revenue",name:"Revenue Optimization",icon:pe},{id:"revenue-settings",name:"Revenue Settings",icon:We},{id:"performance",name:"Performance",icon:Ne},{id:"units",name:"Unit Management",icon:Se}];g.exports.useEffect(()=>{p()},[]);const p=async()=>{var x,f,c,b;try{h(!0),y(null);const[u,S]=await Promise.all([Ve.getOverview(),Ve.getTrips()]);(x=u.data)!=null&&x.success&&n(u.data.data),(f=S.data)!=null&&f.success&&o(S.data.data)}catch(u){console.error("Error loading analytics data:",u),y(((b=(c=u.response)==null?void 0:c.data)==null?void 0:b.error)||"Failed to load analytics data")}finally{h(!1)}};return t("div",{children:[t("div",{className:"mb-8",children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"Analytics"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"View system-wide analytics, performance metrics, and revenue optimization across all agencies."})]}),e("div",{className:"border-b border-gray-200 mb-6",children:e("nav",{className:"-mb-px flex space-x-8",children:m.map(x=>{const f=x.icon;return t("button",{onClick:()=>r(x.id),className:`${a===x.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2`,children:[e(f,{className:"h-4 w-4"}),e("span",{children:x.name})]},x.id)})})}),a==="overview"&&e("div",{className:"space-y-6",children:l?e("div",{className:"flex items-center justify-center h-64",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):N?e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e("div",{className:"text-red-800",children:N})}):t(se,{children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(me,{className:"h-6 w-6 text-blue-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Healthcare Facilities"}),t("dd",{className:"text-lg font-medium text-gray-900",children:[(s==null?void 0:s.totalHospitals)||0,t("span",{className:"text-sm text-green-600 ml-2",children:["(",(s==null?void 0:s.activeHospitals)||0," active)"]})]})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(Se,{className:"h-6 w-6 text-green-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"EMS Agencies"}),t("dd",{className:"text-lg font-medium text-gray-900",children:[(s==null?void 0:s.totalAgencies)||0,t("span",{className:"text-sm text-green-600 ml-2",children:["(",(s==null?void 0:s.activeAgencies)||0," active)"]})]})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(Ne,{className:"h-6 w-6 text-purple-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"EMS Units"}),t("dd",{className:"text-lg font-medium text-gray-900",children:[(s==null?void 0:s.totalUnits)||0,t("span",{className:"text-sm text-green-600 ml-2",children:["(",(s==null?void 0:s.activeUnits)||0," active)"]})]})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(pe,{className:"h-6 w-6 text-orange-600"})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Trips"}),t("dd",{className:"text-lg font-medium text-gray-900",children:[(i==null?void 0:i.totalTrips)||0,t("span",{className:"text-sm text-blue-600 ml-2",children:["(",(i==null?void 0:i.pendingTrips)||0," pending)"]})]})]})})]})})})]}),i&&t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Trips by Transport Level"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"BLS"}),e("span",{className:"text-sm font-medium text-gray-900",children:i.tripsByLevel.BLS})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"ALS"}),e("span",{className:"text-sm font-medium text-gray-900",children:i.tripsByLevel.ALS})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"CCT"}),e("span",{className:"text-sm font-medium text-gray-900",children:i.tripsByLevel.CCT})]})]})]}),t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Trips by Priority"}),t("div",{className:"space-y-3",children:[t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Low"}),e("span",{className:"text-sm font-medium text-gray-900",children:i.tripsByPriority.LOW})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Medium"}),e("span",{className:"text-sm font-medium text-gray-900",children:i.tripsByPriority.MEDIUM})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"High"}),e("span",{className:"text-sm font-medium text-gray-900",children:i.tripsByPriority.HIGH})]}),t("div",{className:"flex justify-between items-center",children:[e("span",{className:"text-sm text-gray-600",children:"Urgent"}),e("span",{className:"text-sm font-medium text-gray-900",children:i.tripsByPriority.URGENT})]})]})]})]})]})}),a==="revenue"&&e(Ka,{showBackhaulPairs:!0,showUnitManagement:!0,title:"Revenue Optimization Analytics"}),a==="revenue-settings"&&e(Lr,{}),a==="performance"&&t("div",{className:"bg-white shadow rounded-lg p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Performance Metrics"}),t("div",{className:"text-center py-8",children:[e(Ne,{className:"mx-auto h-12 w-12 text-gray-400"}),e("h4",{className:"mt-2 text-sm font-medium text-gray-900",children:"Performance Dashboard"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Performance metrics and historical data will be displayed here."})]})]}),a==="units"&&e(Ka,{showBackhaulPairs:!1,showUnitManagement:!0,title:"Unit Management Analytics"})]})},en=({data:a,onClose:r,onDownload:s,onShare:n})=>{const i=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(m),o=m=>`${m.toFixed(1)}%`,l=m=>m>=20?"text-green-600":m>=10?"text-yellow-600":"text-red-600",N=(()=>{const m=[],p=["Jan","Feb","Mar","Apr","May","Jun"];for(let x=0;x<p.length;x++){const f=a.totalRevenue*.8+x*a.totalRevenue*.1+Math.random()*a.totalRevenue*.1,c=a.totalCost*.8+x*a.totalCost*.1+Math.random()*a.totalCost*.1;m.push({month:p[x],revenue:Math.round(f),cost:Math.round(c),profit:Math.round(f-c)})}return m})(),y=[{name:"Crew Labor",value:a.totalCost*.35,color:"#8884d8"},{name:"Vehicle",value:a.totalCost*.25,color:"#82ca9d"},{name:"Fuel",value:a.totalCost*.15,color:"#ffc658"},{name:"Maintenance",value:a.totalCost*.12,color:"#ff7300"},{name:"Overhead",value:a.totalCost*.13,color:"#8dd1e1"}];return t("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200",children:[e("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-t-lg",children:t("div",{className:"flex justify-between items-start",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold",children:"Financial Summary Report"}),t("p",{className:"text-blue-100 mt-1",children:["Period: ",a.period," (",new Date(a.dateRange.start).toLocaleDateString()," - ",new Date(a.dateRange.end).toLocaleDateString(),")"]}),t("p",{className:"text-blue-100 text-sm",children:["Generated: ",new Date(a.generatedAt).toLocaleString()]})]}),t("div",{className:"flex space-x-2",children:[e("button",{onClick:n,className:"p-2 bg-blue-500 hover:bg-blue-400 rounded-md transition-colors",title:"Share Report",children:e(Je,{className:"h-5 w-5"})}),e("button",{onClick:s,className:"p-2 bg-blue-500 hover:bg-blue-400 rounded-md transition-colors",title:"Download Report",children:e(ze,{className:"h-5 w-5"})}),e("button",{onClick:r,className:"p-2 bg-red-500 hover:bg-red-400 rounded-md transition-colors",title:"Close Report",children:e(we,{className:"h-5 w-5"})})]})]})}),t("div",{className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:t("div",{className:"flex items-center",children:[e(pe,{className:"h-8 w-8 text-green-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-green-700",children:"Total Revenue"}),e("p",{className:"text-2xl font-semibold text-green-900",children:i(a.totalRevenue)})]})]})}),e("div",{className:"bg-red-50 p-6 rounded-lg border border-red-200",children:t("div",{className:"flex items-center",children:[e(lt,{className:"h-8 w-8 text-red-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-red-700",children:"Total Costs"}),e("p",{className:"text-2xl font-semibold text-red-900",children:i(a.totalCost)})]})]})}),e("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:t("div",{className:"flex items-center",children:[e(Ne,{className:"h-8 w-8 text-blue-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-blue-700",children:"Gross Profit"}),e("p",{className:"text-2xl font-semibold text-blue-900",children:i(a.grossProfit)})]})]})}),e("div",{className:"bg-purple-50 p-6 rounded-lg border border-purple-200",children:t("div",{className:"flex items-center",children:[e(me,{className:"h-8 w-8 text-purple-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-purple-700",children:"Profit Margin"}),e("p",{className:`text-2xl font-semibold ${l(a.averageProfitMargin)}`,children:o(a.averageProfitMargin)})]})]})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center",children:[e(ie,{className:"h-6 w-6 text-gray-600"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Total Trips"}),e("p",{className:"text-xl font-semibold text-gray-900",children:a.totalTrips.toLocaleString()})]})]})}),e("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center",children:[e(Re,{className:"h-6 w-6 text-gray-600"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Revenue per Mile"}),e("p",{className:"text-xl font-semibold text-gray-900",children:i(a.averageRevenuePerMile)})]})]})}),e("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center",children:[e(fe,{className:"h-6 w-6 text-gray-600"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Utilization Rate"}),e("p",{className:"text-xl font-semibold text-gray-900",children:o(a.averageUtilizationRate*100)})]})]})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue vs Cost Trend"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(oa,{data:N,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"month"}),e(Te,{tickFormatter:m=>`$${(m/1e3).toFixed(0)}k`}),e(be,{formatter:m=>[i(m),""],labelFormatter:m=>`Month: ${m}`}),e(et,{type:"monotone",dataKey:"revenue",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Revenue"}),e(et,{type:"monotone",dataKey:"cost",stackId:"2",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6,name:"Cost"})]})})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost Breakdown"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(ct,{children:[e(dt,{data:y,cx:"50%",cy:"50%",labelLine:!1,label:({name:m,percent:p})=>`${m} ${(p*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:y.map((m,p)=>e(mt,{fill:m.color},`cell-${p}`))}),e(be,{formatter:m=>[i(m),"Cost"]})]})})})]}),t("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Summary Statistics"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Financial Performance"}),t("ul",{className:"space-y-1 text-sm text-gray-600",children:[t("li",{children:["\u2022 Average Revenue per Trip: ",i(a.totalRevenue/a.totalTrips)]}),t("li",{children:["\u2022 Average Cost per Trip: ",i(a.totalCost/a.totalTrips)]}),t("li",{children:["\u2022 Average Profit per Trip: ",i(a.grossProfit/a.totalTrips)]}),t("li",{children:["\u2022 Cost per Mile: ",i(a.averageCostPerMile)]})]})]}),t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Operational Metrics"}),t("ul",{className:"space-y-1 text-sm text-gray-600",children:[t("li",{children:["\u2022 Total Trips Completed: ",a.totalTrips.toLocaleString()]}),t("li",{children:["\u2022 Average Revenue per Mile: ",i(a.averageRevenuePerMile)]}),t("li",{children:["\u2022 Utilization Rate: ",o(a.averageUtilizationRate*100)]}),t("li",{children:["\u2022 Profit Margin: ",o(a.averageProfitMargin)]})]})]})]})]})]})]})},tn=({data:a,onClose:r,onDownload:s,onShare:n})=>{const i=u=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(u),o=u=>`${u.toFixed(1)}%`,l=u=>u>=20?"text-green-600":u>=10?"text-yellow-600":"text-red-600",h=u=>u>=20?"bg-green-100":u>=10?"bg-yellow-100":"bg-red-100",N=u=>{switch(u){case"URGENT":return"text-red-600 bg-red-100";case"HIGH":return"text-orange-600 bg-orange-100";case"MEDIUM":return"text-yellow-600 bg-yellow-100";case"LOW":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},y=u=>{switch(u){case"BLS":return"text-blue-600 bg-blue-100";case"ALS":return"text-purple-600 bg-purple-100";case"CCT":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},m=Object.entries(a.tripsByTransportLevel).map(([u,S])=>({level:u,revenue:S.revenue,cost:S.cost,profit:S.profit,margin:S.margin,count:S.count})),p=Object.entries(a.tripsByPriority).map(([u,S])=>({priority:u,revenue:S.revenue,cost:S.cost,profit:S.profit,margin:S.margin,count:S.count})),x=Object.entries(a.tripsByTransportLevel).map(([u,S])=>({name:u,value:S.revenue,color:u==="BLS"?"#3b82f6":u==="ALS"?"#8b5cf6":"#10b981"})),f=Object.entries(a.tripsByPriority).map(([u,S])=>({name:u,value:S.revenue,color:u==="URGENT"?"#ef4444":u==="HIGH"?"#f97316":u==="MEDIUM"?"#eab308":"#22c55e"})),c=Object.values(a.tripsByTransportLevel).reduce((u,S)=>u+S.revenue,0),b=Object.values(a.tripsByTransportLevel).reduce((u,S)=>u+S.count,0);return t("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200",children:[e("div",{className:"bg-gradient-to-r from-green-600 to-green-700 text-white p-6 rounded-t-lg",children:t("div",{className:"flex justify-between items-start",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold",children:"Revenue Analysis Report"}),t("p",{className:"text-green-100 mt-1",children:["Period: ",a.period," (",new Date(a.dateRange.start).toLocaleDateString()," - ",new Date(a.dateRange.end).toLocaleDateString(),")"]}),t("p",{className:"text-green-100 text-sm",children:["Generated: ",new Date(a.generatedAt).toLocaleString()]})]}),t("div",{className:"flex space-x-2",children:[e("button",{onClick:n,className:"p-2 bg-green-500 hover:bg-green-400 rounded-md transition-colors",title:"Share Report",children:e(Je,{className:"h-5 w-5"})}),e("button",{onClick:s,className:"p-2 bg-green-500 hover:bg-green-400 rounded-md transition-colors",title:"Download Report",children:e(ze,{className:"h-5 w-5"})}),e("button",{onClick:r,className:"p-2 bg-red-500 hover:bg-red-400 rounded-md transition-colors",title:"Close Report",children:e(we,{className:"h-5 w-5"})})]})]})}),t("div",{className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:t("div",{className:"flex items-center",children:[e(pe,{className:"h-8 w-8 text-green-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-green-700",children:"Total Revenue"}),e("p",{className:"text-2xl font-semibold text-green-900",children:i(c)})]})]})}),e("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:t("div",{className:"flex items-center",children:[e(ie,{className:"h-8 w-8 text-blue-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-blue-700",children:"Total Trips"}),e("p",{className:"text-2xl font-semibold text-blue-900",children:b.toLocaleString()})]})]})}),e("div",{className:"bg-purple-50 p-6 rounded-lg border border-purple-200",children:t("div",{className:"flex items-center",children:[e(me,{className:"h-8 w-8 text-purple-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-purple-700",children:"Avg Revenue/Mile"}),e("p",{className:"text-2xl font-semibold text-purple-900",children:i(a.averageRevenuePerMile)})]})]})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue by Transport Level"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(Rt,{data:m,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"level"}),e(Te,{tickFormatter:u=>`$${(u/1e3).toFixed(0)}k`}),e(be,{formatter:u=>[i(u),"Revenue"]}),e(Ie,{dataKey:"revenue",fill:"#10b981",name:"Revenue"}),e(Ie,{dataKey:"cost",fill:"#ef4444",name:"Cost"}),e(Ie,{dataKey:"profit",fill:"#3b82f6",name:"Profit"})]})})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue by Priority Level"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(Rt,{data:p,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"priority"}),e(Te,{tickFormatter:u=>`$${(u/1e3).toFixed(0)}k`}),e(be,{formatter:u=>[i(u),"Revenue"]}),e(Ie,{dataKey:"revenue",fill:"#10b981",name:"Revenue"}),e(Ie,{dataKey:"cost",fill:"#ef4444",name:"Cost"}),e(Ie,{dataKey:"profit",fill:"#3b82f6",name:"Profit"})]})})})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue Distribution by Transport Level"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(ct,{children:[e(dt,{data:x,cx:"50%",cy:"50%",labelLine:!1,label:({name:u,percent:S})=>`${u} ${(S*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:x.map((u,S)=>e(mt,{fill:u.color},`cell-${S}`))}),e(be,{formatter:u=>[i(u),"Revenue"]})]})})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue Distribution by Priority"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(ct,{children:[e(dt,{data:f,cx:"50%",cy:"50%",labelLine:!1,label:({name:u,percent:S})=>`${u} ${(S*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:f.map((u,S)=>e(mt,{fill:u.color},`cell-${S}`))}),e(be,{formatter:u=>[i(u),"Revenue"]})]})})})]})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Transport Level Breakdown"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trips"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Margin"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(u=>t("tr",{children:[e("td",{className:"px-4 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${y(u.level)}`,children:u.level})}),e("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:u.count}),e("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:i(u.revenue)}),e("td",{className:"px-4 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${h(u.margin)} ${l(u.margin)}`,children:o(u.margin)})})]},u.level))})]})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Priority Level Breakdown"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trips"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Margin"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(u=>t("tr",{children:[e("td",{className:"px-4 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${N(u.priority)}`,children:u.priority})}),e("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:u.count}),e("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:i(u.revenue)}),e("td",{className:"px-4 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${h(u.margin)} ${l(u.margin)}`,children:o(u.margin)})})]},u.priority))})]})})]})]}),t("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue Insights"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Top Performing Transport Level"}),t("p",{className:"text-sm text-gray-600",children:[Object.entries(a.tripsByTransportLevel).sort(([,u],[,S])=>S.revenue-u.revenue)[0][0]," generates the highest revenue at"," ",i(Object.entries(a.tripsByTransportLevel).sort(([,u],[,S])=>S.revenue-u.revenue)[0][1].revenue)]})]}),t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Top Performing Priority Level"}),t("p",{className:"text-sm text-gray-600",children:[Object.entries(a.tripsByPriority).sort(([,u],[,S])=>S.revenue-u.revenue)[0][0]," priority generates the highest revenue at"," ",i(Object.entries(a.tripsByPriority).sort(([,u],[,S])=>S.revenue-u.revenue)[0][1].revenue)]})]})]})]})]})]})},an=({data:a,onClose:r,onDownload:s,onShare:n})=>{const[i,o]=g.exports.useState("all"),[l,h]=g.exports.useState("all"),N=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(w),y=w=>`${w.toFixed(1)}%`,m=w=>w>=20?"text-green-600":w>=10?"text-yellow-600":"text-red-600",p=w=>w>=20?"bg-green-100":w>=10?"bg-yellow-100":"bg-red-100",x=w=>{switch(w){case"BLS":return"text-blue-600 bg-blue-100";case"ALS":return"text-purple-600 bg-purple-100";case"CCT":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},f=w=>{switch(w){case"URGENT":return"text-red-600 bg-red-100";case"HIGH":return"text-orange-600 bg-orange-100";case"MEDIUM":return"text-yellow-600 bg-yellow-100";case"LOW":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},c=a.tripCostBreakdowns.filter(w=>!(i!=="all"&&w.transportLevel!==i||l!=="all"&&w.priorityLevel!==l)),b=c.reduce((w,M)=>w+M.crewLaborCost,0),u=c.reduce((w,M)=>w+M.vehicleCost,0),S=c.reduce((w,M)=>w+M.fuelCost,0),k=c.reduce((w,M)=>w+M.maintenanceCost,0),O=c.reduce((w,M)=>w+M.overheadCost,0),F=[{name:"Crew Labor",value:b,color:"#8884d8"},{name:"Vehicle",value:u,color:"#82ca9d"},{name:"Fuel",value:S,color:"#ffc658"},{name:"Maintenance",value:k,color:"#ff7300"},{name:"Overhead",value:O,color:"#8dd1e1"}],U=c.reduce((w,M)=>(w[M.transportLevel]||(w[M.transportLevel]={totalCost:0,tripCount:0,averageCost:0}),w[M.transportLevel].totalCost+=M.totalCost,w[M.transportLevel].tripCount+=1,w),{});Object.keys(U).forEach(w=>{U[w].averageCost=U[w].totalCost/U[w].tripCount});const _=Object.entries(U).map(([w,M])=>({level:w,totalCost:M.totalCost,tripCount:M.tripCount,averageCost:M.averageCost})),W=c.sort((w,M)=>new Date(M.calculatedAt).getTime()-new Date(w.calculatedAt).getTime()).slice(0,10).reverse().map((w,M)=>({trip:`Trip ${M+1}`,totalCost:w.totalCost,crewLabor:w.crewLaborCost,vehicle:w.vehicleCost,fuel:w.fuelCost,maintenance:w.maintenanceCost,overhead:w.overheadCost})),P=[...new Set(a.tripCostBreakdowns.map(w=>w.transportLevel))],D=[...new Set(a.tripCostBreakdowns.map(w=>w.priorityLevel))];return t("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200",children:[e("div",{className:"bg-gradient-to-r from-red-600 to-red-700 text-white p-6 rounded-t-lg",children:t("div",{className:"flex justify-between items-start",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold",children:"Cost Analysis Report"}),t("p",{className:"text-red-100 mt-1",children:["Period: ",a.period," (",new Date(a.dateRange.start).toLocaleDateString()," - ",new Date(a.dateRange.end).toLocaleDateString(),")"]}),t("p",{className:"text-red-100 text-sm",children:["Generated: ",new Date(a.generatedAt).toLocaleString()]})]}),t("div",{className:"flex space-x-2",children:[e("button",{onClick:n,className:"p-2 bg-red-500 hover:bg-red-400 rounded-md transition-colors",title:"Share Report",children:e(Je,{className:"h-5 w-5"})}),e("button",{onClick:s,className:"p-2 bg-red-500 hover:bg-red-400 rounded-md transition-colors",title:"Download Report",children:e(ze,{className:"h-5 w-5"})}),e("button",{onClick:r,className:"p-2 bg-gray-500 hover:bg-gray-400 rounded-md transition-colors",title:"Close Report",children:e(we,{className:"h-5 w-5"})})]})]})}),t("div",{className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e("div",{className:"bg-red-50 p-6 rounded-lg border border-red-200",children:t("div",{className:"flex items-center",children:[e(lt,{className:"h-8 w-8 text-red-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-red-700",children:"Total Cost"}),e("p",{className:"text-2xl font-semibold text-red-900",children:N(a.totalCost)})]})]})}),e("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:t("div",{className:"flex items-center",children:[e(pe,{className:"h-8 w-8 text-blue-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-blue-700",children:"Avg Cost/Mile"}),e("p",{className:"text-2xl font-semibold text-blue-900",children:N(a.averageCostPerMile)})]})]})}),e("div",{className:"bg-purple-50 p-6 rounded-lg border border-purple-200",children:t("div",{className:"flex items-center",children:[e(ie,{className:"h-8 w-8 text-purple-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-purple-700",children:"Total Trips"}),e("p",{className:"text-2xl font-semibold text-purple-900",children:c.length.toLocaleString()})]})]})})]}),e("div",{className:"bg-gray-50 p-4 rounded-lg",children:t("div",{className:"flex items-center space-x-4",children:[e(Dt,{className:"h-5 w-5 text-gray-500"}),t("div",{className:"flex space-x-4",children:[t("select",{value:i,onChange:w=>o(w.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e("option",{value:"all",children:"All Transport Levels"}),P.map(w=>e("option",{value:w,children:w},w))]}),t("select",{value:l,onChange:w=>h(w.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e("option",{value:"all",children:"All Priorities"}),D.map(w=>e("option",{value:w,children:w},w))]})]})]})}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost Breakdown"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(ct,{children:[e(dt,{data:F,cx:"50%",cy:"50%",labelLine:!1,label:({name:w,percent:M})=>`${w} ${(M*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:F.map((w,M)=>e(mt,{fill:w.color},`cell-${M}`))}),e(be,{formatter:w=>[N(w),"Cost"]})]})})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost by Transport Level"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(Rt,{data:_,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"level"}),e(Te,{tickFormatter:w=>`$${(w/1e3).toFixed(0)}k`}),e(be,{formatter:w=>[N(w),"Cost"]}),e(Ie,{dataKey:"totalCost",fill:"#ef4444",name:"Total Cost"}),e(Ie,{dataKey:"averageCost",fill:"#f97316",name:"Average Cost per Trip"})]})})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Cost Trends (Last 10 Trips)"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(ca,{data:W,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"trip"}),e(Te,{tickFormatter:w=>`$${(w/1e3).toFixed(0)}k`}),e(be,{formatter:w=>[N(w),""]}),e(Be,{type:"monotone",dataKey:"totalCost",stroke:"#ef4444",strokeWidth:2,name:"Total Cost"}),e(Be,{type:"monotone",dataKey:"crewLabor",stroke:"#8884d8",strokeWidth:2,name:"Crew Labor"}),e(Be,{type:"monotone",dataKey:"vehicle",stroke:"#82ca9d",strokeWidth:2,name:"Vehicle"}),e(Be,{type:"monotone",dataKey:"fuel",stroke:"#ffc658",strokeWidth:2,name:"Fuel"}),e(Be,{type:"monotone",dataKey:"maintenance",stroke:"#ff7300",strokeWidth:2,name:"Maintenance"}),e(Be,{type:"monotone",dataKey:"overhead",stroke:"#8dd1e1",strokeWidth:2,name:"Overhead"})]})})})]}),a.costCenterBreakdown.length>0&&t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost Center Breakdown"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost Center"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trips"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Margin"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:a.costCenterBreakdown.map(w=>t("tr",{children:[e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:w.costCenterName}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:w.tripCount}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N(w.totalRevenue)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N(w.totalCost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N(w.grossProfit)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${p(w.profitMargin)} ${m(w.profitMargin)}`,children:y(w.profitMargin)})})]},w.costCenterId))})]})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Trip Cost Breakdowns"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip ID"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Cost"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Crew Labor"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vehicle"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fuel"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:c.slice(0,10).map(w=>t("tr",{children:[t("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[w.tripId.substring(0,8),"..."]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${x(w.transportLevel)}`,children:w.transportLevel})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f(w.priorityLevel)}`,children:w.priorityLevel})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N(w.totalCost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N(w.crewLaborCost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N(w.vehicleCost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N(w.fuelCost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(w.calculatedAt).toLocaleDateString()})]},w.id))})]})})]}),t("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost Analysis Summary"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Cost Breakdown"}),t("ul",{className:"space-y-1 text-sm text-gray-600",children:[t("li",{children:["\u2022 Crew Labor: ",N(b)," (",(b/a.totalCost*100).toFixed(1),"%)"]}),t("li",{children:["\u2022 Vehicle Costs: ",N(u)," (",(u/a.totalCost*100).toFixed(1),"%)"]}),t("li",{children:["\u2022 Fuel Costs: ",N(S)," (",(S/a.totalCost*100).toFixed(1),"%)"]}),t("li",{children:["\u2022 Maintenance: ",N(k)," (",(k/a.totalCost*100).toFixed(1),"%)"]}),t("li",{children:["\u2022 Overhead: ",N(O)," (",(O/a.totalCost*100).toFixed(1),"%)"]})]})]}),t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Key Metrics"}),t("ul",{className:"space-y-1 text-sm text-gray-600",children:[t("li",{children:["\u2022 Average Cost per Trip: ",N(a.totalCost/c.length)]}),t("li",{children:["\u2022 Average Cost per Mile: ",N(a.averageCostPerMile)]}),t("li",{children:["\u2022 Total Trips Analyzed: ",c.length.toLocaleString()]}),t("li",{children:["\u2022 Highest Cost Category: ",F.sort((w,M)=>M.value-w.value)[0].name]})]})]})]})]})]})]})},rn=({data:a,onClose:r,onDownload:s,onShare:n})=>{const i=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(c),o=c=>`${c.toFixed(1)}%`,l=c=>c>=20?"text-green-600":c>=10?"text-yellow-600":"text-red-600",h=c=>c>=20?"bg-green-100":c>=10?"bg-yellow-100":"bg-red-100",N=a.profitabilityAnalysis.monthlyBreakdown.map(c=>({...c,profitMargin:c.margin})),m=(()=>["Jan","Feb","Mar","Apr","May","Jun"].map((b,u)=>({month:b,revenue:a.profitabilityAnalysis.trends.revenue[u]||0,cost:a.profitabilityAnalysis.trends.cost[u]||0,profit:a.profitabilityAnalysis.trends.profit[u]||0,margin:a.profitabilityAnalysis.trends.margin[u]||0})))(),p=a.profitabilityAnalysis.monthlyBreakdown.reduce((c,b)=>c+b.margin,0)/a.profitabilityAnalysis.monthlyBreakdown.length,x=a.profitabilityAnalysis.monthlyBreakdown.reduce((c,b)=>b.margin>c.margin?b:c),f=a.profitabilityAnalysis.monthlyBreakdown.reduce((c,b)=>b.margin<c.margin?b:c);return t("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200",children:[e("div",{className:"bg-gradient-to-r from-purple-600 to-purple-700 text-white p-6 rounded-t-lg",children:t("div",{className:"flex justify-between items-start",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold",children:"Profitability Analysis Report"}),t("p",{className:"text-purple-100 mt-1",children:["Period: ",a.period," - ",a.profitabilityAnalysis.period]}),t("p",{className:"text-purple-100 text-sm",children:["Generated: ",new Date(a.generatedAt).toLocaleString()]})]}),t("div",{className:"flex space-x-2",children:[e("button",{onClick:n,className:"p-2 bg-purple-500 hover:bg-purple-400 rounded-md transition-colors",title:"Share Report",children:e(Je,{className:"h-5 w-5"})}),e("button",{onClick:s,className:"p-2 bg-purple-500 hover:bg-purple-400 rounded-md transition-colors",title:"Download Report",children:e(ze,{className:"h-5 w-5"})}),e("button",{onClick:r,className:"p-2 bg-gray-500 hover:bg-gray-400 rounded-md transition-colors",title:"Close Report",children:e(we,{className:"h-5 w-5"})})]})]})}),t("div",{className:"p-6 space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:t("div",{className:"flex items-center",children:[e(pe,{className:"h-8 w-8 text-green-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-green-700",children:"Total Revenue"}),e("p",{className:"text-2xl font-semibold text-green-900",children:i(a.profitabilityAnalysis.totalRevenue)})]})]})}),e("div",{className:"bg-red-50 p-6 rounded-lg border border-red-200",children:t("div",{className:"flex items-center",children:[e(Ne,{className:"h-8 w-8 text-red-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-red-700",children:"Total Cost"}),e("p",{className:"text-2xl font-semibold text-red-900",children:i(a.profitabilityAnalysis.totalCost)})]})]})}),e("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:t("div",{className:"flex items-center",children:[e(me,{className:"h-8 w-8 text-blue-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-blue-700",children:"Gross Profit"}),e("p",{className:"text-2xl font-semibold text-blue-900",children:i(a.profitabilityAnalysis.grossProfit)})]})]})}),e("div",{className:"bg-purple-50 p-6 rounded-lg border border-purple-200",children:t("div",{className:"flex items-center",children:[e(Et,{className:"h-8 w-8 text-purple-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-purple-700",children:"Profit Margin"}),e("p",{className:`text-2xl font-semibold ${l(a.profitabilityAnalysis.profitMargin)}`,children:o(a.profitabilityAnalysis.profitMargin)})]})]})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center",children:[e(ot,{className:"h-6 w-6 text-gray-600"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Total Trips"}),e("p",{className:"text-xl font-semibold text-gray-900",children:a.profitabilityAnalysis.tripCount.toLocaleString()})]})]})}),e("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center",children:[e(pe,{className:"h-6 w-6 text-gray-600"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Avg Revenue/Trip"}),e("p",{className:"text-xl font-semibold text-gray-900",children:i(a.profitabilityAnalysis.averageRevenuePerTrip)})]})]})}),e("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t("div",{className:"flex items-center",children:[e(Ne,{className:"h-6 w-6 text-gray-600"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Avg Cost/Trip"}),e("p",{className:"text-xl font-semibold text-gray-900",children:i(a.profitabilityAnalysis.averageCostPerTrip)})]})]})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Profitability Trends"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(ca,{data:m,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"month"}),e(Te,{yAxisId:"left"}),e(Te,{yAxisId:"right",orientation:"right"}),e(be,{formatter:(c,b)=>[b==="margin"?`${c}%`:i(c),b==="margin"?"Margin":b==="profit"?"Profit":b==="revenue"?"Revenue":"Cost"],labelFormatter:c=>`Month: ${c}`}),e(Be,{yAxisId:"left",type:"monotone",dataKey:"profit",stroke:"#3b82f6",strokeWidth:2,name:"Profit"}),e(Be,{yAxisId:"right",type:"monotone",dataKey:"margin",stroke:"#10b981",strokeWidth:2,name:"Margin %"})]})})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue vs Cost Analysis"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(oa,{data:m,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"month"}),e(Te,{tickFormatter:c=>`$${(c/1e3).toFixed(0)}k`}),e(be,{formatter:c=>[i(c),""],labelFormatter:c=>`Month: ${c}`}),e(et,{type:"monotone",dataKey:"revenue",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Revenue"}),e(et,{type:"monotone",dataKey:"cost",stackId:"2",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6,name:"Cost"})]})})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Monthly Profitability Breakdown"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(Rt,{data:N,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"month"}),e(Te,{yAxisId:"left"}),e(Te,{yAxisId:"right",orientation:"right"}),e(be,{formatter:(c,b)=>[b==="profitMargin"?`${c}%`:i(c),b==="profitMargin"?"Margin":b==="profit"?"Profit":b==="revenue"?"Revenue":"Cost"],labelFormatter:c=>`Month: ${c}`}),e(Ie,{yAxisId:"left",dataKey:"profit",fill:"#3b82f6",name:"Profit"}),e(Ie,{yAxisId:"right",dataKey:"profitMargin",fill:"#10b981",name:"Margin %"})]})})})]}),t("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Monthly Breakdown Details"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Month"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trips"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Margin"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:a.profitabilityAnalysis.monthlyBreakdown.map((c,b)=>t("tr",{children:[e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:c.month}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c.tripCount}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i(c.revenue)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i(c.cost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i(c.profit)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${h(c.margin)} ${l(c.margin)}`,children:o(c.margin)})})]},b))})]})})]}),t("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Performance Insights"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Best Performing Month"}),e("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:t("p",{className:"text-sm text-green-800",children:[e("strong",{children:x.month})," achieved the highest profit margin of"," ",e("span",{className:"font-semibold",children:o(x.margin)})," with"," ",e("span",{className:"font-semibold",children:i(x.profit)})," in profit from"," ",e("span",{className:"font-semibold",children:x.tripCount})," trips."]})})]}),t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Areas for Improvement"}),e("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:t("p",{className:"text-sm text-yellow-800",children:[e("strong",{children:f.month})," had the lowest profit margin of"," ",e("span",{className:"font-semibold",children:o(f.margin)}),". Consider analyzing cost drivers and revenue optimization strategies."]})})]})]}),t("div",{className:"mt-4",children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Overall Performance Summary"}),e("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:t("p",{className:"text-sm text-blue-800",children:["Average profit margin across all months: ",e("span",{className:"font-semibold",children:o(p)}),". Total profit generated: ",e("span",{className:"font-semibold",children:i(a.profitabilityAnalysis.grossProfit)})," from"," ",e("span",{className:"font-semibold",children:a.profitabilityAnalysis.tripCount})," trips over the period."]})})]})]})]})]})},sn=({data:a,onClose:r,onDownload:s,onShare:n})=>{const[i,o]=g.exports.useState(""),[l,h]=g.exports.useState("all"),[N,y]=g.exports.useState(new Set(["costAnalysis"])),[m,p]=g.exports.useState("csv"),x=U=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(U),f=U=>new Date(U).toLocaleString(),c=U=>{const _=new Set(N);_.has(U)?_.delete(U):_.add(U),y(_)},b=[{id:"all",name:"All Data",count:3,description:"Complete dataset including all analysis"},{id:"costAnalysis",name:"Cost Analysis",count:1,description:"Financial cost breakdown and metrics"},{id:"profitabilityAnalysis",name:"Profitability Analysis",count:1,description:"Profit margins and trends"},{id:"tripCostBreakdowns",name:"Trip Details",count:a.tripCostBreakdowns.length,description:"Individual trip cost breakdowns"}],u=b.filter(U=>U.name.toLowerCase().includes(i.toLowerCase())||U.description.toLowerCase().includes(i.toLowerCase())),S=U=>{switch(U){case"costAnalysis":return e(ka,{className:"h-5 w-5 text-blue-600"});case"profitabilityAnalysis":return e(He,{className:"h-5 w-5 text-green-600"});case"tripCostBreakdowns":return e(ot,{className:"h-5 w-5 text-purple-600"});default:return e(He,{className:"h-5 w-5 text-gray-600"})}},k=()=>a.costAnalysis?e("div",{className:"space-y-4",children:t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Financial Summary"}),t("ul",{className:"text-sm text-gray-600 space-y-1",children:[t("li",{children:["Total Revenue: ",x(a.costAnalysis.totalRevenue||0)]}),t("li",{children:["Total Cost: ",x(a.costAnalysis.totalCost||0)]}),t("li",{children:["Gross Profit: ",x(a.costAnalysis.grossProfit||0)]}),t("li",{children:["Profit Margin: ",(a.costAnalysis.averageProfitMargin||0).toFixed(1),"%"]})]})]}),t("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Operational Metrics"}),t("ul",{className:"text-sm text-gray-600 space-y-1",children:[t("li",{children:["Total Trips: ",(a.costAnalysis.totalTrips||0).toLocaleString()]}),t("li",{children:["Avg Revenue/Mile: ",x(a.costAnalysis.averageRevenuePerMile||0)]}),t("li",{children:["Avg Cost/Mile: ",x(a.costAnalysis.averageCostPerMile||0)]}),t("li",{children:["Utilization Rate: ",((a.costAnalysis.averageUtilizationRate||0)*100).toFixed(1),"%"]})]})]})]})}):e("p",{className:"text-gray-500",children:"No cost analysis data available"}),O=()=>{var U;return a.profitabilityAnalysis?e("div",{className:"space-y-4",children:t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Period Summary"}),t("ul",{className:"text-sm text-gray-600 space-y-1",children:[t("li",{children:["Period: ",a.profitabilityAnalysis.period||"N/A"]}),t("li",{children:["Total Revenue: ",x(a.profitabilityAnalysis.totalRevenue||0)]}),t("li",{children:["Total Cost: ",x(a.profitabilityAnalysis.totalCost||0)]}),t("li",{children:["Gross Profit: ",x(a.profitabilityAnalysis.grossProfit||0)]}),t("li",{children:["Profit Margin: ",(a.profitabilityAnalysis.profitMargin||0).toFixed(1),"%"]})]})]}),t("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Trip Metrics"}),t("ul",{className:"text-sm text-gray-600 space-y-1",children:[t("li",{children:["Trip Count: ",(a.profitabilityAnalysis.tripCount||0).toLocaleString()]}),t("li",{children:["Avg Revenue/Trip: ",x(a.profitabilityAnalysis.averageRevenuePerTrip||0)]}),t("li",{children:["Avg Cost/Trip: ",x(a.profitabilityAnalysis.averageCostPerTrip||0)]}),t("li",{children:["Monthly Breakdown: ",((U=a.profitabilityAnalysis.monthlyBreakdown)==null?void 0:U.length)||0," months"]})]})]})]})}):e("p",{className:"text-gray-500",children:"No profitability analysis data available"})},F=()=>!a.tripCostBreakdowns||a.tripCostBreakdowns.length===0?e("p",{className:"text-gray-500",children:"No trip cost breakdown data available"}):t("div",{className:"space-y-4",children:[t("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Trip Summary"}),t("p",{className:"text-sm text-gray-600",children:[a.tripCostBreakdowns.length," trip records available with detailed cost breakdowns"]})]}),t("div",{className:"overflow-x-auto",children:[t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Trip ID"}),e("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Level"}),e("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Priority"}),e("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Revenue"}),e("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Cost"}),e("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Profit"}),e("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:a.tripCostBreakdowns.slice(0,10).map((U,_)=>{var G;return t("tr",{children:[t("td",{className:"px-4 py-2 text-sm text-gray-900",children:[((G=U.tripId)==null?void 0:G.substring(0,8))||"N/A","..."]}),e("td",{className:"px-4 py-2 text-sm text-gray-900",children:U.transportLevel||"N/A"}),e("td",{className:"px-4 py-2 text-sm text-gray-900",children:U.priorityLevel||"N/A"}),e("td",{className:"px-4 py-2 text-sm text-gray-900",children:x(U.totalRevenue||0)}),e("td",{className:"px-4 py-2 text-sm text-gray-900",children:x(U.totalCost||0)}),e("td",{className:"px-4 py-2 text-sm text-gray-900",children:x(U.grossProfit||0)}),e("td",{className:"px-4 py-2 text-sm text-gray-900",children:U.calculatedAt?new Date(U.calculatedAt).toLocaleDateString():"N/A"})]},U.id||_)})})]}),a.tripCostBreakdowns.length>10&&t("p",{className:"text-sm text-gray-500 mt-2 text-center",children:["Showing first 10 of ",a.tripCostBreakdowns.length," records"]})]})]});return t("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200",children:[e("div",{className:"bg-gradient-to-r from-gray-600 to-gray-700 text-white p-6 rounded-t-lg",children:t("div",{className:"flex justify-between items-start",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold",children:"Data Export Report"}),e("p",{className:"text-gray-100 mt-1",children:"Comprehensive financial data export"}),t("p",{className:"text-gray-100 text-sm",children:["Generated: ",f(a.exportDate)]})]}),t("div",{className:"flex space-x-2",children:[e("button",{onClick:n,className:"p-2 bg-gray-500 hover:bg-gray-400 rounded-md transition-colors",title:"Share Report",children:e(Je,{className:"h-5 w-5"})}),e("button",{onClick:s,className:"p-2 bg-gray-500 hover:bg-gray-400 rounded-md transition-colors",title:"Download Report",children:e(ze,{className:"h-5 w-5"})}),e("button",{onClick:r,className:"p-2 bg-red-500 hover:bg-red-400 rounded-md transition-colors",title:"Close Report",children:e(we,{className:"h-5 w-5"})})]})]})}),t("div",{className:"p-6 space-y-6",children:[t("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Export Options"}),t("div",{className:"flex flex-col sm:flex-row gap-4",children:[e("div",{className:"flex-1",children:t("div",{className:"relative",children:[e(Mt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e("input",{type:"text",placeholder:"Search data types...",value:i,onChange:U=>o(U.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-gray-500 focus:border-gray-500"})]})}),t("div",{className:"flex items-center space-x-2",children:[e(Dt,{className:"h-4 w-4 text-gray-500"}),e("select",{value:l,onChange:U=>h(U.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:b.map(U=>e("option",{value:U.id,children:U.name},U.id))})]}),e("div",{className:"flex items-center space-x-2",children:t("select",{value:m,onChange:U=>p(U.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e("option",{value:"csv",children:"CSV"}),e("option",{value:"json",children:"JSON"}),e("option",{value:"xlsx",children:"Excel"})]})})]})]}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(U=>t("div",{className:"bg-white p-4 rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:[t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[S(U.id),t("div",{children:[e("h4",{className:"font-medium text-gray-900",children:U.name}),t("p",{className:"text-sm text-gray-500",children:[U.count," records"]})]})]}),e("span",{className:"text-xs text-gray-400",children:U.id})]}),e("p",{className:"text-sm text-gray-600 mt-2",children:U.description})]},U.id))}),t("div",{className:"space-y-4",children:[t("div",{className:"border border-gray-200 rounded-lg",children:[t("button",{onClick:()=>c("costAnalysis"),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors",children:[t("div",{className:"flex items-center space-x-3",children:[e(ka,{className:"h-5 w-5 text-blue-600"}),t("div",{children:[e("h3",{className:"font-medium text-gray-900",children:"Cost Analysis Data"}),e("p",{className:"text-sm text-gray-500",children:"Financial cost breakdown and metrics"})]})]}),N.has("costAnalysis")?e(nt,{className:"h-5 w-5 text-gray-400"}):e(Ze,{className:"h-5 w-5 text-gray-400"})]}),N.has("costAnalysis")&&e("div",{className:"px-6 pb-4 border-t border-gray-200",children:k()})]}),t("div",{className:"border border-gray-200 rounded-lg",children:[t("button",{onClick:()=>c("profitabilityAnalysis"),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors",children:[t("div",{className:"flex items-center space-x-3",children:[e(He,{className:"h-5 w-5 text-green-600"}),t("div",{children:[e("h3",{className:"font-medium text-gray-900",children:"Profitability Analysis Data"}),e("p",{className:"text-sm text-gray-500",children:"Profit margins and trends"})]})]}),N.has("profitabilityAnalysis")?e(nt,{className:"h-5 w-5 text-gray-400"}):e(Ze,{className:"h-5 w-5 text-gray-400"})]}),N.has("profitabilityAnalysis")&&e("div",{className:"px-6 pb-4 border-t border-gray-200",children:O()})]}),t("div",{className:"border border-gray-200 rounded-lg",children:[t("button",{onClick:()=>c("tripCostBreakdowns"),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors",children:[t("div",{className:"flex items-center space-x-3",children:[e(ot,{className:"h-5 w-5 text-purple-600"}),t("div",{children:[e("h3",{className:"font-medium text-gray-900",children:"Trip Cost Breakdowns"}),t("p",{className:"text-sm text-gray-500",children:[a.tripCostBreakdowns.length," individual trip records"]})]})]}),N.has("tripCostBreakdowns")?e(nt,{className:"h-5 w-5 text-gray-400"}):e(Ze,{className:"h-5 w-5 text-gray-400"})]}),N.has("tripCostBreakdowns")&&e("div",{className:"px-6 pb-4 border-t border-gray-200",children:F()})]})]}),t("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Export Summary"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Data Overview"}),t("ul",{className:"space-y-1 text-sm text-gray-600",children:[t("li",{children:["\u2022 Total Records: ",a.tripCostBreakdowns.length+2]}),e("li",{children:"\u2022 Data Types: 3 (Cost Analysis, Profitability, Trip Details)"}),t("li",{children:["\u2022 Export Format: ",m.toUpperCase()]}),t("li",{children:["\u2022 Generated: ",f(a.exportDate)]})]})]}),t("div",{children:[e("h4",{className:"font-medium text-gray-700 mb-2",children:"Export Actions"}),t("div",{className:"space-y-2",children:[t("button",{onClick:s,className:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[e(ze,{className:"h-4 w-4 mr-2"}),"Download ",m.toUpperCase()," Export"]}),t("button",{onClick:n,className:"w-full flex items-center justify-center px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:[e(Je,{className:"h-4 w-4 mr-2"}),"Share Export Link"]})]})]})]})]})]})]})},nn=()=>{const[a,r]=g.exports.useState("overview"),[s,n]=g.exports.useState(!0),[i,o]=g.exports.useState(null),[l,h]=g.exports.useState(null),[N,y]=g.exports.useState(null),[m,p]=g.exports.useState([]),[x,f]=g.exports.useState([]),[c,b]=g.exports.useState("month"),[u]=g.exports.useState({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),S=[{id:"overview",name:"Financial Overview",icon:me},{id:"revenue",name:"Revenue Analysis",icon:Ne},{id:"costs",name:"Cost Analysis",icon:lt},{id:"profitability",name:"Profitability",icon:Et},{id:"billing",name:"Reports",icon:He}];g.exports.useEffect(()=>{k()},[c,u]);const k=async()=>{var d,E,z,Q,K;try{n(!0),o(null);const[ce,ke,v]=await Promise.all([Ve.getCostAnalysis(u.start,u.end),Ve.getProfitability(c),Ve.getTripCostBreakdowns()]);(d=ce.data)!=null&&d.success&&h(ce.data.data),(E=ke.data)!=null&&E.success&&y(ke.data.data),(z=v.data)!=null&&z.success&&p(v.data.data)}catch(ce){console.error("Error loading financial data:",ce),o(((K=(Q=ce.response)==null?void 0:Q.data)==null?void 0:K.error)||"Failed to load financial data")}finally{n(!1)}},O=d=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(d),F=d=>`${d.toFixed(1)}%`,U=d=>d>=20?"text-green-600":d>=10?"text-yellow-600":"text-red-600",_=d=>d>=20?"bg-green-100":d>=10?"bg-yellow-100":"bg-red-100",G=()=>{if(!l){alert("No financial data available. Please refresh the data first.");return}const d={period:c,dateRange:u,totalRevenue:l.totalRevenue,totalCost:l.totalCost,grossProfit:l.grossProfit,averageProfitMargin:l.averageProfitMargin,totalTrips:l.totalTrips,averageRevenuePerMile:l.averageRevenuePerMile,averageCostPerMile:l.averageCostPerMile,averageUtilizationRate:l.averageUtilizationRate,generatedAt:new Date().toISOString()};M("financial-summary","Financial Summary Report",d)},W=()=>{if(!l){alert("No financial data available. Please refresh the data first.");return}const d={period:c,dateRange:u,tripsByTransportLevel:l.tripsByTransportLevel,tripsByPriority:l.tripsByPriority,averageRevenuePerMile:l.averageRevenuePerMile,generatedAt:new Date().toISOString()};M("revenue","Revenue Analysis Report",d)},P=()=>{if(!l){alert("No financial data available. Please refresh the data first.");return}const d={period:c,dateRange:u,totalCost:l.totalCost,averageCostPerMile:l.averageCostPerMile,costCenterBreakdown:l.costCenterBreakdown,tripCostBreakdowns:m.slice(0,50),generatedAt:new Date().toISOString()};M("cost","Cost Analysis Report",d)},D=()=>{if(!N){alert("No profitability data available. Please refresh the data first.");return}const d={period:c,profitabilityAnalysis:N,generatedAt:new Date().toISOString()};M("profitability","Profitability Analysis Report",d)},w=()=>{if(!l){alert("No financial data available. Please refresh the data first.");return}const d={costAnalysis:l,profitabilityAnalysis:N,tripCostBreakdowns:m.slice(0,100),exportDate:new Date().toISOString()};M("export-data","Financial Data Export",d)},M=(d,E,z)=>{const Q={id:`${d}-${Date.now()}`,type:d,name:E,data:z,generatedAt:new Date().toISOString(),isOpen:!0};f(K=>[Q,...K])},C=d=>{f(E=>E.map(z=>z.id===d?{...z,isOpen:!1}:z))},Z=d=>{f(E=>E.filter(z=>z.id!==d))},ee=d=>{const E=x.find(z=>z.id===d);if(!!E)try{let z,Q,K;E.type==="export-data"?(z=R(E.data),Q="text/csv",K="csv"):(z=JSON.stringify(E.data,null,2),Q="application/json",K="json");const ce=new Blob([z],{type:Q}),ke=window.URL.createObjectURL(ce),v=document.createElement("a");v.href=ke,v.download=`${E.name}_${new Date().toISOString().split("T")[0]}.${K}`,document.body.appendChild(v),v.click(),document.body.removeChild(v),window.URL.revokeObjectURL(ke)}catch(z){console.error("Error downloading report:",z),alert("Error downloading report. Please try again.")}},R=d=>{const E=[];return d.costAnalysis&&(E.push("=== COST ANALYSIS ==="),E.push("Metric,Value"),E.push(`Total Revenue,${d.costAnalysis.totalRevenue||0}`),E.push(`Total Cost,${d.costAnalysis.totalCost||0}`),E.push(`Gross Profit,${d.costAnalysis.grossProfit||0}`),E.push(`Average Profit Margin,${d.costAnalysis.averageProfitMargin||0}%`),E.push(`Total Trips,${d.costAnalysis.totalTrips||0}`),E.push(`Average Revenue per Mile,${d.costAnalysis.averageRevenuePerMile||0}`),E.push(`Average Cost per Mile,${d.costAnalysis.averageCostPerMile||0}`),E.push(`Average Utilization Rate,${d.costAnalysis.averageUtilizationRate||0}%`),E.push("")),d.profitabilityAnalysis&&(E.push("=== PROFITABILITY ANALYSIS ==="),E.push("Metric,Value"),E.push(`Period,${d.profitabilityAnalysis.period||"N/A"}`),E.push(`Total Revenue,${d.profitabilityAnalysis.totalRevenue||0}`),E.push(`Total Cost,${d.profitabilityAnalysis.totalCost||0}`),E.push(`Gross Profit,${d.profitabilityAnalysis.grossProfit||0}`),E.push(`Profit Margin,${d.profitabilityAnalysis.profitMargin||0}%`),E.push(`Trip Count,${d.profitabilityAnalysis.tripCount||0}`),E.push(`Average Revenue per Trip,${d.profitabilityAnalysis.averageRevenuePerTrip||0}`),E.push(`Average Cost per Trip,${d.profitabilityAnalysis.averageCostPerTrip||0}`),E.push("")),d.tripCostBreakdowns&&d.tripCostBreakdowns.length>0&&(E.push("=== TRIP COST BREAKDOWNS ==="),E.push("Trip ID,Transport Level,Priority,Total Revenue,Total Cost,Gross Profit,Profit Margin,Revenue per Mile,Cost per Mile,Calculated At"),d.tripCostBreakdowns.forEach(z=>{E.push([z.tripId||"N/A",z.transportLevel||"N/A",z.priorityLevel||"N/A",z.totalRevenue||0,z.totalCost||0,z.grossProfit||0,z.profitMargin||0,z.revenuePerMile||0,z.costPerMile||0,z.calculatedAt?new Date(z.calculatedAt).toISOString():"N/A"].join(","))})),E.join(`
`)},q=d=>{const E=x.find(z=>z.id===d);!E||alert(`Share link for ${E.name} would be generated here.`)},$=()=>{const d=[],E=["Jan","Feb","Mar","Apr","May","Jun"];for(let z=0;z<E.length;z++){const Q=5e4+z*5e3+Math.random()*1e4,K=35e3+z*3e3+Math.random()*8e3;d.push({month:E[z],revenue:Math.round(Q),cost:Math.round(K),profit:Math.round(Q-K)})}return d},L=()=>[{name:"Crew Labor",value:45e3,color:"#8884d8"},{name:"Vehicle",value:25e3,color:"#82ca9d"},{name:"Fuel",value:15e3,color:"#ffc658"},{name:"Maintenance",value:12e3,color:"#ff7300"},{name:"Overhead",value:18e3,color:"#8dd1e1"}],B=()=>{const d=[],E=["Jan","Feb","Mar","Apr","May","Jun"];for(let z=0;z<E.length;z++){const Q=15+z*2+Math.random()*5;d.push({month:E[z],margin:Math.round(Q*10)/10,profit:Math.round(2e4+z*3e3+Math.random()*5e3)})}return d},H=$(),X=L(),I=B();return s?e("div",{className:"flex items-center justify-center h-64",children:t("div",{className:"flex items-center space-x-2",children:[e(xe,{className:"h-5 w-5 animate-spin text-blue-600"}),e("span",{className:"text-gray-600",children:"Loading financial data..."})]})}):i?e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(he,{className:"h-5 w-5 text-red-400"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-red-800",children:i}),e("button",{onClick:k,className:"mt-2 text-sm text-red-600 hover:text-red-500 underline",children:"Try again"})]})]})}):t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"Financial Dashboard"}),e("p",{className:"text-gray-600",children:"Comprehensive financial analysis and reporting"})]}),t("div",{className:"flex items-center space-x-4",children:[t("select",{value:c,onChange:d=>b(d.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e("option",{value:"week",children:"Last Week"}),e("option",{value:"month",children:"Last Month"}),e("option",{value:"quarter",children:"Last Quarter"}),e("option",{value:"year",children:"Last Year"})]}),t("button",{onClick:k,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:[e(xe,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e("div",{className:"border-b border-gray-200",children:e("nav",{className:"-mb-px flex space-x-8",children:S.map(d=>e("button",{onClick:()=>r(d.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${a===d.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:t("div",{className:"flex items-center",children:[e(d.icon,{className:"h-4 w-4 mr-2"}),d.name]})},d.id))})}),a==="overview"&&t("div",{className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(pe,{className:"h-8 w-8 text-green-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Total Revenue"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:l?O(l.totalRevenue):"$0.00"})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(lt,{className:"h-8 w-8 text-red-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Total Costs"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:l?O(l.totalCost):"$0.00"})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(Ne,{className:"h-8 w-8 text-blue-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Gross Profit"}),e("p",{className:"text-2xl font-semibold text-gray-900",children:l?O(l.grossProfit):"$0.00"})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(me,{className:"h-8 w-8 text-purple-600"}),t("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Profit Margin"}),e("p",{className:`text-2xl font-semibold ${U((l==null?void 0:l.averageProfitMargin)||0)}`,children:l?F(l.averageProfitMargin):"0.0%"})]})]})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(ie,{className:"h-6 w-6 text-gray-600"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Total Trips"}),e("p",{className:"text-xl font-semibold text-gray-900",children:(l==null?void 0:l.totalTrips)||0})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(Re,{className:"h-6 w-6 text-gray-600"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Revenue per Mile"}),e("p",{className:"text-xl font-semibold text-gray-900",children:l?O(l.averageRevenuePerMile):"$0.00"})]})]})}),e("div",{className:"bg-white p-6 rounded-lg shadow",children:t("div",{className:"flex items-center",children:[e(fe,{className:"h-6 w-6 text-gray-600"}),t("div",{className:"ml-3",children:[e("p",{className:"text-sm font-medium text-gray-500",children:"Utilization Rate"}),e("p",{className:"text-xl font-semibold text-gray-900",children:l?F(l.averageUtilizationRate*100):"0.0%"})]})]})})]}),t("div",{className:"bg-white p-6 rounded-lg shadow",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue vs Cost Trend"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(oa,{data:H,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"month"}),e(Te,{tickFormatter:d=>`$${(d/1e3).toFixed(0)}k`}),e(be,{formatter:d=>[O(d),""],labelFormatter:d=>`Month: ${d}`}),e(et,{type:"monotone",dataKey:"revenue",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Revenue"}),e(et,{type:"monotone",dataKey:"cost",stackId:"2",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6,name:"Cost"})]})})})]})]}),a==="revenue"&&t("div",{className:"space-y-6",children:[e("h2",{className:"text-xl font-semibold text-gray-900",children:"Revenue Analysis"}),t("div",{className:"bg-white p-6 rounded-lg shadow",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue by Transport Level"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trips"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Margin"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:(l==null?void 0:l.tripsByTransportLevel)&&Object.entries(l.tripsByTransportLevel).map(([d,E])=>t("tr",{children:[e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:d}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E.count}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(E.revenue)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(E.cost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(E.profit)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${_(E.margin)} ${U(E.margin)}`,children:F(E.margin)})})]},d))})]})})]}),t("div",{className:"bg-white p-6 rounded-lg shadow",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Revenue by Priority Level"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trips"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Margin"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:(l==null?void 0:l.tripsByPriority)&&Object.entries(l.tripsByPriority).map(([d,E])=>t("tr",{children:[e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:d}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E.count}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(E.revenue)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(E.cost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(E.profit)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${_(E.margin)} ${U(E.margin)}`,children:F(E.margin)})})]},d))})]})})]})]}),a==="costs"&&t("div",{className:"space-y-6",children:[e("h2",{className:"text-xl font-semibold text-gray-900",children:"Cost Analysis"}),t("div",{className:"bg-white p-6 rounded-lg shadow",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost Breakdown"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(ct,{children:[e(dt,{data:X,cx:"50%",cy:"50%",labelLine:!1,label:({name:d,percent:E})=>`${d} ${(E*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:X.map((d,E)=>e(mt,{fill:d.color},`cell-${E}`))}),e(be,{formatter:d=>[O(d),"Cost"]})]})})})]}),t("div",{className:"bg-white p-6 rounded-lg shadow",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Trip Cost Breakdowns"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip ID"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Cost"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Margin"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:m.slice(0,10).map(d=>t("tr",{children:[t("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[d.tripId.substring(0,8),"..."]}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.transportLevel}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(d.totalRevenue)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(d.totalCost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(d.grossProfit)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${_(d.profitMargin)} ${U(d.profitMargin)}`,children:F(d.profitMargin)})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(d.calculatedAt).toLocaleDateString()})]},d.id))})]})})]})]}),a==="profitability"&&t("div",{className:"space-y-6",children:[e("h2",{className:"text-xl font-semibold text-gray-900",children:"Profitability Analysis"}),t("div",{className:"bg-white p-6 rounded-lg shadow",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Profitability Trends"}),e("div",{className:"h-64",children:e(ye,{width:"100%",height:"100%",children:t(ca,{data:I,children:[e(je,{strokeDasharray:"3 3"}),e($e,{dataKey:"month"}),e(Te,{yAxisId:"left"}),e(Te,{yAxisId:"right",orientation:"right"}),e(be,{formatter:(d,E)=>[E==="margin"?`${d}%`:O(d),E==="margin"?"Margin":"Profit"],labelFormatter:d=>`Month: ${d}`}),e(Be,{yAxisId:"left",type:"monotone",dataKey:"profit",stroke:"#3b82f6",strokeWidth:2,name:"Profit"}),e(Be,{yAxisId:"right",type:"monotone",dataKey:"margin",stroke:"#10b981",strokeWidth:2,name:"Margin %"})]})})})]}),(N==null?void 0:N.monthlyBreakdown)&&t("div",{className:"bg-white p-6 rounded-lg shadow",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Monthly Breakdown"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:t("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Month"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trips"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Margin"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:N.monthlyBreakdown.map((d,E)=>t("tr",{children:[e("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:d.month}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.tripCount}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(d.revenue)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(d.cost)}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O(d.profit)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${_(d.margin)} ${U(d.margin)}`,children:F(d.margin)})})]},E))})]})})]})]}),a==="billing"&&t("div",{className:"space-y-6",children:[e("h2",{className:"text-xl font-semibold text-gray-900",children:"Reports"}),t("div",{className:"bg-white p-6 rounded-lg shadow",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Generate Reports"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("button",{onClick:G,className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[e(He,{className:"h-6 w-6 text-blue-600 mr-3"}),t("div",{className:"text-left",children:[e("p",{className:"font-medium text-gray-900",children:"Financial Summary"}),e("p",{className:"text-sm text-gray-500",children:"Complete financial overview"})]})]}),t("button",{onClick:W,className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[e(pe,{className:"h-6 w-6 text-green-600 mr-3"}),t("div",{className:"text-left",children:[e("p",{className:"font-medium text-gray-900",children:"Revenue Report"}),e("p",{className:"text-sm text-gray-500",children:"Detailed revenue analysis"})]})]}),t("button",{onClick:P,className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[e(lt,{className:"h-6 w-6 text-red-600 mr-3"}),t("div",{className:"text-left",children:[e("p",{className:"font-medium text-gray-900",children:"Cost Report"}),e("p",{className:"text-sm text-gray-500",children:"Detailed cost breakdown"})]})]}),t("button",{onClick:D,className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[e(Et,{className:"h-6 w-6 text-purple-600 mr-3"}),t("div",{className:"text-left",children:[e("p",{className:"font-medium text-gray-900",children:"Profitability Report"}),e("p",{className:"text-sm text-gray-500",children:"Profit margin analysis"})]})]}),t("button",{onClick:w,className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[e(ze,{className:"h-6 w-6 text-gray-600 mr-3"}),t("div",{className:"text-left",children:[e("p",{className:"font-medium text-gray-900",children:"Export Data"}),e("p",{className:"text-sm text-gray-500",children:"Export to CSV format"})]})]})]})]}),t("div",{className:"bg-white p-6 rounded-lg shadow",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Reports"}),x.length===0?t("div",{className:"text-center py-8 text-gray-500",children:[e(He,{className:"h-12 w-12 text-gray-400 mx-auto mb-2"}),e("p",{children:"No reports generated yet"}),e("p",{className:"text-sm text-gray-400",children:"Generate your first report using the options above"})]}):e("div",{className:"space-y-4",children:x.map(d=>e("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[e(He,{className:"h-5 w-5 text-blue-600"}),t("div",{children:[e("h4",{className:"font-medium text-gray-900",children:d.name}),t("p",{className:"text-sm text-gray-500",children:["Generated: ",new Date(d.generatedAt).toLocaleString()]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>ee(d.id),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Download Report",children:e(ze,{className:"h-4 w-4"})}),e("button",{onClick:()=>q(d.id),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Share Report",children:e(Je,{className:"h-4 w-4"})}),e("button",{onClick:()=>Z(d.id),className:"p-2 text-gray-400 hover:text-red-600 transition-colors",title:"Remove Report",children:e(we,{className:"h-4 w-4"})})]})]})},d.id))})]})]}),x.filter(d=>d.isOpen).map(d=>t("div",{className:"mt-6",children:[d.type==="financial-summary"&&e(en,{data:d.data,onClose:()=>C(d.id),onDownload:()=>ee(d.id),onShare:()=>q(d.id)}),d.type==="revenue"&&e(tn,{data:d.data,onClose:()=>C(d.id),onDownload:()=>ee(d.id),onShare:()=>q(d.id)}),d.type==="cost"&&e(an,{data:d.data,onClose:()=>C(d.id),onDownload:()=>ee(d.id),onShare:()=>q(d.id)}),d.type==="profitability"&&e(rn,{data:d.data,onClose:()=>C(d.id),onDownload:()=>ee(d.id),onShare:()=>q(d.id)}),d.type==="export-data"&&e(sn,{data:d.data,onClose:()=>C(d.id),onDownload:()=>ee(d.id),onShare:()=>q(d.id)})]},d.id))]})},Ar=({user:a,onTripCreated:r,onCancel:s})=>{const[n,i]=g.exports.useState(1),[o,l]=g.exports.useState(!1),[h,N]=g.exports.useState(null),[y,m]=g.exports.useState(!1),[p,x]=g.exports.useState({diagnosis:[],mobility:[],transportLevel:[],urgency:[],insurance:[],facilities:[],agencies:[],pickupLocations:[]}),[f,c]=g.exports.useState({patientId:"",patientWeight:"",specialNeeds:"",insuranceCompany:"",generateQRCode:!1,fromLocation:a.facilityName||"",pickupLocationId:"",toLocation:"",scheduledTime:new Date().toISOString().slice(0,16),transportLevel:"BLS",urgencyLevel:"Routine",diagnosis:"",mobilityLevel:"Ambulatory",oxygenRequired:!1,monitoringRequired:!1,selectedAgencies:[],notificationRadius:100,notes:""}),[b,u]=g.exports.useState("select"),[S,k]=g.exports.useState(!1),O=[{id:1,name:"Patient Info",icon:Ke},{id:2,name:"Trip Details",icon:Re},{id:3,name:"Clinical Info",icon:Sa},{id:4,name:"Agency Selection",icon:ie},{id:5,name:"Review & Submit",icon:re}];g.exports.useEffect(()=>{F()},[]),g.exports.useEffect(()=>{if(f.fromLocation&&p.facilities.length>0){const R=p.facilities.find(q=>q.name===f.fromLocation);R&&_(R.id)}},[f.fromLocation,p.facilities]),g.exports.useEffect(()=>{if(console.log("TCC_DEBUG: Agency loading useEffect triggered",{currentStep:n,fromLocation:f.fromLocation,facilitiesCount:p.facilities.length}),n===4&&f.fromLocation&&p.facilities.length>0){const R=p.facilities.find(q=>q.name===f.fromLocation);console.log("TCC_DEBUG: Selected facility:",R),R&&U(R.id)}},[n,f.fromLocation,p.facilities]);const F=async()=>{try{const[R,q,$,L,B,H]=await Promise.all([Fe.getOptions.diagnosis(),Fe.getOptions.mobility(),Fe.getOptions.transportLevel(),Fe.getOptions.urgency(),Fe.getOptions.insurance(),fetch("/api/tcc/facilities",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(X=>X.json())]);x({diagnosis:R.data.data||[],mobility:q.data.data||[],transportLevel:$.data.data||[],urgency:L.data.data||[],insurance:B.data.data||[],facilities:H.data||[],agencies:[],pickupLocations:[]})}catch(R){console.error("Error loading form options:",R)}},U=async R=>{try{console.log("TCC_DEBUG: Loading agencies for hospital:",R,"with radius:",f.notificationRadius);const q=await Fe.getAgenciesForHospital(R,f.notificationRadius);console.log("TCC_DEBUG: Agencies response:",q.data),x($=>({...$,agencies:q.data.data||[]}))}catch(q){console.error("Error loading agencies:",q)}},_=async R=>{try{k(!0);const q=await fetch(`/api/tcc/pickup-locations/hospital/${R}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(q.ok){const $=await q.json();$.success&&x(L=>({...L,pickupLocations:$.data||[]}))}}catch(q){console.error("Error loading pickup locations:",q)}finally{k(!1)}},G=R=>{const{name:q,value:$,type:L}=R.target;if(c(B=>({...B,[q]:L==="checkbox"?R.target.checked:$})),q==="fromLocation"&&$){const B=p.facilities.find(H=>H.name===$);B?_(B.id):(x(H=>({...H,pickupLocations:[]})),c(H=>({...H,pickupLocationId:""})))}if(q==="toLocation"&&$&&b==="select"){const B=p.facilities.find(H=>H.name===$);B&&U(B.id)}},W=R=>{u(R),c(q=>({...q,toLocation:""})),R==="manual"&&x(q=>({...q,agencies:[]}))},P=R=>{c(q=>({...q,selectedAgencies:q.selectedAgencies.includes(R)?q.selectedAgencies.filter($=>$!==R):[...q.selectedAgencies,R]}))},D=()=>{const R="P"+Math.random().toString(36).substr(2,8).toUpperCase();c(q=>({...q,patientId:R}))},w=()=>{s&&s()},M=()=>{n<O.length&&i(n+1)},C=()=>{n>1&&i(n-1)},Z=async R=>{var q,$;R.preventDefault(),l(!0),N(null);try{const L={...f,patientWeight:f.patientWeight?parseFloat(f.patientWeight):null,notificationRadius:f.notificationRadius||100,scheduledTime:f.scheduledTime||new Date().toISOString()},B=await Fe.createEnhanced(L);if(B.data.success)m(!0),setTimeout(()=>{m(!1),r()},2e3);else throw new Error(B.data.error||"Failed to create transport request")}catch(L){N((($=(q=L.response)==null?void 0:q.data)==null?void 0:$.error)||L.message||"Failed to create transport request")}finally{l(!1)}},ee=()=>{switch(n){case 1:return t("div",{className:"space-y-6",children:[t("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t("div",{className:"flex items-center",children:[e(Ke,{className:"h-5 w-5 text-blue-600 mr-2"}),e("h3",{className:"text-sm font-medium text-blue-800",children:"Patient Information"})]}),e("p",{className:"text-sm text-blue-700 mt-1",children:"Enter patient details. No names or ages for HIPAA compliance."})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient ID *"}),t("div",{className:"flex gap-2",children:[e("input",{type:"text",name:"patientId",value:f.patientId,onChange:G,required:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter patient ID"}),e("button",{type:"button",onClick:D,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Generate ID"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient Weight (kgs)"}),e("input",{type:"number",name:"patientWeight",value:f.patientWeight,onChange:G,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter weight in kilograms"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance Company"}),t("select",{name:"insuranceCompany",value:f.insuranceCompany,onChange:G,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"Select insurance company"}),p.insurance.map(R=>e("option",{value:R,children:R},R))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Special Needs"}),e("input",{type:"text",name:"specialNeeds",value:f.specialNeeds,onChange:G,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter special needs"})]})]})]});case 2:return t("div",{className:"space-y-6",children:[t("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t("div",{className:"flex items-center",children:[e(Re,{className:"h-5 w-5 text-green-600 mr-2"}),e("h3",{className:"text-sm font-medium text-green-800",children:"Trip Details"})]}),e("p",{className:"text-sm text-green-700 mt-1",children:"Specify origin, destination, and transport requirements."})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Location *"}),t("select",{name:"fromLocation",value:f.fromLocation,onChange:G,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",children:[e("option",{value:"",children:"Select origin facility"}),p.facilities.map(R=>t("option",{value:R.name,children:[R.name," - ",R.type]},R.id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pickup Location *"}),t("select",{name:"pickupLocationId",value:f.pickupLocationId,onChange:G,required:!0,disabled:S,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e("option",{value:"",children:S?"Loading pickup locations...":"Select pickup location"}),p.pickupLocations&&p.pickupLocations.length>0?p.pickupLocations.map(R=>t("option",{value:R.id,children:[R.name," ",R.floor&&`(${R.floor})`]},R.id)):!S&&f.fromLocation&&e("option",{value:"",disabled:!0,children:"No pickup locations available for this facility"})]}),f.pickupLocationId&&p.pickupLocations&&e("div",{className:"mt-2 text-sm text-gray-600",children:(()=>{const R=p.pickupLocations.find(q=>q.id===f.pickupLocationId);return R?t("div",{children:[R.contactPhone&&t("p",{children:[e("strong",{children:"Contact:"})," ",R.contactPhone]}),R.contactEmail&&t("p",{children:[e("strong",{children:"Email:"})," ",R.contactEmail]}),R.room&&t("p",{children:[e("strong",{children:"Room:"})," ",R.room]})]}):null})()})]})]}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Location *"}),t("div",{className:"flex space-x-4 mb-3",children:[t("label",{className:"flex items-center",children:[e("input",{type:"radio",name:"destinationMode",value:"select",checked:b==="select",onChange:R=>W(R.target.value),className:"mr-2"}),e("span",{className:"text-sm text-gray-700",children:"Select from list"})]}),t("label",{className:"flex items-center",children:[e("input",{type:"radio",name:"destinationMode",value:"manual",checked:b==="manual",onChange:R=>W(R.target.value),className:"mr-2"}),e("span",{className:"text-sm text-gray-700",children:"Enter manually"})]})]}),b==="select"?t("select",{name:"toLocation",value:f.toLocation,onChange:G,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",children:[e("option",{value:"",children:"Select destination"}),p.facilities.map(R=>t("option",{value:R.name,children:[R.name," - ",R.type]},R.id))]}):e("input",{type:"text",name:"toLocation",value:f.toLocation,onChange:G,required:!0,placeholder:"Enter destination facility name and location",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500"}),b==="select"&&p.facilities.length===0&&e("p",{className:"text-sm text-gray-500 mt-1",children:"Loading facilities..."}),b==="manual"&&e("p",{className:"text-sm text-gray-500 mt-1",children:'Enter the full facility name and location (e.g., "Johns Hopkins Hospital, Baltimore, MD")'})]})}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled Time *"}),e("input",{type:"datetime-local",name:"scheduledTime",value:f.scheduledTime,onChange:G,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transport Level *"}),e("select",{name:"transportLevel",value:f.transportLevel,onChange:G,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",children:p.transportLevel.map(R=>e("option",{value:R,children:R},R))})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Urgency Level *"}),e("select",{name:"urgencyLevel",value:f.urgencyLevel,onChange:G,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",children:p.urgency.map(R=>e("option",{value:R,children:R},R))})]})]})]});case 3:return t("div",{className:"space-y-6",children:[t("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[t("div",{className:"flex items-center",children:[e(Sa,{className:"h-5 w-5 text-purple-600 mr-2"}),e("h3",{className:"text-sm font-medium text-purple-800",children:"Clinical Details"})]}),e("p",{className:"text-sm text-purple-700 mt-1",children:"Provide clinical information for appropriate transport planning."})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Diagnosis"}),t("select",{name:"diagnosis",value:f.diagnosis,onChange:G,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-purple-500 focus:border-purple-500",children:[e("option",{value:"",children:"Select diagnosis"}),p.diagnosis.map(R=>e("option",{value:R,children:R},R))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobility Level"}),e("select",{name:"mobilityLevel",value:f.mobilityLevel,onChange:G,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-purple-500 focus:border-purple-500",children:p.mobility.map(R=>e("option",{value:R,children:R},R))})]})]}),t("div",{className:"space-y-4",children:[t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"oxygenRequired",checked:f.oxygenRequired,onChange:G,className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),e("label",{className:"ml-2 block text-sm text-gray-900",children:"Oxygen Required"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"monitoringRequired",checked:f.monitoringRequired,onChange:G,className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),e("label",{className:"ml-2 block text-sm text-gray-900",children:"Continuous Monitoring Required"})]})]})]});case 4:return t("div",{className:"space-y-6",children:[t("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[t("div",{className:"flex items-center",children:[e(ie,{className:"h-5 w-5 text-orange-600 mr-2"}),e("h3",{className:"text-sm font-medium text-orange-800",children:"EMS Agency Selection"})]}),t("p",{className:"text-sm text-orange-700 mt-1",children:["Select agencies to notify within ",f.notificationRadius," miles."]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notification Radius (miles)"}),e("input",{type:"number",name:"notificationRadius",value:f.notificationRadius,onChange:G,min:"10",max:"200",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Available Agencies"}),f.fromLocation?e("div",{className:"space-y-3",children:p.agencies.length===0?e("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("svg",{className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:e("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e("div",{className:"ml-3",children:t("p",{className:"text-sm text-gray-600",children:[e("strong",{children:"Loading agencies..."})," Please wait while we find available EMS agencies in your area."]})})]})}):p.agencies.map(R=>e("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${f.selectedAgencies.includes(R.id)?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-orange-300"}`,onClick:()=>P(R.id),children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("h4",{className:"font-medium text-gray-900",children:R.name}),e("p",{className:"text-sm text-gray-500",children:R.serviceType}),t("p",{className:"text-xs text-gray-400",children:[R.availableUnits||0,"/",R.totalUnits||0," units available"]})]}),e("div",{className:"flex items-center",children:e("input",{type:"checkbox",checked:f.selectedAgencies.includes(R.id),onChange:()=>{},className:"h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"})})]})},R.id))}):e("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e("div",{className:"ml-3",children:t("p",{className:"text-sm text-yellow-700",children:[e("strong",{children:"No Origin Hospital Selected:"})," Please select an origin hospital in step 2 to load available agencies."]})})]})})]})]});case 5:return t("div",{className:"space-y-6",children:[t("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[t("div",{className:"flex items-center",children:[e(re,{className:"h-5 w-5 text-gray-600 mr-2"}),e("h3",{className:"text-sm font-medium text-gray-800",children:"Review & Submit"})]}),e("p",{className:"text-sm text-gray-700 mt-1",children:"Review all information before submitting the transport request."})]}),t("div",{className:"space-y-4",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{className:"bg-white border rounded-lg p-4",children:[e("h4",{className:"font-medium text-gray-900 mb-2",children:"Patient Information"}),t("p",{className:"text-sm text-gray-600",children:["ID: ",f.patientId]}),f.patientWeight&&t("p",{className:"text-sm text-gray-600",children:["Weight: ",f.patientWeight," kgs"]}),f.insuranceCompany&&t("p",{className:"text-sm text-gray-600",children:["Insurance: ",f.insuranceCompany]}),f.specialNeeds&&t("p",{className:"text-sm text-gray-600",children:["Special Needs: ",f.specialNeeds]})]}),t("div",{className:"bg-white border rounded-lg p-4",children:[e("h4",{className:"font-medium text-gray-900 mb-2",children:"Trip Details"}),t("p",{className:"text-sm text-gray-600",children:["From: ",f.fromLocation]}),f.pickupLocationId&&p.pickupLocations&&(()=>{const R=p.pickupLocations.find(q=>q.id===f.pickupLocationId);return R?t("p",{className:"text-sm text-gray-600",children:["Pickup: ",R.name," ",R.floor&&`(${R.floor})`]}):null})(),t("p",{className:"text-sm text-gray-600",children:["To: ",f.toLocation]}),t("p",{className:"text-sm text-gray-600",children:["Level: ",f.transportLevel]}),t("p",{className:"text-sm text-gray-600",children:["Urgency: ",f.urgencyLevel]})]}),t("div",{className:"bg-white border rounded-lg p-4",children:[e("h4",{className:"font-medium text-gray-900 mb-2",children:"Clinical Details"}),f.diagnosis&&t("p",{className:"text-sm text-gray-600",children:["Diagnosis: ",f.diagnosis]}),t("p",{className:"text-sm text-gray-600",children:["Mobility: ",f.mobilityLevel]}),f.oxygenRequired&&e("p",{className:"text-sm text-red-600",children:"Oxygen Required"}),f.monitoringRequired&&e("p",{className:"text-sm text-red-600",children:"Monitoring Required"})]}),t("div",{className:"bg-white border rounded-lg p-4",children:[e("h4",{className:"font-medium text-gray-900 mb-2",children:"Agency Selection"}),t("p",{className:"text-sm text-gray-600",children:["Selected: ",f.selectedAgencies.length," agencies"]}),t("p",{className:"text-sm text-gray-600",children:["Radius: ",f.notificationRadius," miles"]})]})]}),f.notes&&t("div",{className:"bg-white border rounded-lg p-4",children:[e("h4",{className:"font-medium text-gray-900 mb-2",children:"Additional Notes"}),e("p",{className:"text-sm text-gray-600",children:f.notes})]})]})]});default:return null}};return t("div",{className:"max-w-4xl mx-auto",children:[e("div",{className:"mb-8",children:e("div",{className:"flex items-center justify-between",children:O.map((R,q)=>{const $=R.icon,L=n===R.id,B=n>R.id;return t("div",{className:"flex items-center",children:[e("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${L?"border-blue-500 bg-blue-500 text-white":B?"border-green-500 bg-green-500 text-white":"border-gray-300 bg-white text-gray-400"}`,children:e($,{className:"h-5 w-5"})}),e("div",{className:"ml-3",children:e("p",{className:`text-sm font-medium ${L?"text-blue-600":B?"text-green-600":"text-gray-500"}`,children:R.name})}),q<O.length-1&&e("div",{className:`w-16 h-0.5 mx-4 ${B?"bg-green-500":"bg-gray-300"}`})]},R.id)})})}),t("div",{className:"bg-white rounded-lg shadow-lg",children:[t("div",{className:"px-6 py-4 border-b border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Enhanced Transport Request"}),t("p",{className:"text-sm text-gray-500",children:["Step ",n," of ",O.length]})]}),t("div",{className:"p-6",children:[y&&e("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(re,{className:"h-5 w-5 text-green-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-green-800",children:"Transport request created successfully!"})})]})}),h&&e("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(he,{className:"h-5 w-5 text-red-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800",children:h})})]})}),t("form",{onSubmit:Z,children:[ee(),t("div",{className:"flex justify-between mt-8",children:[t("div",{className:"flex space-x-3",children:[t("button",{type:"button",onClick:w,className:"flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:[e(we,{className:"h-4 w-4 mr-2"}),"Cancel"]}),t("button",{type:"button",onClick:C,disabled:n===1,className:"flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(Gr,{className:"h-4 w-4 mr-2"}),"Previous"]})]}),n<O.length?t("button",{type:"button",onClick:M,className:"flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:["Next",e(Xa,{className:"h-4 w-4 ml-2"})]}):e("button",{type:"submit",disabled:o,className:"flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",children:o?"Creating...":"Create Request"})]})]})]})]})]})},ln=({user:a})=>{const r=Ya();return e("div",{className:"min-h-full bg-gray-100 p-4 sm:p-6 lg:p-8",children:t("div",{className:"max-w-7xl mx-auto",children:[t("div",{className:"mb-6",children:[e("h1",{className:"text-3xl font-bold text-gray-900",children:"Create Transport Request"}),e("p",{className:"mt-2 text-sm text-gray-600",children:"Create a new transport request on behalf of a healthcare facility."})]}),e(Ar,{user:a,onTripCreated:()=>{r("/dashboard/trips")},onCancel:()=>{r("/dashboard/trips")}})]})})},on=({user:a,onLogout:r})=>{g.exports.useState(!1);const[s,n]=g.exports.useState(!1),[i,o]=g.exports.useState(null),l=Br(),h=g.exports.useRef({}),y=(()=>{const x=[{name:"Home",href:"/dashboard",icon:Vr,category:"core"},{name:"Trips",href:"/dashboard/trips",icon:ie,category:"core"},{name:"Hospitals",href:"/dashboard/hospitals",icon:ve,category:"core"},{name:"Agencies",href:"/dashboard/agencies",icon:ie,category:"core"}],f=[{name:"Analytics",href:"/dashboard/analytics",icon:me,category:"analysis"},{name:"Financial",href:"/dashboard/financial",icon:pe,category:"analysis"}],c=[{name:"Settings",href:"/dashboard/settings",icon:Ta,category:"admin"}],b=[];return a.userType==="ADMIN"?{coreOperations:x,analysisReporting:f,administration:c,additionalFeatures:b}:{coreOperations:x,analysisReporting:f,administration:[],additionalFeatures:b}})(),m={settings:{title:"Settings",icon:We,items:[{name:"User Management",href:"/dashboard/settings",icon:Qa},{name:"Notifications",href:"/dashboard/settings/notifications",icon:Qe},{name:"Backup",href:"/dashboard/settings/backup",icon:Xt}]}};g.exports.useEffect(()=>{const x=f=>{if(i&&h.current[i]){const c=h.current[i];c&&!c.contains(f.target)&&o(null)}};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[i]);const p=({menuKey:x,menu:f})=>{const c=i===x,b=f.items.some(u=>l.pathname===u.href||u.href!=="/dashboard"&&l.pathname.startsWith(u.href));return t("div",{className:"relative",ref:u=>h.current[x]=u,children:[t("button",{onClick:()=>o(c?null:x),className:`${b?"text-green-600 border-b-2 border-green-600":"text-gray-500 hover:text-gray-700 hover:border-b-2 hover:border-gray-300"} flex items-center px-1 py-2 text-sm font-medium border-b-2 border-transparent transition-colors`,children:[e(f.icon,{className:"mr-2 h-4 w-4"}),f.title,e(Ze,{className:`ml-1 h-4 w-4 transition-transform ${c?"rotate-180":""}`})]}),c&&e("div",{className:"absolute top-full left-0 mt-1 w-56 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50",children:e("div",{className:"py-1",children:f.items.map((u,S)=>{const k=l.pathname===u.href||u.href!=="/dashboard"&&l.pathname.startsWith(u.href);return t(qe,{to:u.href,className:`${k?"bg-green-50 text-green-700":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-4 py-2 text-sm`,onClick:()=>o(null),children:[e(u.icon,{className:`mr-3 h-4 w-4 ${u.color||"text-gray-400 group-hover:text-gray-500"}`}),u.name]},S)})})})]})};return t("div",{className:"h-screen flex flex-col overflow-hidden bg-gray-100",children:[t("div",{className:"bg-white shadow-sm border-b border-gray-200",children:[t("div",{className:"md:hidden",children:[t("div",{className:"flex items-center justify-between px-4 py-3",children:[t("div",{className:"flex items-center space-x-3",children:[t("div",{className:"flex items-center",children:[e("div",{className:"h-8 w-8 bg-primary-600 rounded-lg flex items-center justify-center",children:e(ve,{className:"h-5 w-5 text-white"})}),e("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"TCC"})]}),e("button",{onClick:r,className:"p-2 text-gray-400 hover:text-gray-500 hover:bg-gray-100 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",title:"Sign out",children:e(Lt,{className:"h-5 w-5"})})]}),e("button",{type:"button",className:"p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500",onClick:()=>n(!s),children:s?e(we,{className:"h-6 w-6"}):e(Ta,{className:"h-6 w-6"})})]}),s&&t("div",{className:"px-2 pt-2 pb-3 space-y-1 bg-gray-50 border-t border-gray-200",children:[e("div",{className:"px-3 py-2",children:e("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Core Operations"})}),y.coreOperations.map(x=>{const f=l.pathname===x.href||x.href!=="/dashboard"&&l.pathname.startsWith(x.href);if(x.hasDropdown){const c=x.name.toLowerCase(),b=m[c];return t("div",{children:[e("div",{className:"px-3 py-2",children:t("div",{className:"flex items-center text-gray-600 font-medium",children:[e(b.icon,{className:"mr-3 h-5 w-5 text-gray-400"}),b.title]})}),b.items.map((u,S)=>{const k=l.pathname===u.href||u.href!=="/dashboard"&&l.pathname.startsWith(u.href);return t(qe,{to:u.href,className:`${k?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-6 py-2 text-sm font-medium rounded-md ml-4`,onClick:()=>n(!1),children:[e(u.icon,{className:`${k?"text-primary-500":"text-gray-400 group-hover:text-gray-500"} mr-3 flex-shrink-0 h-4 w-4`}),u.name]},S)})]},x.name)}return t(qe,{to:x.href,className:`${f?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-3 py-2 text-base font-medium rounded-md`,onClick:()=>n(!1),children:[e(x.icon,{className:`${f?"text-primary-500":"text-gray-400 group-hover:text-gray-500"} mr-3 flex-shrink-0 h-5 w-5`}),x.name]},x.name)}),e("div",{className:"px-3 py-2",children:e("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Analysis"})}),y.analysisReporting.map(x=>{const f=l.pathname===x.href||x.href!=="/dashboard"&&l.pathname.startsWith(x.href);return t(qe,{to:x.href,className:`${f?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-3 py-2 text-base font-medium rounded-md`,onClick:()=>n(!1),children:[e(x.icon,{className:`${f?"text-primary-500":"text-gray-400 group-hover:text-gray-500"} mr-3 flex-shrink-0 h-5 w-5`}),x.name]},x.name)}),e("div",{className:"px-3 py-2",children:e("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Additional"})}),y.additionalFeatures.map(x=>{const f=l.pathname===x.href||x.href!=="/dashboard"&&l.pathname.startsWith(x.href);return t(qe,{to:x.href,className:`${f?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-3 py-2 text-base font-medium rounded-md`,onClick:()=>n(!1),children:[e(x.icon,{className:`${f?"text-primary-500":"text-gray-400 group-hover:text-gray-500"} mr-3 flex-shrink-0 h-5 w-5`}),x.name]},x.name)}),y.administration.length>0&&t("div",{children:[e("div",{className:"px-3 py-2",children:e("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Administration"})}),e("div",{className:"px-3 py-2",children:t("div",{className:"flex items-center text-gray-600 font-medium",children:[e(m.settings.icon,{className:"mr-3 h-5 w-5 text-gray-400"}),m.settings.title]})}),m.settings.items.map((x,f)=>{const c=l.pathname===x.href||x.href!=="/dashboard"&&l.pathname.startsWith(x.href);return t(qe,{to:x.href,className:`${c?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} group flex items-center px-6 py-2 text-sm font-medium rounded-md ml-4`,onClick:()=>n(!1),children:[e(x.icon,{className:`${c?"text-primary-500":"text-gray-400 group-hover:text-gray-500"} mr-3 flex-shrink-0 h-4 w-4`}),x.name]},f)})]})]})]}),e("div",{className:"hidden md:block",children:e("div",{className:"px-6 py-4",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center",children:[e("div",{className:"h-8 w-8 bg-primary-600 rounded-lg flex items-center justify-center",children:e(ve,{className:"h-5 w-5 text-white"})}),e("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"TCC"})]}),t("nav",{className:"flex items-center space-x-8",children:[y.coreOperations.map(x=>{const f=l.pathname===x.href||x.href!=="/dashboard"&&l.pathname.startsWith(x.href);if(x.hasDropdown){const c=x.name.toLowerCase();return e(p,{menuKey:c,menu:m[c]},x.name)}return t(qe,{to:x.href,className:`${f?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700 hover:border-b-2 hover:border-gray-300"} flex items-center px-1 py-2 text-sm font-medium border-b-2 border-transparent transition-colors`,children:[e(x.icon,{className:"mr-2 h-4 w-4"}),x.name]},x.name)}),y.analysisReporting.map(x=>{const f=l.pathname===x.href||x.href!=="/dashboard"&&l.pathname.startsWith(x.href);return t(qe,{to:x.href,className:`${f?"text-green-600 border-b-2 border-green-600":"text-gray-500 hover:text-gray-700 hover:border-b-2 hover:border-gray-300"} flex items-center px-1 py-2 text-sm font-medium border-b-2 border-transparent transition-colors`,children:[e(x.icon,{className:"mr-2 h-4 w-4"}),x.name]},x.name)}),y.additionalFeatures.map(x=>{const f=l.pathname===x.href||x.href!=="/dashboard"&&l.pathname.startsWith(x.href);return t(qe,{to:x.href,className:`${f?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700 hover:border-b-2 hover:border-gray-300"} flex items-center px-1 py-2 text-sm font-medium border-b-2 border-transparent transition-colors`,children:[e(x.icon,{className:"mr-2 h-4 w-4"}),x.name]},x.name)}),y.administration.length>0&&e(p,{menuKey:"settings",menu:m.settings})]}),t("div",{className:"flex items-center space-x-4",children:[e("div",{className:"flex items-center space-x-3",children:t("div",{className:"text-right",children:[e("p",{className:"text-sm font-medium text-gray-700",children:a.name}),e("p",{className:"text-xs text-gray-500",children:a.email})]})}),t("button",{onClick:r,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 transition-colors",title:"Sign out",children:[e(Lt,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})})})]}),e("div",{className:"flex-1 flex flex-col overflow-hidden",children:e("main",{className:"flex-1 relative overflow-y-auto focus:outline-none",children:e("div",{className:"py-6",children:e("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:t(Yt,{children:[e(le,{path:"/",element:e(ji,{})}),e(le,{path:"/trips",element:e(zi,{user:a})}),e(le,{path:"/trips/create",element:e(ln,{user:a})}),e(le,{path:"/analytics",element:e(Qi,{})}),e(le,{path:"/units",element:e(Yi,{})}),e(le,{path:"/hospitals/*",element:e(_i,{})}),e(le,{path:"/agencies/*",element:e(qi,{})}),e(le,{path:"/route-optimization",element:e(Zi,{})}),e(le,{path:"/healthcare-portal",element:e(Hi,{})}),e(le,{path:"/ems-dashboard",element:e(Rr,{user:a,onLogout:r})}),e(le,{path:"/settings",element:e(Va,{})}),e(le,{path:"/settings/users",element:e(Va,{})}),e(le,{path:"/settings/notifications",element:e(Ki,{})}),e(le,{path:"/settings/backup",element:e(Ji,{})}),e(le,{path:"/financial",element:e(nn,{})}),e(le,{path:"/my-trips",element:t("div",{className:"text-center py-12",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"My Trips"}),e("p",{className:"text-gray-500",children:"Coming soon..."})]})}),e(le,{path:"/my-assignments",element:t("div",{className:"text-center py-12",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"My Assignments"}),e("p",{className:"text-gray-500",children:"Coming soon..."})]})})]})})})})})]})},cn=()=>{var ne;const[a,r]=g.exports.useState("dropdowns"),[s,n]=g.exports.useState([]),[i,o]=g.exports.useState(""),[l,h]=g.exports.useState([]),[N,y]=g.exports.useState(!1),[m,p]=g.exports.useState(null),[x,f]=g.exports.useState(null),[c,b]=g.exports.useState(""),[u,S]=g.exports.useState(null),[k,O]=g.exports.useState(""),[F,U]=g.exports.useState([]),[_,G]=g.exports.useState(""),[W,P]=g.exports.useState([]),[D,w]=g.exports.useState(!1),[M,C]=g.exports.useState(null),[Z,ee]=g.exports.useState(null),[R,q]=g.exports.useState(!1),[$,L]=g.exports.useState(null),[B,H]=g.exports.useState({name:"",description:"",contactPhone:"",contactEmail:"",floor:"",room:""});g.exports.useEffect(()=>{X()},[]),g.exports.useEffect(()=>{i&&I(i)},[i]),g.exports.useEffect(()=>{K()},[]),g.exports.useEffect(()=>{_&&ce(_)},[_]);const X=async()=>{try{y(!0);const j=await Xe.getCategories();j.data.success&&(n(j.data.data),j.data.data.length>0&&o(j.data.data[0]))}catch(j){console.error("Error loading categories:",j),p("Failed to load categories")}finally{y(!1)}},I=async j=>{try{y(!0);const ae=await Xe.getByCategory(j);ae.data.success&&h(ae.data.data)}catch(ae){console.error("Error loading options:",ae),p("Failed to load options")}finally{y(!1)}},d=async j=>{if(j.preventDefault(),!(!c.trim()||!i))try{y(!0),(await Xe.create({category:i,value:c.trim()})).data.success&&(b(""),f("Option added successfully"),I(i),setTimeout(()=>f(null),3e3))}catch(ae){console.error("Error adding option:",ae),p("Failed to add option")}finally{y(!1)}},E=j=>{S(j),O(j.value)},z=async j=>{if(j.preventDefault(),!(!u||!k.trim()))try{y(!0),(await Xe.update(u.id,{value:k.trim()})).data.success&&(S(null),O(""),f("Option updated successfully"),I(i),setTimeout(()=>f(null),3e3))}catch(ae){console.error("Error updating option:",ae),p("Failed to update option")}finally{y(!1)}},Q=async j=>{if(!!window.confirm("Are you sure you want to delete this option?"))try{y(!0),(await Xe.delete(j)).data.success&&(f("Option deleted successfully"),I(i),setTimeout(()=>f(null),3e3))}catch(ae){console.error("Error deleting option:",ae),p("Failed to delete option")}finally{y(!1)}},K=async()=>{try{w(!0);const j=await V.get("/api/tcc/hospitals");j.data.success&&(U(j.data.data),j.data.data.length>0&&G(j.data.data[0].id))}catch(j){console.error("Error loading hospitals:",j),C("Failed to load hospitals")}finally{w(!1)}},ce=async j=>{try{w(!0);const ae=await V.get(`/api/tcc/pickup-locations/hospital/${j}`);ae.data.success&&P(ae.data.data)}catch(ae){console.error("Error loading pickup locations:",ae),C("Failed to load pickup locations")}finally{w(!1)}},ke=()=>{L(null),H({name:"",description:"",contactPhone:"",contactEmail:"",floor:"",room:""}),q(!0)},v=j=>{L(j),H({name:j.name,description:j.description||"",contactPhone:j.contactPhone||"",contactEmail:j.contactEmail||"",floor:j.floor||"",room:j.room||""}),q(!0)},T=async j=>{var ae,De;if(j.preventDefault(),!(!B.name.trim()||!_))try{w(!0);const de={hospitalId:_,name:B.name.trim(),description:B.description.trim()||null,contactPhone:B.contactPhone.trim()||null,contactEmail:B.contactEmail.trim()||null,floor:B.floor.trim()||null,room:B.room.trim()||null};let ge;$?ge=await V.put(`/api/tcc/pickup-locations/${$.id}`,de):ge=await V.post("/api/tcc/pickup-locations",de),ge.data.success&&(q(!1),ee($?"Pickup location updated successfully":"Pickup location created successfully"),ce(_),setTimeout(()=>ee(null),3e3))}catch(de){console.error("Error saving pickup location:",de),C(((De=(ae=de.response)==null?void 0:ae.data)==null?void 0:De.error)||"Failed to save pickup location")}finally{w(!1)}},Y=async j=>{var ae,De;if(!!window.confirm("Are you sure you want to delete this pickup location?"))try{w(!0),(await V.delete(`/api/tcc/pickup-locations/${j}`)).data.success&&(ee("Pickup location deleted successfully"),ce(_),setTimeout(()=>ee(null),3e3))}catch(de){console.error("Error deleting pickup location:",de),C(((De=(ae=de.response)==null?void 0:ae.data)==null?void 0:De.error)||"Failed to delete pickup location")}finally{w(!1)}},J=j=>({insurance:"Insurance Companies",diagnosis:"Primary Diagnosis",mobility:"Mobility Levels","transport-level":"Transport Levels",urgency:"Urgency Levels"})[j]||j;return t("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:[t("div",{className:"mb-6",children:[e("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Hospital Settings"}),e("p",{className:"text-gray-600",children:"Manage dropdown options and pickup locations for transport request forms"})]}),e("div",{className:"mb-6",children:e("div",{className:"border-b border-gray-200",children:t("nav",{className:"-mb-px flex space-x-8",children:[e("button",{onClick:()=>r("dropdowns"),className:`py-2 px-1 border-b-2 font-medium text-sm ${a==="dropdowns"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Dropdown Options"}),e("button",{onClick:()=>r("pickup-locations"),className:`py-2 px-1 border-b-2 font-medium text-sm ${a==="pickup-locations"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Pickup Locations"}),e("button",{onClick:()=>r("main-contact"),className:`py-2 px-1 border-b-2 font-medium text-sm ${a==="main-contact"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Main Contact"})]})})}),x&&e("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-md",children:e("p",{className:"text-green-800",children:x})}),m&&t("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:[e("p",{className:"text-red-800",children:m}),e("button",{onClick:()=>p(null),className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Dismiss"})]}),Z&&e("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-md",children:e("p",{className:"text-green-800",children:Z})}),M&&t("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:[e("p",{className:"text-red-800",children:M}),e("button",{onClick:()=>C(null),className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Dismiss"})]}),a==="dropdowns"&&t(se,{children:[t("div",{className:"mb-6",children:[e("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Category"}),t("select",{id:"category",value:i,onChange:j=>o(j.target.value),className:"w-full max-w-md px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"Select a category..."}),s.map(j=>e("option",{value:j,children:J(j)},j))]})]}),i&&t("div",{className:"space-y-6",children:[t("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Add New ",J(i)]}),t("form",{onSubmit:d,className:"flex gap-2",children:[e("input",{type:"text",value:c,onChange:j=>b(j.target.value),placeholder:`Enter new ${J(i).toLowerCase()}...`,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),e("button",{type:"submit",disabled:N||!c.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Adding...":"Add"})]})]}),t("div",{children:[t("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Current ",J(i)]}),N?t("div",{className:"text-center py-4",children:[e("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e("p",{className:"mt-2 text-gray-600",children:"Loading..."})]}):l.length===0?t("div",{className:"text-center py-8 text-gray-500",children:[e("p",{children:"No options found for this category."}),e("p",{className:"text-sm",children:"Add some options using the form above."})]}):e("div",{className:"space-y-2",children:l.map(j=>e("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-md",children:(u==null?void 0:u.id)===j.id?t("form",{onSubmit:z,className:"flex items-center gap-2 flex-1",children:[e("input",{type:"text",value:k,onChange:ae=>O(ae.target.value),className:"flex-1 px-3 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),e("button",{type:"submit",disabled:N,className:"px-3 py-1 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50",children:"Save"}),e("button",{type:"button",onClick:()=>{S(null),O("")},className:"px-3 py-1 bg-gray-500 text-white text-sm rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"})]}):t(se,{children:[e("span",{className:"text-gray-900",children:j.value}),t("div",{className:"flex items-center gap-2",children:[e("button",{onClick:()=>E(j),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Edit"}),e("button",{onClick:()=>Q(j.id),className:"px-3 py-1 bg-red-600 text-white text-sm rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:"Delete"})]})]})},j.id))})]}),t("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-md",children:[e("h4",{className:"font-semibold text-blue-900 mb-2",children:"Instructions"}),t("ul",{className:"text-sm text-blue-800 space-y-1",children:[e("li",{children:"\u2022 Select a category to manage its dropdown options"}),e("li",{children:"\u2022 Add new options using the form above"}),e("li",{children:'\u2022 Edit existing options by clicking the "Edit" button'}),e("li",{children:'\u2022 Delete options by clicking the "Delete" button'}),e("li",{children:"\u2022 Changes will be reflected in the transport request forms immediately"})]})]})]})]}),a==="pickup-locations"&&t(se,{children:[t("div",{className:"mb-6",children:[e("label",{htmlFor:"hospital",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Hospital"}),t("select",{id:"hospital",value:_,onChange:j=>G(j.target.value),className:"w-full max-w-md px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"Select a hospital..."}),F.map(j=>e("option",{value:j.id,children:j.name},j.id))]})]}),_&&t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("h3",{className:"text-lg font-semibold text-gray-900",children:["Pickup Locations for ",(ne=F.find(j=>j.id===_))==null?void 0:ne.name]}),e("button",{onClick:ke,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Add Pickup Location"})]}),D?t("div",{className:"text-center py-4",children:[e("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e("p",{className:"mt-2 text-gray-600",children:"Loading..."})]}):W.length===0?t("div",{className:"text-center py-8 text-gray-500",children:[e("p",{children:"No pickup locations found for this hospital."}),e("p",{className:"text-sm",children:"Add some pickup locations using the button above."})]}):e("div",{className:"space-y-2",children:W.map(j=>t("div",{className:"flex items-center justify-between p-4 bg-white border border-gray-200 rounded-md",children:[t("div",{className:"flex-1",children:[e("h4",{className:"font-medium text-gray-900",children:j.name}),j.description&&e("p",{className:"text-sm text-gray-600 mt-1",children:j.description}),t("div",{className:"flex flex-wrap gap-4 mt-2 text-sm text-gray-500",children:[j.floor&&t("span",{children:["Floor: ",j.floor]}),j.room&&t("span",{children:["Room: ",j.room]}),j.contactPhone&&t("span",{children:["Phone: ",j.contactPhone]}),j.contactEmail&&t("span",{children:["Email: ",j.contactEmail]})]})]}),t("div",{className:"flex gap-2",children:[e("button",{onClick:()=>v(j),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Edit"}),e("button",{onClick:()=>Y(j.id),className:"px-3 py-1 bg-red-600 text-white text-sm rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:"Delete"})]})]},j.id))})]}),R&&e("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:t("div",{className:"mt-3",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:$?"Edit Pickup Location":"Add New Pickup Location"}),t("form",{onSubmit:T,className:"space-y-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location Name *"}),e("input",{type:"text",value:B.name,onChange:j=>H({...B,name:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Emergency Department",required:!0})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e("textarea",{value:B.description,onChange:j=>H({...B,description:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional description",rows:2})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Floor"}),e("input",{type:"text",value:B.floor,onChange:j=>H({...B,floor:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 1st Floor"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Room"}),e("input",{type:"text",value:B.room,onChange:j=>H({...B,room:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Room 101"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Phone"}),e("input",{type:"tel",value:B.contactPhone,onChange:j=>H({...B,contactPhone:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., (555) 123-4567"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Email"}),e("input",{type:"email",value:B.contactEmail,onChange:j=>H({...B,contactEmail:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., ed@hospital.com"})]}),t("div",{className:"flex justify-end gap-3 pt-4",children:[e("button",{type:"button",onClick:()=>q(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"}),e("button",{type:"submit",disabled:D||!B.name.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:D?"Saving...":$?"Update":"Create"})]})]})]})})}),t("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-md",children:[e("h4",{className:"font-semibold text-blue-900 mb-2",children:"Instructions"}),t("ul",{className:"text-sm text-blue-800 space-y-1",children:[e("li",{children:"\u2022 Select a hospital to manage its pickup locations"}),e("li",{children:'\u2022 Add new pickup locations using the "Add Pickup Location" button'}),e("li",{children:'\u2022 Edit existing locations by clicking the "Edit" button'}),e("li",{children:'\u2022 Delete locations by clicking the "Delete" button'}),e("li",{children:"\u2022 Pickup locations will be available in the trip creation form"})]})]})]}),a==="main-contact"&&t("div",{className:"space-y-6",children:[t("div",{className:"bg-white shadow rounded-lg",children:[t("div",{className:"px-6 py-4 border-b border-gray-200",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:"Main Contact Information"}),e("p",{className:"mt-1 text-sm text-gray-500",children:"Set the main contact person for this facility's administration of the TCC application."})]}),e("div",{className:"px-6 py-6",children:t("form",{className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{htmlFor:"contactName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name *"}),e("input",{type:"text",id:"contactName",name:"contactName",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter contact name"})]}),t("div",{children:[e("label",{htmlFor:"contactTitle",className:"block text-sm font-medium text-gray-700 mb-2",children:"Title/Position"}),e("input",{type:"text",id:"contactTitle",name:"contactTitle",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., IT Director, Administrator"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{htmlFor:"contactEmail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e("input",{type:"email",id:"contactEmail",name:"contactEmail",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"contact@hospital.com"})]}),t("div",{children:[e("label",{htmlFor:"contactPhone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e("input",{type:"tel",id:"contactPhone",name:"contactPhone",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"(555) 123-4567"})]})]}),t("div",{children:[e("label",{htmlFor:"contactNotes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes"}),e("textarea",{id:"contactNotes",name:"contactNotes",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Any additional information about this contact person..."})]}),t("div",{className:"flex justify-end space-x-3",children:[e("button",{type:"button",className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),e("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Save Contact Information"})]})]})})]}),t("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-md",children:[e("h4",{className:"font-semibold text-blue-900 mb-2",children:"Instructions"}),t("ul",{className:"text-sm text-blue-800 space-y-1",children:[e("li",{children:"\u2022 This contact person will be the main administrator for this facility's TCC application"}),e("li",{children:"\u2022 They will receive notifications about system updates and important changes"}),e("li",{children:"\u2022 This information may be used for support and troubleshooting purposes"}),e("li",{children:"\u2022 Ensure the email address is monitored regularly for important communications"})]})]})]})]})},dn=({user:a,onLogout:r})=>{var M;const[s,n]=g.exports.useState("create"),[i,o]=g.exports.useState([]),[l,h]=g.exports.useState(null),[N,y]=g.exports.useState(!1),[m,p]=g.exports.useState([{id:"1",patientId:"P001",destination:"General Hospital",transportLevel:"BLS",status:"PENDING",requestTime:"2025-09-07 10:30 AM",priority:"MEDIUM",urgencyLevel:"Urgent",pickupLocation:{name:"Room 101",floor:"1",room:"101"}},{id:"2",patientId:"P002",destination:"Rehabilitation Center",transportLevel:"ALS",status:"ACCEPTED",requestTime:"2025-09-07 09:15 AM",priority:"HIGH",urgencyLevel:"Emergent",pickupLocation:{name:"ICU Room 205",floor:"2",room:"205"}},{id:"3",patientId:"P003",destination:"Emergency Room",transportLevel:"CCT",status:"IN_PROGRESS",requestTime:"2025-09-07 08:45 AM",priority:"HIGH",urgencyLevel:"Emergent",pickupLocation:{name:"Emergency Bay 3",floor:"1",room:"E3"}},{id:"4",patientId:"P004",destination:"Outpatient Clinic",transportLevel:"BLS",status:"COMPLETED",requestTime:"2025-09-07 07:30 AM",priority:"LOW",urgencyLevel:"Routine",pickupLocation:{name:"Ward 3",floor:"3",room:"301"}}]),[x,f]=g.exports.useState(null),[c,b]=g.exports.useState({}),[u,S]=g.exports.useState(!1);g.exports.useEffect(()=>{O()},[]),g.exports.useEffect(()=>{s==="responses"&&W()},[s]);const k=C=>{switch(C){case"Routine":return"text-black bg-transparent";case"Urgent":return"text-black bg-orange-200";case"Emergent":return"text-black bg-red-200";default:return"text-black bg-transparent"}},O=async()=>{try{const C=await fetch("/api/trips",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(C.ok){const Z=await C.json();if(Z.success&&Z.data){const ee=Z.data.map(R=>({id:R.id,patientId:R.patientName,destination:R.toLocation,pickupLocation:R.pickupLocation,transportLevel:R.transportLevel||"BLS",status:R.status,requestTime:new Date(R.createdAt).toLocaleString(),priority:R.priority,urgencyLevel:R.urgencyLevel}));p(ee)}}}catch(C){console.error("Error loading trips:",C)}},F=C=>{f(C),b({status:C.status,transportLevel:C.transportLevel,urgencyLevel:C.urgencyLevel||C.priority})},U=async()=>{if(!!x){S(!0);try{const C=await fetch(`/api/trips/${x.id}/status`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({status:c.status,...c.status==="COMPLETED"&&{completionTimestamp:new Date().toISOString()}})});if(!C.ok){const Z=await C.json();throw new Error(Z.error||"Failed to update trip")}await O(),f(null),b({})}catch(C){console.error("Error updating trip:",C),alert(C.message||"Failed to update trip")}finally{S(!1)}}},_=async C=>{if(!!confirm("Are you sure you want to mark this trip as completed?")){S(!0);try{const Z=await fetch(`/api/trips/${C}/status`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({status:"COMPLETED",completionTimestamp:new Date().toISOString()})});if(!Z.ok){const ee=await Z.json();throw new Error(ee.error||"Failed to complete trip")}await O()}catch(Z){console.error("Error completing trip:",Z),alert(Z.message||"Failed to complete trip")}finally{S(!1)}}},G=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),r()},W=async C=>{y(!0);try{const Z=C?`/api/agency-responses?tripId=${C}`:"/api/agency-responses",ee=await fetch(Z,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(ee.ok){const R=await ee.json();R.success&&R.data&&o(R.data)}}catch(Z){console.error("Error loading agency responses:",Z)}finally{y(!1)}},P=async(C,Z,ee)=>{try{const R=await fetch(`/api/agency-responses/select/${C}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({agencyResponseId:Z,selectionNotes:ee||"Selected by healthcare provider"})});if(!R.ok){const q=await R.json();throw new Error(q.error||"Failed to select agency")}await W(C),await O()}catch(R){console.error("Error selecting agency:",R),alert(R.message||"Failed to select agency")}},D=C=>{n("responses"),h(C),W(C.id)},w=C=>{switch(C){case"PENDING":return"text-yellow-600 bg-yellow-100";case"ACCEPTED":return"text-green-600 bg-green-100";case"IN_PROGRESS":return"text-blue-600 bg-blue-100";case"COMPLETED":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}};return t("div",{className:"min-h-screen bg-gray-50",children:[e("header",{className:"bg-white shadow-sm border-b",children:e("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t("div",{className:"flex justify-between items-center h-16",children:[t("div",{className:"flex items-center",children:[e("div",{className:"bg-green-100 p-2 rounded-lg mr-3",children:e(ve,{className:"h-6 w-6 text-green-600"})}),t("div",{children:[e("h1",{className:"text-xl font-semibold text-gray-900",children:a.facilityName||"Healthcare Facility"}),t("p",{className:"text-sm text-gray-500 capitalize",children:[((M=a.facilityType)==null?void 0:M.toLowerCase())||"Healthcare"," \u2022 Healthcare Portal"]})]})]}),t("div",{className:"flex items-center space-x-4",children:[e(Er,{user:a}),t("div",{className:"flex items-center space-x-2",children:[e(Ke,{className:"h-5 w-5 text-gray-400"}),e("span",{className:"text-sm text-gray-700",children:a.name})]}),t("button",{onClick:G,className:"flex items-center space-x-1 text-gray-600 hover:text-gray-800",children:[e(Lt,{className:"h-4 w-4"}),e("span",{children:"Logout"})]})]})]})})}),e("div",{className:"bg-white border-b",children:e("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e("nav",{className:"flex space-x-8",children:[{id:"trips",name:"Transport Requests",icon:fe},{id:"responses",name:"Agency Responses",icon:Qe},{id:"create",name:"Create Request",icon:_e},{id:"hospital-settings",name:"Hospital Settings",icon:ve}].map(C=>{const Z=C.icon;return t("button",{onClick:()=>n(C.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ${s===C.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e(Z,{className:"h-4 w-4"}),e("span",{children:C.name})]},C.id)})})})}),t("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s==="trips"&&t("div",{className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-yellow-500",children:e(fe,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending Requests"}),e("dd",{className:"text-lg font-medium text-gray-900",children:m.filter(C=>C.status==="PENDING").length})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-green-500",children:e(re,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Completed Today"}),e("dd",{className:"text-lg font-medium text-gray-900",children:m.filter(C=>C.status==="COMPLETED").length})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-red-500",children:e(Kr,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"High Priority"}),e("dd",{className:"text-lg font-medium text-gray-900",children:m.filter(C=>C.urgencyLevel==="Emergent"||C.priority==="HIGH").length})]})})]})})})]}),t("div",{className:"bg-white rounded-lg shadow",children:[e("div",{className:"px-6 py-4 border-b border-gray-200",children:e("h3",{className:"text-lg font-medium text-gray-900",children:"Transport Requests"})}),e("div",{className:"p-6",children:m.length>0?e("div",{className:"space-y-4",children:m.map(C=>t("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e("div",{className:"flex items-center space-x-4",children:t("div",{children:[t("p",{className:"text-sm font-medium text-gray-900",children:["Patient ID: ",C.patientId," - ",C.destination]}),C.pickupLocation&&t("p",{className:"text-xs text-blue-600",children:["Pickup: ",C.pickupLocation.name,C.pickupLocation.floor&&` (Floor ${C.pickupLocation.floor})`,C.pickupLocation.room&&` - Room ${C.pickupLocation.room}`]}),t("p",{className:"text-xs text-gray-500",children:[C.transportLevel," \u2022 ",C.urgencyLevel||C.priority," \u2022 ",C.requestTime]})]})}),t("div",{className:"flex items-center space-x-2",children:[e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${w(C.status)}`,children:C.status}),e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${k(C.urgencyLevel||C.priority)}`,children:C.urgencyLevel||C.priority}),t("div",{className:"flex space-x-2 ml-4",children:[e("button",{onClick:()=>D(C),className:"text-purple-600 hover:text-purple-900 text-xs px-2 py-1 rounded hover:bg-purple-50",children:"View Responses"}),e("button",{onClick:()=>F(C),className:"text-blue-600 hover:text-blue-900 text-xs px-2 py-1 rounded hover:bg-blue-50",disabled:u,children:"Edit"}),C.status!=="COMPLETED"&&e("button",{onClick:()=>_(C.id),className:"text-green-600 hover:text-green-900 text-xs px-2 py-1 rounded hover:bg-green-50",disabled:u,children:"Complete"})]})]})]},C.id))}):e("div",{className:"text-center py-8",children:e("p",{className:"text-gray-500",children:"No transport requests found"})})})]})]}),s==="create"&&e("div",{children:e(Ar,{user:a,onTripCreated:()=>{O(),n("overview")},onCancel:()=>{n("overview")}})}),s==="responses"&&t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[e("h2",{className:"text-2xl font-bold text-gray-900",children:"Agency Responses"}),e("button",{onClick:()=>W(),disabled:N,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Loading...":"Refresh Responses"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-blue-500",children:e(Qe,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Responses"}),e("dd",{className:"text-lg font-medium text-gray-900",children:i.length})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-green-500",children:e(re,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Accepted"}),e("dd",{className:"text-lg font-medium text-gray-900",children:i.filter(C=>C.response==="ACCEPTED").length})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-red-500",children:e(we,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Declined"}),e("dd",{className:"text-lg font-medium text-gray-900",children:i.filter(C=>C.response==="DECLINED").length})]})})]})})}),e("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e("div",{className:"p-5",children:t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"p-3 rounded-md bg-yellow-500",children:e(fe,{className:"h-6 w-6 text-white"})})}),e("div",{className:"ml-5 w-0 flex-1",children:t("dl",{children:[e("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Selected"}),e("dd",{className:"text-lg font-medium text-gray-900",children:i.filter(C=>C.isSelected).length})]})})]})})})]}),l&&e("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[t("h3",{className:"text-lg font-medium text-blue-900",children:["Viewing Responses for: ",l.patientId]}),t("p",{className:"text-sm text-blue-700",children:[l.fromLocation," \u2192 ",l.toLocation," \u2022 ",l.transportLevel," \u2022 ",l.urgencyLevel||l.priority]})]}),e("button",{onClick:()=>{h(null),W()},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View All Responses"})]})}),t("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:[t("div",{className:"px-4 py-5 sm:px-6",children:[e("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:l?"Agency Response Details":"All Agency Responses"}),e("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:l?"View and manage agency responses for this transport request":"View and manage agency responses for all transport requests"})]}),e("ul",{className:"divide-y divide-gray-200",children:N?e("li",{className:"px-4 py-5 sm:px-6",children:e("div",{className:"text-center text-gray-500",children:t("div",{className:"flex items-center justify-center",children:[e("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-green-600 mr-2"}),"Loading agency responses..."]})})}):i.length===0?e("li",{className:"px-4 py-5 sm:px-6",children:e("div",{className:"text-center text-gray-500",children:"No agency responses found. Create a transport request to see responses."})}):i.map(C=>e("li",{className:"px-4 py-5 sm:px-6",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:`p-2 rounded-md ${C.response==="ACCEPTED"?"bg-green-100":C.response==="DECLINED"?"bg-red-100":"bg-gray-100"}`,children:C.response==="ACCEPTED"?e(re,{className:"h-5 w-5 text-green-600"}):C.response==="DECLINED"?e(we,{className:"h-5 w-5 text-red-600"}):e(fe,{className:"h-5 w-5 text-gray-600"})})}),t("div",{className:"ml-4",children:[t("div",{className:"flex items-center",children:[t("p",{className:"text-sm font-medium text-gray-900",children:["Agency ",C.agencyId]}),C.isSelected&&e("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Selected"})]}),t("p",{className:"text-sm text-gray-500",children:["Trip ID: ",C.tripId]}),C.responseNotes&&e("p",{className:"text-sm text-gray-600 mt-1",children:C.responseNotes}),C.estimatedArrival&&t("p",{className:"text-sm text-gray-500 mt-1",children:["ETA: ",new Date(C.estimatedArrival).toLocaleString()]})]})]}),t("div",{className:"flex items-center space-x-2",children:[e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${C.response==="ACCEPTED"?"bg-green-100 text-green-800":C.response==="DECLINED"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:C.response}),C.response==="ACCEPTED"&&!C.isSelected&&e("button",{onClick:()=>P(C.tripId,C.id),className:"px-3 py-1 bg-green-600 text-white text-xs rounded-md hover:bg-green-700",children:"Select Agency"})]})]})},C.id))})]})]}),s==="hospital-settings"&&e(cn,{})]}),x&&e("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:t("div",{className:"mt-3",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Trip Details"}),t("form",{onSubmit:C=>{C.preventDefault(),U()},children:[t("div",{className:"mb-4",children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),t("select",{value:c.status,onChange:C=>b({...c,status:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",children:[e("option",{value:"PENDING",children:"Pending"}),e("option",{value:"ACCEPTED",children:"Accepted"}),e("option",{value:"IN_PROGRESS",children:"In Progress"}),e("option",{value:"COMPLETED",children:"Completed"}),e("option",{value:"CANCELLED",children:"Cancelled"})]})]}),t("div",{className:"mb-4",children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transport Level"}),t("select",{value:c.transportLevel,onChange:C=>b({...c,transportLevel:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",children:[e("option",{value:"BLS",children:"BLS - Basic Life Support"}),e("option",{value:"ALS",children:"ALS - Advanced Life Support"}),e("option",{value:"CCT",children:"CCT - Critical Care Transport"})]})]}),t("div",{className:"mb-4",children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Urgency Level"}),t("select",{value:c.urgencyLevel,onChange:C=>b({...c,urgencyLevel:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",children:[e("option",{value:"Routine",children:"Routine"}),e("option",{value:"Urgent",children:"Urgent"}),e("option",{value:"Emergent",children:"Emergent"})]})]}),t("div",{className:"flex justify-end space-x-3",children:[e("button",{type:"button",onClick:()=>{f(null),b({})},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e("button",{type:"submit",disabled:u,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 disabled:opacity-50",children:u?"Updating...":"Update Trip"})]})]})]})})})]})},mn=({onRoleSelect:a,onShowRegistration:r,onClearSession:s})=>{const[n,i]=g.exports.useState(!1),o=h=>{i(!0),a(h)};return e("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:t("div",{className:"max-w-md w-full space-y-8",children:[t("div",{className:"text-center",children:[e("div",{className:"mx-auto h-16 w-16 bg-primary-600 rounded-full flex items-center justify-center",children:e(ve,{className:"h-8 w-8 text-white"})}),e("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Welcome to TCC"}),e("p",{className:"mt-2 text-sm text-gray-600",children:"Select your login type to continue"})]}),t("div",{className:"space-y-4",children:[t("button",{onClick:()=>o("healthcare"),className:"group relative w-full flex justify-center py-4 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200",children:[e(ve,{className:"h-5 w-5 mr-2"}),"Healthcare Facility Login"]}),t("button",{onClick:()=>o("ems"),className:"group relative w-full flex justify-center py-4 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-colors duration-200",children:[e(ie,{className:"h-5 w-5 mr-2"}),"EMS Agency Login"]}),t("button",{onClick:()=>o("tcc"),className:"group relative w-full flex justify-center py-4 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",children:[e(na,{className:"h-5 w-5 mr-2"}),"Transport Center Login"]})]}),e("div",{className:"mt-8 border-t border-gray-200 pt-6",children:t("div",{className:"text-center",children:[e("p",{className:"text-sm text-gray-600 mb-4",children:"Don't have an account? Create one for your organization:"}),t("div",{className:"space-y-3",children:[t("button",{onClick:()=>r("healthcare"),className:"w-full flex items-center justify-center px-4 py-2 border border-green-300 text-sm font-medium rounded-md text-green-700 bg-green-50 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200",children:[e(Ea,{className:"h-4 w-4 mr-2"}),"Create Healthcare Facility Account"]}),t("button",{onClick:()=>r("ems"),className:"w-full flex items-center justify-center px-4 py-2 border border-orange-300 text-sm font-medium rounded-md text-orange-700 bg-orange-50 hover:bg-orange-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-colors duration-200",children:[e(Ea,{className:"h-4 w-4 mr-2"}),"Create EMS Agency Account"]})]}),s&&e("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e("button",{onClick:s,className:"w-full text-xs text-gray-500 hover:text-gray-700 underline",children:"Clear Session & Start Fresh"})})]})}),n&&e("div",{className:"text-center",children:t("button",{onClick:()=>{i(!1)},className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[e(pt,{className:"h-4 w-4 mr-1"}),"Back to Selection"]})})]})})},un="modulepreload",hn=function(a){return"/"+a},Ja={},Ht=function(r,s,n){if(!s||s.length===0)return r();const i=document.getElementsByTagName("link");return Promise.all(s.map(o=>{if(o=hn(o),o in Ja)return;Ja[o]=!0;const l=o.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(!!n)for(let m=i.length-1;m>=0;m--){const p=i[m];if(p.href===o&&(!l||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${h}`))return;const y=document.createElement("link");if(y.rel=l?"stylesheet":un,l||(y.as="script",y.crossOrigin=""),y.href=o,document.head.appendChild(y),l)return new Promise((m,p)=>{y.addEventListener("load",m),y.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>r())},pn=({onBack:a,onSuccess:r})=>{const[s,n]=g.exports.useState({facilityName:"",facilityType:"",contactName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",latitude:"",longitude:"",password:"",confirmPassword:""}),[i,o]=g.exports.useState(!1),[l,h]=g.exports.useState(null),[N,y]=g.exports.useState(!1),m=["Hospital","Clinic","Urgent Care","Rehabilitation Facility","Doctor's Office","Dialysis Center","Nursing Home","Assisted Living","Other"],p=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],x=c=>{const{name:b,value:u}=c.target;n(S=>({...S,[b]:u}))},f=async c=>{var S,k;if(c.preventDefault(),o(!0),h(null),s.password!==s.confirmPassword){h("Passwords do not match"),o(!1);return}if(s.password.length<8){h("Password must be at least 8 characters long"),o(!1);return}if(!s.latitude||!s.longitude){h("Location coordinates are required. Please lookup or enter latitude and longitude."),o(!1);return}const b=parseFloat(s.latitude),u=parseFloat(s.longitude);if(isNaN(b)||isNaN(u)){h("Please enter valid numeric coordinates."),o(!1);return}if(b<-90||b>90){h("Latitude must be between -90 and 90 degrees."),o(!1);return}if(u<-180||u>180){h("Longitude must be between -180 and 180 degrees."),o(!1);return}try{const{authAPI:O}=await Ht(()=>Promise.resolve().then(()=>qt),void 0);console.log("Registering healthcare facility:",s),await O.healthcareRegister({email:s.email,password:s.password,name:s.contactName,facilityName:s.facilityName,facilityType:s.facilityType}),y(!0),setTimeout(()=>{r()},2e3)}catch(O){console.error("Healthcare registration error:",O);const F=((k=(S=O.response)==null?void 0:S.data)==null?void 0:k.error)||O.message||"Registration failed. Please try again.";h(F)}finally{o(!1)}};return N?e("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e("div",{className:"max-w-md w-full space-y-8",children:t("div",{className:"text-center",children:[e(re,{className:"mx-auto h-16 w-16 text-green-500"}),e("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Registration Submitted!"}),t("p",{className:"mt-2 text-sm text-gray-600",children:["We've sent a verification email to ",s.email,". Please check your inbox and click the verification link to activate your account."]}),e("p",{className:"mt-4 text-sm text-gray-500",children:"Your account will be reviewed by our team and approved within 24 hours."})]})})}):e("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:t("div",{className:"max-w-md w-full space-y-8",children:[t("div",{className:"text-center",children:[e("div",{className:"mx-auto h-16 w-16 bg-green-600 rounded-full flex items-center justify-center",children:e(ve,{className:"h-8 w-8 text-white"})}),e("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Create Healthcare Facility Account"}),e("p",{className:"mt-2 text-sm text-gray-600",children:"Register your healthcare facility to start using TCC"})]}),t("form",{className:"mt-8 space-y-6",onSubmit:f,children:[l&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(Ee,{className:"h-5 w-5 text-red-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800",children:l})})]})}),t("div",{className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Facility Name *"}),e("input",{type:"text",name:"facilityName",required:!0,value:s.facilityName,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter facility name"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Facility Type *"}),t("select",{name:"facilityType",required:!0,value:s.facilityType,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"Select facility type"}),m.map(c=>e("option",{value:c,children:c},c))]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Person Name *"}),e("input",{type:"text",name:"contactName",required:!0,value:s.contactName,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter contact person name"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e("input",{type:"email",name:"email",required:!0,value:s.email,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email address"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address *"}),e("input",{type:"text",name:"address",required:!0,value:s.address,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter street address"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),e("input",{type:"text",name:"city",required:!0,value:s.city,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"City"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State *"}),t("select",{name:"state",required:!0,value:s.state,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[e("option",{value:"",children:"State"}),p.map(c=>e("option",{value:c,children:c},c))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ZIP *"}),e("input",{type:"text",name:"zipCode",required:!0,value:s.zipCode,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"ZIP"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),e("input",{type:"password",name:"password",required:!0,value:s.password,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter password (min 8 characters)"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),e("input",{type:"password",name:"confirmPassword",required:!0,value:s.confirmPassword,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Confirm password"})]})]})]}),e("div",{children:e("button",{type:"submit",disabled:i,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Creating Account...":"Create Account"})}),e("div",{className:"text-center",children:t("button",{type:"button",onClick:a,className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[e(pt,{className:"h-4 w-4 mr-1"}),"Back to Login Selection"]})})]})]})})},gn=({onBack:a,onSuccess:r})=>{var O,F,U,_,G,W,P,D,w,M,C,Z,ee,R,q,$;const[s,n]=g.exports.useState({agencyName:"",serviceType:"",contactName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",latitude:"",longitude:"",capabilities:[],operatingHours:{start:"",end:""},password:"",confirmPassword:""}),[i,o]=g.exports.useState(!1),[l,h]=g.exports.useState(null),[N,y]=g.exports.useState(!1),[m,p]=g.exports.useState(!1),x=["EMS","Wheelchair Van","Non-Emergency Medical Transport","Air Ambulance","Ground Ambulance","Other"],f=["BLS","ALS","CCT","Critical Care","Neonatal","Pediatric","Bariatric","Isolation"],c=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],b=async()=>{if(!s.address||!s.city||!s.state||!s.zipCode){h("Please fill in address, city, state, and ZIP code before looking up coordinates");return}p(!0),h(null);try{const L=`${s.address}, ${s.city}, ${s.state} ${s.zipCode}`,B=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(L)}&limit=1`);if(!B.ok)throw new Error("Geocoding service unavailable");const H=await B.json();if(H&&H.length>0){const X=H[0];n(I=>({...I,latitude:X.lat,longitude:X.lon})),h(null)}else h("Address not found. Please enter coordinates manually.")}catch(L){console.error("Geocoding error:",L),h("Failed to lookup coordinates. Please enter them manually.")}finally{p(!1)}},u=L=>{const{name:B,value:H}=L.target;n(B==="operatingHours.start"||B==="operatingHours.end"?X=>({...X,operatingHours:{...X.operatingHours,[B.split(".")[1]]:H}}):X=>({...X,[B]:H}))},S=L=>{n(B=>({...B,capabilities:B.capabilities.includes(L)?B.capabilities.filter(H=>H!==L):[...B.capabilities,L]}))},k=async L=>{var X,I;if(L.preventDefault(),o(!0),h(null),s.password!==s.confirmPassword){h("Passwords do not match"),o(!1);return}if(s.password.length<8){h("Password must be at least 8 characters long"),o(!1);return}if(s.capabilities.length===0){h("Please select at least one service capability"),o(!1);return}if(!s.latitude||!s.longitude){h("Location coordinates are required. Please lookup or enter latitude and longitude."),o(!1);return}const B=parseFloat(s.latitude),H=parseFloat(s.longitude);if(isNaN(B)||isNaN(H)){h("Please enter valid numeric coordinates."),o(!1);return}if(B<-90||B>90){h("Latitude must be between -90 and 90 degrees."),o(!1);return}if(H<-180||H>180){h("Longitude must be between -180 and 180 degrees."),o(!1);return}try{const{authAPI:d}=await Ht(()=>Promise.resolve().then(()=>qt),void 0);console.log("Registering EMS agency:",s),await d.emsRegister({email:s.email,password:s.password,name:s.contactName,agencyName:s.agencyName,serviceType:s.serviceType}),y(!0),setTimeout(()=>{r()},2e3)}catch(d){console.error("EMS registration error:",d);const E=((I=(X=d.response)==null?void 0:X.data)==null?void 0:I.error)||d.message||"Registration failed. Please try again.";h(E)}finally{o(!1)}};return N?e("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e("div",{className:"max-w-md w-full space-y-8",children:t("div",{className:"text-center",children:[e(re,{className:"mx-auto h-16 w-16 text-orange-500"}),e("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Registration Submitted!"}),t("p",{className:"mt-2 text-sm text-gray-600",children:["We've sent a verification email to ",s.email,". Please check your inbox and click the verification link to activate your account."]}),e("p",{className:"mt-4 text-sm text-gray-500",children:"Your account will be reviewed by our team and approved within 24 hours."})]})})}):e("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:t("div",{className:"max-w-md w-full space-y-8",children:[t("div",{className:"text-center",children:[e("div",{className:"mx-auto h-16 w-16 bg-orange-600 rounded-full flex items-center justify-center",children:e(ie,{className:"h-8 w-8 text-white"})}),e("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Create EMS Agency Account"}),e("p",{className:"mt-2 text-sm text-gray-600",children:"Register your EMS agency to start using TCC"})]}),t("form",{className:"mt-8 space-y-6",onSubmit:k,children:[l&&e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:t("div",{className:"flex",children:[e(Ee,{className:"h-5 w-5 text-red-400"}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800",children:l})})]})}),t("div",{className:"space-y-8",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Agency Name *"}),e("input",{type:"text",name:"agencyName",required:!0,value:s.agencyName,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"Enter agency name"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Type *"}),t("select",{name:"serviceType",required:!0,value:s.serviceType,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",children:[e("option",{value:"",children:"Select service type"}),x.map(L=>e("option",{value:L,children:L},L))]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Person Name *"}),e("input",{type:"text",name:"contactName",required:!0,value:s.contactName,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"Enter contact person name"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e("input",{type:"email",name:"email",required:!0,value:s.email,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"Enter email address"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),e("input",{type:"tel",name:"phone",required:!0,value:s.phone,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"Enter phone number"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Street Address *"}),e("input",{type:"text",name:"address",required:!0,value:s.address,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"Enter street address"})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),e("input",{type:"text",name:"city",required:!0,value:s.city,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"City"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State *"}),t("select",{name:"state",required:!0,value:s.state,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",children:[e("option",{value:"",children:"State"}),c.map(L=>e("option",{value:L,children:L},L))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ZIP *"}),e("input",{type:"text",name:"zipCode",required:!0,value:s.zipCode,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"ZIP"})]}),e("div",{className:"flex items-end",children:e("button",{type:"button",onClick:b,disabled:m||!((O=s.address)!=null&&O.trim())||!((F=s.city)!=null&&F.trim())||!((U=s.state)!=null&&U.trim())||!((_=s.zipCode)!=null&&_.trim()),className:`w-full px-4 py-3 border border-transparent text-sm font-medium rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${m||!((G=s.address)!=null&&G.trim())||!((W=s.city)!=null&&W.trim())||!((P=s.state)!=null&&P.trim())||!((D=s.zipCode)!=null&&D.trim())?"bg-gray-400 text-gray-700 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:m?t(se,{children:[e("div",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",children:e("div",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full"})}),"Looking up..."]}):t(se,{children:[e(Re,{className:"h-4 w-4 mr-2"}),"Lookup Coordinates"]})})})]}),(m||!((w=s.address)!=null&&w.trim())||!((M=s.city)!=null&&M.trim())||!((C=s.state)!=null&&C.trim())||!((Z=s.zipCode)!=null&&Z.trim()))&&e("p",{className:"text-sm text-red-600",children:m?"Looking up coordinates...":`Please fill in: ${[!((ee=s.address)!=null&&ee.trim())&&"Address",!((R=s.city)!=null&&R.trim())&&"City",!((q=s.state)!=null&&q.trim())&&"State",!(($=s.zipCode)!=null&&$.trim())&&"ZIP Code"].filter(Boolean).join(", ")}`}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude"}),e("input",{type:"number",step:"any",name:"latitude",value:s.latitude,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"e.g., 40.1234"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude"}),e("input",{type:"number",step:"any",name:"longitude",value:s.longitude,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"e.g., -78.5678"})]})]}),s.latitude&&s.longitude&&t("div",{className:"text-sm text-green-600 bg-green-50 border border-green-200 rounded-lg p-3",children:["\u2713 Coordinates set: ",s.latitude,", ",s.longitude]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Service Capabilities * (Select all that apply)"}),e("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:f.map(L=>t("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e("input",{type:"checkbox",checked:s.capabilities.includes(L),onChange:()=>S(L),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("span",{className:"ml-3 text-sm font-medium text-gray-700",children:L})]},L))})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transport Availability (Optional)"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Start Time"}),e("input",{type:"time",name:"operatingHours.start",value:s.operatingHours.start,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"End Time"}),e("input",{type:"time",name:"operatingHours.end",value:s.operatingHours.end,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base"})]})]}),e("p",{className:"text-sm text-gray-500 mt-2",children:'Leave blank for 24/7 availability. Specify hours only if you have restrictions (e.g., "Monday-Friday 6 AM - 6 PM")'})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),e("input",{type:"password",name:"password",required:!0,value:s.password,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"Enter password (min 8 characters)"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),e("input",{type:"password",name:"confirmPassword",required:!0,value:s.confirmPassword,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base",placeholder:"Confirm password"})]})]})]}),e("div",{children:e("button",{type:"submit",disabled:i,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Creating Account...":"Create Account"})}),e("div",{className:"text-center",children:t("button",{type:"button",onClick:a,className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[e(pt,{className:"h-4 w-4 mr-1"}),"Back to Login Selection"]})})]})]})})},xn=({onBack:a,onLogin:r})=>{const[s,n]=g.exports.useState({email:"",password:""}),[i,o]=g.exports.useState(!1),[l,h]=g.exports.useState(""),N=m=>{const{name:p,value:x}=m.target;n(f=>({...f,[p]:x}))};return e("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:t("div",{className:"max-w-md w-full space-y-8",children:[t("div",{children:[t("button",{onClick:a,className:"flex items-center text-gray-600 hover:text-gray-800 mb-4",children:[e(pt,{className:"h-4 w-4 mr-2"}),"Back to Login Options"]}),e("div",{className:"flex justify-center",children:e("div",{className:"bg-green-100 p-3 rounded-full",children:e(ve,{className:"h-8 w-8 text-green-600"})})}),e("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Healthcare Facility Login"}),e("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to your healthcare facility account"})]}),t("form",{className:"mt-8 space-y-6",onSubmit:async m=>{var p,x;m.preventDefault(),o(!0),h("");try{localStorage.removeItem("token"),localStorage.removeItem("user");const{authAPI:f}=await Ht(()=>Promise.resolve().then(()=>qt),void 0),c=await f.healthcareLogin({email:s.email,password:s.password});c.data.success?r(c.data.user,c.data.token):h(c.data.error||"Login failed")}catch(f){console.error("Healthcare login error:",f);const c=((x=(p=f.response)==null?void 0:p.data)==null?void 0:x.error)||f.message||"Network error. Please try again.";h(c)}finally{o(!1)}},children:[t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),e("input",{id:"email",name:"email",type:"email",required:!0,value:s.email,onChange:N,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 focus:z-10 sm:text-sm",placeholder:"Enter your email"})]}),t("div",{children:[e("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e("input",{id:"password",name:"password",type:"password",required:!0,value:s.password,onChange:N,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 focus:z-10 sm:text-sm",placeholder:"Enter your password"})]})]}),l&&t("div",{className:"flex items-center text-red-600 text-sm",children:[e(he,{className:"h-4 w-4 mr-2"}),l]}),e("div",{children:e("button",{type:"submit",disabled:i,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Signing in...":"Sign In"})}),e("div",{className:"text-center",children:e("button",{onClick:a,className:"text-sm text-gray-600 hover:text-gray-800 transition-colors duration-200",children:"Return to the Login Page"})})]})]})})},fn=({onBack:a,onLogin:r})=>{const[s,n]=g.exports.useState({email:"",password:""}),[i,o]=g.exports.useState(!1),[l,h]=g.exports.useState(""),N=m=>{const{name:p,value:x}=m.target;n(f=>({...f,[p]:x}))};return e("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:t("div",{className:"max-w-md w-full space-y-8",children:[t("div",{children:[t("button",{onClick:a,className:"flex items-center text-gray-600 hover:text-gray-800 mb-4",children:[e(pt,{className:"h-4 w-4 mr-2"}),"Back to Login Options"]}),e("div",{className:"flex justify-center",children:e("div",{className:"bg-orange-100 p-3 rounded-full",children:e(ie,{className:"h-8 w-8 text-orange-600"})})}),e("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"EMS Agency Login"}),e("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to your EMS agency account"})]}),t("form",{className:"mt-8 space-y-6",onSubmit:async m=>{var p,x,f;m.preventDefault(),o(!0),h("");try{localStorage.removeItem("token"),localStorage.removeItem("user");const{authAPI:c}=await Ht(()=>Promise.resolve().then(()=>qt),void 0);console.log("TCC_DEBUG: EMS Login attempt with:",s.email);const b=await c.emsLogin({email:s.email,password:s.password});console.log("TCC_DEBUG: EMS Login response:",b.data),b.data.success?(console.log("TCC_DEBUG: EMS Login successful, calling onLogin with user:",b.data.user),r(b.data.user,b.data.token)):(console.log("TCC_DEBUG: EMS Login failed:",b.data.error),h(b.data.error||"Login failed"))}catch(c){console.error("TCC_DEBUG: EMS login error:",c),console.error("TCC_DEBUG: Error response:",(p=c.response)==null?void 0:p.data);const b=((f=(x=c.response)==null?void 0:x.data)==null?void 0:f.error)||c.message||"Network error. Please try again.";h(b)}finally{o(!1)}},children:[t("div",{className:"space-y-4",children:[t("div",{children:[e("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),e("input",{id:"email",name:"email",type:"email",required:!0,value:s.email,onChange:N,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500 focus:z-10 sm:text-sm",placeholder:"Enter your email"})]}),t("div",{children:[e("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e("input",{id:"password",name:"password",type:"password",required:!0,value:s.password,onChange:N,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500 focus:z-10 sm:text-sm",placeholder:"Enter your password"})]})]}),l&&t("div",{className:"flex items-center text-red-600 text-sm",children:[e(he,{className:"h-4 w-4 mr-2"}),l]}),e("div",{children:e("button",{type:"submit",disabled:i,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Signing in...":"Sign In"})}),e("div",{className:"text-center",children:e("button",{onClick:a,className:"text-sm text-gray-600 hover:text-gray-800 transition-colors duration-200",children:"Return to the Login Page"})})]})]})})},yn=()=>(g.exports.useState(!1),g.exports.useState(null),g.exports.useState(null),null);function bn(){const[a,r]=g.exports.useState(null),[s,n]=g.exports.useState(!0),[i,o]=g.exports.useState("public");g.exports.useEffect(()=>{const f=async()=>{if(localStorage.getItem("token"))try{const S=await ut.verify();r(S.data.user)}catch{localStorage.removeItem("token"),localStorage.removeItem("user")}n(!1)},b=new URLSearchParams(window.location.search).get("register");b==="healthcare"?o("healthcare-register"):b==="ems"&&o("ems-register"),f()},[]);const l=(f,c)=>{r(f),localStorage.setItem("token",c),localStorage.setItem("user",JSON.stringify(f)),(f.userType==="ADMIN"||f.userType==="USER")&&(window.location.href="/dashboard")},h=()=>{r(null),localStorage.removeItem("token"),localStorage.removeItem("user"),o("public")},N=f=>{f==="tcc"?o("login"):f==="healthcare"?o("healthcare-login"):f==="ems"&&o("ems-login")},y=f=>{o(f==="healthcare"?"healthcare-register":"ems-register")},m=()=>{o("public")},p=()=>{o("public")},x=()=>{r(null),localStorage.removeItem("token"),localStorage.removeItem("user"),o("public")};return s?e("div",{className:"min-h-screen flex items-center justify-center",children:e("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):a?a.userType==="HEALTHCARE"?e(dn,{user:a,onLogout:h}):a.userType==="EMS"?e(Rr,{user:a,onLogout:h}):e("div",{className:"min-h-screen bg-gray-50",children:t(Yt,{children:[e(le,{path:"/dashboard/*",element:e(on,{user:a,onLogout:h})}),e(le,{path:"*",element:e(jr,{to:"/dashboard",replace:!0})})]})}):e("div",{className:"min-h-screen bg-gray-50",children:e(Yt,{children:e(le,{path:"*",element:t(se,{children:[i==="public"&&e(mn,{onRoleSelect:N,onShowRegistration:y,onClearSession:x}),i==="healthcare-register"&&e(pn,{onBack:p,onSuccess:m}),i==="ems-register"&&e(gn,{onBack:p,onSuccess:m}),i==="login"&&e(Ui,{onLogin:l,onBack:p}),i==="healthcare-login"&&e(xn,{onBack:p,onLogin:l}),i==="ems-login"&&e(fn,{onBack:p,onLogin:l}),e(yn,{})]})})})})}function Nn(){return e(Ur,{children:e(bn,{})})}Zt.createRoot(document.getElementById("root")).render(e(sa.StrictMode,{children:e(Nn,{})}));
